<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-05-04 ven 09:14 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Riassunto Probabilità e Statistica per l'Informatica</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Gabriele Calissi" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Riassunto Probabilità e Statistica per l'Informatica</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgf8b414f">1. GitHub</a></li>
<li><a href="#orged6f413">2. Lezioni</a>
<ul>
<li><a href="#org9239475">2.1. Statistica Descrittiva</a></li>
<li><a href="#org05b382b">2.2. Calcolo delle probabilità</a></li>
<li><a href="#org459715e">2.3. Distribuzioni Notevoli</a>
<ul>
<li><a href="#org9740ce3">2.3.1. Distribuzione Bernoulliana</a></li>
<li><a href="#org0209c57">2.3.2. Distribuzione Binomiale</a></li>
<li><a href="#orgf7a050d">2.3.3. Distribuzione di Poisson</a></li>
<li><a href="#orge4d0927">2.3.4. Distribuzione Geometrica</a></li>
<li><a href="#orgf0cf99a">2.3.5. Distribuzione Uniforme</a></li>
<li><a href="#org0fc4d4b">2.3.6. Distribuzione triangolare</a></li>
<li><a href="#org6e8b451">2.3.7. Distribuzione esponenziale</a></li>
<li><a href="#orgad633a3">2.3.8. Distribuzione normale</a></li>
<li><a href="#orgf8c28cb">2.3.9. Distribuzione Chi-Quadro</a></li>
<li><a href="#org66bb5ea">2.3.10. Distribuzione t di STUDENT</a></li>
<li><a href="#org25384c3">2.3.11. Distribuzione F di FISHER</a></li>
</ul>
</li>
<li><a href="#orgfc27058">2.4. Teoremi di Convergenza</a>
<ul>
<li><a href="#org475815b">2.4.1. Legge dei grandi numeri</a></li>
<li><a href="#org2e8a10b">2.4.2. Teorema Limite Centrale</a></li>
</ul>
</li>
<li><a href="#org68566c8">2.5. Stime di parametri</a>
<ul>
<li><a href="#orgffe1ff6">2.5.1. Campionamento e campioni</a></li>
<li><a href="#org3775207">2.5.2. Principali distribuzioni campionarie</a></li>
<li><a href="#org1eb0707">2.5.3. Stimatori e stime puntuali</a></li>
<li><a href="#org8103643">2.5.4. Stime intervallari</a></li>
<li><a href="#orga299535">2.5.5. Intervalli di Confidenza per la Varianza</a></li>
<li><a href="#org711d164">2.5.6. Considerazioni sulla Numerosità del Campione</a></li>
<li><a href="#org3efe878">2.5.7. Stime di parametri</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2895b52">3. Laboratorio</a>
<ul>
<li><a href="#org09148cf">3.1. Libri</a></li>
<li><a href="#org2732938">3.2. Slides</a>
<ul>
<li><a href="#org71c6857">3.2.1. Statistica Descrittiva</a></li>
<li><a href="#org1599a2e">3.2.2. Calcolo delle Probabilità</a></li>
<li><a href="#org5aba467">3.2.3. Distribuzioni notevoli</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgf8b414f" class="outline-2">
<h2 id="orgf8b414f"><span class="section-number-2">1</span> GitHub</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li><a href="https://github.com/gabrielecalissi/psi">Guardalo in GitHub</a>;</li>
<li><a href="https://github.com/gabrielecalissi/psi/archive/master.zip">Scarica .zip</a>;</li>
<li><a href="https://github.com/gabrielecalissi/psi/archive/master.tar.gz">Scarica .tar.gz</a>.</li>
</ul>
</div>
</div>
<div id="outline-container-orged6f413" class="outline-2">
<h2 id="orged6f413"><span class="section-number-2">2</span> Lezioni</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org9239475" class="outline-3">
<h3 id="org9239475"><span class="section-number-3">2.1</span> Statistica Descrittiva</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Raccolta di metodi e strumenti matematici atti ad organizzare una o più serie di dati in modo tale
da evidenziare in forma sintetica eventuali:
</p>
<ul class="org-ul">
<li>Simmetrie;</li>
<li>Periodicità;</li>
<li>Leggi di altro genere.</li>
</ul>
<p>
Ovvero in grado di descriverne in maniera immediatamente comprensibile le informazioni implicitamente
contenute nei dati stessi.
</p>

<p>
Solitamente la serie di dati di cui si dispone è costituita da un numero limitato di <i>osservazioni</i> che devono
essere rappresentative di un'ampia <i>popolazione</i>.
</p>

<p>
Con il termine <i>popolazione</i> si intende l'insieme degli elementi cui si riferisce l'<i>indagine statistica</i>.
</p>

<p>
Affrontare uno studio di statistica descrittiva richiede di tener presente che le tecniche di organizzazione
dei dati varino in funzione dei modi di presentarsi delle <i>caratteristiche (caratteri)</i> degli elementi
su cui è svolta l'indagine.
</p>

<p>
<i>Caratteri qualitativi</i>: quando le caratteristiche sono qualità o dati non numerici. Per es.: GUSTO =
{dolce, amaro} e COLORE = {rosso, verde, giallo, &#x2026;}.
</p>

<p>
<i>Caratteri quantitativi</i>: quando le caratteristiche sono grandezze misurabili.
</p>
<ul class="org-ul">
<li><i>Quantitativi discreti</i>: possono assumere un numero limitato di valori, per es. DADO = {1, 2, &#x2026;, 6}.</li>
<li><i>Quantitativi continui</i>: assumono valori reali come la TEMPERATURA.</li>
</ul>

<p>
Supponiamo di considerare \(n\) elementi della popolazione e di rilevare, per ognuno di essi, il dato
relativo al carattere quantitativo da esaminare.
</p>

<p>
<i>Insieme dei dati</i>: \(E = \{x_1, \dots, x_n\}\).
</p>

<p>
<i>Numerosità</i>: numero di elementi considerati \(n\).
</p>

<p>
Quando il <i>carattere è discreto</i> è comodo raggruppare i dati considerando l'insieme di tutti i valori assumibili
(modalità del carattere) ed associare ad ognuno di tali valori il numero di volte che esso compare in \(E\).
</p>

<p>
\(N\) = numero totale di modalità.
</p>

<p>
\(S = \{s_1, \dots, s_N\}\) = insieme delle modalità.
</p>

<p>
<i>Frequenza assoluta</i> della modalità \(s_j, j = 1, \dots, N\): \(f_j, j = 1, \dots, N\). Data dal numero di elementi di
\(E = \{x_1, \dots, x_n\}\) che hanno valore \(s_j\).
</p>

<p>
<i>Distribuzione di frequenza assoluta dei dati osservati</i>: funzione che associa ad ogni modalità la corrispondente
frequenza assoluta. \(f: S \to \mathbb{N}\), \(S = \{s_1, \dots s_N\}\).
</p>

<p>
La <i>frequenza cumulata assoluta</i> per la modalità \(s_j\) è la somma delle frequenze assolute di tutte le modalità
\(s_k \in S \mid s_k \leq s_j\). \(F_j = \sum_{s_k \leq s_j} f_k\).
</p>

<p>
<i>Frequenza relativa</i>: \(p_j = \frac{f_j}{n}\).
</p>

<p>
<i>Frequenza cumulata relativa</i>: \(P_j = \sum_{k:s_k \leq s_j} p_k\).
</p>

<p>
Si dicono distribuzione di frequenza cumulata assoluta, relativa e cumulata relativa dei dati osservali, le
funzioni \(F, p\) e \(P\) che associano ad ogni modalità \(s_j\) le relative frequenze \(F_j, p_j, P_j\). Con \(n\) numero
delle osservazioni.
</p>

<p>
Esempio:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_12-15-55.png" alt="screenshot_2018-03-01_12-15-55.png" />
</p>
</div>



<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_12-16-09.png" alt="screenshot_2018-03-01_12-16-09.png" />
</p>
</div>

<p>
La forma tabellare consente di fare facilmente alcune semplici osservazioni:
</p>
<ul class="org-ul">
<li>Il numero di stanze che si presenta con maggior frequenza è 4 (24).</li>
<li>3 appartamenti su 10 hanno 4 stanze.</li>
<li>9 appartamenti su 10 hanno meno di 7 stanze.</li>
</ul>

<p>
Quando il <i>carattere</i> da studiare è <i>continuo</i> (o discreto con un numero elevato di modalità) è
conveniente <i>ricondursi a raggruppamenti</i> come quelli appena trattati.
Si suddivide l'insieme \(S\) delle modalità in <i>classi</i>.
</p>

<p>
<i>Classe</i>: un qualsiasi sottoinsieme di \(S\).
</p>

<p>
<i>Partizione</i>: ogni famiglia di classi tra loro disgiunte la cui unione è tutto \(S\).
</p>

<p>
La scelta delle classi con cui si suddivide l'insieme \(S\) è del tutto <i>arbitraria</i> anche se
è <i>necessario</i> che esse formino una <i>partizione</i> di \(S\).
</p>

<p>
Le partizioni devono essere:
</p>
<ul class="org-ul">
<li>Significative per il caso in esame.</li>
<li>Sufficientemente numerose.</li>
</ul>

<p>
Ad ogni classe sono associate diverse grandezze che la caratterizzano come:
</p>
<ul class="org-ul">
<li><i>Confine inferiore/superiore</i>: valori estremi delle classe.</li>
<li><i>Ampiezza</i>: differenza tra confine superiore ed inferiore.</li>
<li><i>Valore centrale</i>: semi-somma tra i due confini.</li>
</ul>

<p>
Nel caso in cui il carattere esaminato sia continuo occorre specificare quando le classi sono
chiuse, a destra o a sinistra, ovvero specificare se gli elementi dell'indagine il cui dato coincide
con il confine della classe sono da raggruppare all'interno della classe stessa oppure no.
</p>

<p>
Per esempio:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_12-21-02.png" alt="screenshot_2018-03-01_12-21-02.png" />
</p>
</div>

<p>
\(S = [0.44, 5.42] \subset R\)
</p>

<p>
Volendo suddividere \(S\) in 5 classi potremmo scegliere:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_12-21-51.png" alt="screenshot_2018-03-01_12-21-51.png" />
</p>
</div>

<p>
I valori centrali delle classi sono \(\bar{x_k}\).
</p>

<p>
Le classi scelte non hanno tutte la stessa ampiezza, utile se si desidera che ogni classe sia abbastanza
consistente. Gli appartamenti con valore maggiore di 4 migliaia di euro sono pochi, si è ritenuto
opportuno adottare un intervallo di ampiezza maggiore dei restanti quattro intervalli.
</p>

<p>
Per esempio:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_12-23-23.png" alt="screenshot_2018-03-01_12-23-23.png" />
</p>
</div>

<p>
<i>Indici di tendenza centrale</i>
</p>

<p>
In generale un ricercatore che disponga di una serie di osservazioni statistiche e si proponga di
descriverne le proprietà, fissa la propria attenzione sulla determinazione di <i>un solo valore</i> che
rappresenti in qualche modo l'intera serie.
</p>

<p>
Per tale ragione sono stati introdotti gli <i>indici di tendenza centrale</i> o <i>indici di posizione</i> che
sono quantità in grado di sintetizzare con un solo valore numerico i valori assunti dai dati.
</p>

<p>
Il valore che è da solo certamente più utile di ogni altro nello studio di una serie di dati è la
<i>media</i> definita come media aritmetica tra tutti i valori dei dati osservati.
</p>

<p>
Supponiamo di indicare con \(x_1, \dots, x_n\) l'insieme delle osservazioni disponibili (valori) allora
definiremo la <i>media</i> come \(\bar{x} = \frac{1}{n} \sum_{i = 1}^{n} x_i = \frac{x_1 + \dots + x_n}{n}\)
</p>

<p>
Nel caso in cui i <i>dati siano di tipo quantitativo discreto</i> allora avremo
\(\bar{x} = \frac{1}{n} \sum_{i = 1}^{n} s_j f_j = \frac{s_1 f_1+ \dots + s_N f_N}{n}\)
</p>

<p>
\(\bar{x} = \sum_{j=1}^n s_j p_j = s_1 p_1 + \dots + s_n p_N\).
</p>

<p>
<i>Momento \(k\)-esimo</i> rispetto ad \(y\):
\(M_{k, y} = \frac{1}{n} \sum_{i=1}^n (x_i - y)^k\).
</p>

<p>
Allora la media è anche il momento primo rispetto all'origine:
\(x = \frac{1}{n} \sum_{i=1}^n x_i\).
</p>

<p>
\(x = \frac{1}{n} \sum_{i=1}^n (x_i - 0)^1\).
</p>

<p>
Un secondo indice di tendenza è rappresentata dalla <i>mediana</i> definita come quel numero reale che precede tanti
elementi delle serie di dati quanti ne segue.
</p>

<p>
Se ordiniamo la serie di dati \(x_1, \dots, x_n\) in modo crescente ottenendo la serie x(1), &#x2026;, x(n),
la mediana \(\hat{x}\) è data:
</p>
<ul class="org-ul">
<li>Dall'elemento di posto \(\frac{(n+1)}{2}\) se \(n\) è dispari.</li>
<li>Dalla media aritmetica tra l'elemento di posto \(\frac{n}{2}\) e quello di posto \(\frac{n}{2} + 1\) se \(n\)
è pari.</li>
</ul>

<p>
Un ultimo indice di tendenza è rappresentato dalla <i>moda</i> \(\tilde{x}\) definita come quel valore o classe cui
corrisponde la massima frequenza assoluta.
</p>

<p>
La moda viene spesso utilizzata nel caso di dati qualitativi ovvero quando risulti impossibile definire
media e mediana.
</p>

<p>
Si osservi che non è garantita l'unicità della moda. Infatti parleremo di:
</p>
<ul class="org-ul">
<li>Distribuzione <i>uni-modale</i> nel caso in cui vi sia un'unica moda.</li>
<li>Distribuzione <i>multi-modale</i> nel caso in cui vi siano più mode.</li>
</ul>

<p>
Per esempio:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_12-39-12.png" alt="screenshot_2018-03-01_12-39-12.png" />
</p>
</div>



<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_12-39-23.png" alt="screenshot_2018-03-01_12-39-23.png" />
</p>
</div>

<p>
Il calcolo della mediana richiede di ordinare la serie di dati.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_12-39-45.png" alt="screenshot_2018-03-01_12-39-45.png" />
</p>
</div>

<p>
Per quanto riguarda il calcolo della moda è banale ricavarla dalla tabella delle frequenze.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_12-40-09.png" alt="screenshot_2018-03-01_12-40-09.png" />
</p>
</div>

<p>
Si ricerca il valore con massima frequenza assoluta ottenendo che la moda è \(\tilde{x} = 4\).
</p>

<p>
<i>Indice di variabilità</i>
</p>

<p>
Siano date le seguenti serie di dati: \(E_1 = \{0.5, 0.8, 2.0, 2.7, 4.0\}\) ed \(E_2 = \{1.4, 1.7, 2.0, 2.1, 2.8\}\)
che rappresentano il reddito mensile (migliaia di euro) di due gruppi distinti di individui (appartenenti a
due diverse regioni). Le due serie di dati appaiono molto diverse tra loro. Gli elementi di \(E_1\) sono molto
disomogenei tra loro mentre non lo sono quelli di \(E_2\). Entrambi i casi hanno però ugual <i>media</i> e <i>mediana</i>.
</p>

<p>
Gli indici di tendenza centrale, quindi, non sono utili per fornire informazioni circa l'omogeneità o
disomogeneità dei dati.
</p>

<p>
Per ovviare a tale limite vengono introdotti gli indici che misurano il grado di <i>omogeneità</i> o <i>dispersione</i>
dei dai.
</p>

<p>
Il più importante tra questi è senz'altro la <i>varianza</i> definita come: \(x^2 = \frac{1}{n} (x_i - \bar{x})^2\).
Viene definita confrontando ogni singola osservazione \(x_i\) con la media \(\bar{x}\) e sommando i quadrati
delle differenze così ottenute.
</p>

<p>
Ricordando la definizione \(M_{k, y} = \frac{1}{n} \sum_{i=1}^n (x_i - y)^k\) la <i>varianza</i> è allora il <i>momento secondo
rispetto alla media</i>: \(x^2 = \frac{1}{n} (x_i - \bar{x})^2\).
</p>

<p>
Viene introdotto il quadrato perché in caso contrario \(\frac{1}{n} \sum_{i=1}^n (x_i - \bar{x}) = 0\). La
varianza è tanto più grande quanto più i singoli dati si scostano dalla media, vale a dire tanto più
i dati risultano disomogenei. Nel caso in esame avremo: \(s_{E_1}^2 = 1.69\) e \(s_{E_2}^2 = 0.22\). E pertanto
la misura varianza consente di rappresentare il <i>grado di disomogeneità</i> della serie di dati.
</p>

<p>
Nel caso di <i>caratteri quantitativi discreti</i>, di cui sia nota la distribuzione di frequenza, la <i>varianza</i>
può essere calcolata tramite le seguenti formule:
</p>

<p>
\(s^2 = \frac{1}{n} \sum_{j=1}^N (s_j - \bar{x})^2 f_j = \sum_{j=1}^N (s_j - \bar{x})^2 p_j\). Alternativamente la <i>varianza</i> può essere
calcolata tramite la seguente formula: \(s^2 = \frac{1}{n} \sum_{i=1}^n x_i^2 - \bar{x}^{2}\).
</p>

<p>
Analogamente è possibile mostrare che per <i>caratteri quantitativi discreti</i> vale la seguente relazione:
\(s^2 = \sum_{j=1}^{N} s_j^2 p_j - \bar{x}^2\).
</p>

<p>
Poiché la dimensione della varianza è il quadrato di quella dei dati,
in molti casi si preferisce una diversa misura detta <i>scarto quadratico medio</i>:
</p>

<p>
\(s = \sqrt{s^2} = \sqrt{\frac{1}{n} \sum_{i=1}^n x_i^2 - \bar{x}^2} = \sqrt{\frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2}\).
</p>

<p>
Il molti casi si è interessati a studiare fenomeni che coinvolgono due o più caratteri della popolazione
tali da non potersi considerare separatamente. Si pensi ad esempio al caso in cui vengano considerati
separatamente. 
</p>

<p>
Si pensi ad esempio al caso in cui vengano considerati i seguenti caratteri:
</p>
<ul class="org-ul">
<li>Valore al metro quadro.</li>
<li>Superficie.</li>
</ul>
<p>
per un insieme di appartamenti di una data zona di una città.
</p>

<p>
In quel caso è necessario considerare congiuntamente le due caratteristiche, vale a dire procedere in modo
differente a quanto fatto fin qui. Limitiamoci a considerare il caso di due caratteri contemporanei.
</p>

<p>
In questo caso l'insieme dei dati statistici \(E\) sarà costituito da coppie di valori \(E = \{(x_1, y_1), \dots, (x_n, y_n)\}\).
</p>

<p>
Ipotizziamo inoltre che entrambi i caratteri siano di tipo quantitativo e discreto.
</p>

<p>
I caratteri quantitativi continui vengono trattati in modo analogo previo una procedura di raggruppamento in classi.
</p>

<p>
Sia \(S = \{(s_j, u_k), j = 1, \dots, N; k = 1, \dots, M\}\) l'insieme delle coppie di valori assumibili dalla coppia di caratteri
analizzati. Viene detta <i>frequenza assoluta</i> di \((s_j, u_k)\) la quantità \(f_{jk}\) definita come \(f_{jk}\) = numero di elementi
\(E\) aventi valore \((s_j, u_k)\).
</p>

<p>
Definiremo <i>distribuzione di frequenza assoluta doppia</i> la funzione \(f\) che associa ad ogni coppia di valori \((s_j, u_k)\)
la corrispondente frequenza \(f_{jk}\).
</p>

<p>
Analogamente al caso unidimensionale vengono solitamente definiti ed utilizzati altri tipi di frequenze:
</p>
<ul class="org-ul">
<li>Frequenza cumulata assoluta: \(F_{jk} = \sum_{r:s_r \leq s_j; l:u_l \leq u_k} f_{rl}\).</li>
<li>Frequenza relativa: \(p_{jk} = \frac{f_{jk}}{n}\).</li>
<li>Frequenza cumulata relativa: \(P_{jk} = \sum_{r:s_r \leq s_j; l:u_l \leq u_k} p_{rl}\).</li>
</ul>

<p>
Con <i>distribuzione di frequenza doppia</i> si intende infine una qualsiasi delle funzioni \(f, F, p, P\) che
associ ad ogni coppia (s<sub>j</sub>, u<sub>k</sub>) la corrispondente frequenza. In aggiunta alla distribuzioni appena citate,
analoghe a quelle del caso unidimensionale, esistono altre distribuzioni di frequenza spesso prese in
considerazione.
</p>

<p>
<i>Distribuzioni marginali</i>: distribuzioni dei singoli caratteri presi indipendentemente dagli altri.
</p>

<p>
Nel caso ci si riferisca al primo carattere, per ogni valore assumibile ad esso, sia \(s_j\), è detta
<i>frequenza assoluta marginale</i> la quantità \(f_{xj}\) data dal numero di elementi \(E\) il cui primo carattere
ha valore \(s_j\), vale a dire \(f_{xj}\) = numero di elementi \(E\) aventi valore \((s_{j}, *)\).
</p>

<p>
Analogamente avremo:
</p>
<ul class="org-ul">
<li>Frequenza assoluta marginale: \(F_{xj}\) = somma delle frequenze assolute marginali di tutti i valori \(s_k\) tali che
\(s_k \leq s_j\).</li>
<li>Frequenza relativa marginale: \(p_{xj}\) = rapporto tra frequenza assoluta marginale \(f_{xj}\) e numerosità \(n\) delle
osservazioni.</li>
<li>Frequenza cumulata relativa marginale: \(P_{xj}\) = somma delle frequenze relative marginali di tutti i valori \(s_k\)
tali che \(s_k \leq s_j\).</li>
</ul>

<p>
Per esempio:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_13-14-48.png" alt="screenshot_2018-03-01_13-14-48.png" />
</p>
</div>



<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_13-15-01.png" alt="screenshot_2018-03-01_13-15-01.png" />
</p>
</div>

<p>
Es.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_13-15-19.png" alt="screenshot_2018-03-01_13-15-19.png" />
</p>
</div>

<p>
Consideriamo due serie \(\{x_i\}\ \{y_i\},\ i = 1, \dots, n\) e poniamo a confronto le variazioni delle coppie di dati rispetto ai
corrispondenti valori medi considerando le <i>coppie di scarti</i> \(x_i - \bar{x}\) e \(y_i - \bar{y}\). Risulta abbastanza
naturale pensare che esista una relazione di dipendenza tra i due caratteri se a valori positivi (negativi) dello scarto
\(x_i - \bar{x}\) corrispondono sistematicamente o quasi sempre valori positivi o negativi dello scarto \(y_i - \bar{y}\).
</p>

<p>
<i>Covarianza</i>: si definisce covarianza \(c_{xy}\) (dei dati o campionaria) delle due serie di dati \(\{x_i\}\ \{y_i\}\):
\(c_{xy} = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})\), \(s^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2\).
</p>

<p>
La covarianza assume un valore positivo (negativo) che diviene grande in valore assoluto nel caso in cui i termini prodotto
\((x_i - \bar{x}) (y_i - \bar{y})\) abbiano segni concordi (positivi o negativi che siano). In questo caso si parla di
serie statistiche fortemente correlate o per meglio dire di dati delle serie fortemente correlati.
</p>

<p>
Nel caso opposto vale a dire nel caso in cui i dati delle serie siano incorrelati (non vi è dipendenza degli uni
dagli altri) avremo che i prodotti \((x_i - \bar{x})(y_i - \bar{y})\) avranno segni diversi (discordi in segno) e la
covarianza, per come definita, risulterà piccola in valore assoluto (prossima al valore 0). La covarianza può
essere calcolata anche tramite la seguente formula:
</p>

<p>
\(c_{xy} = \frac{1}{n} \sum_{i=1}^n x_i y_i - \bar{x} \bar{y}\), \(s^2 = \frac{1}{n} \sum_{i=1}^n x_i^2 - \bar{x}^2\).
</p>

<p>
Nel caso in cui i dati si riferiscano a caratteri quantitativi discreti, di cui è nota la distribuzione di
frequenza doppia, è possibile utilizzare le seguenti formule per il calcolo della covarianza.
</p>

<p>
\(c_{xy} = \sum_{j=1}^N \sum_{k=1}^M (s_j - \bar{x})(u_k - \bar{y}) p_{jk} = \sum_{j=1}^N \sum_{k=1}^M s_j u_k p_{jk} - \bar{x} \bar{y}\).
</p>

<p>
Due serie di dati \(\{x_i\}\ \{y_i\}\) si dicono:
</p>
<ul class="org-ul">
<li>Statisticamente incorrelate se \(\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) = 0\) e quindi \(c_{xy} = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) = 0\);</li>
<li>Statisticamente indipendenti se vale la seguente condizione:
\(\forall j = 1, \dots, N\) e \(k = 1, \dots, M \quad p_{jk} = p_j p_k\), con \(p_{jk} = \frac{f_{jk}}{n}\), \(p_j = \frac{f_j}{n}\), \(p_k = \frac{f_k}{n}\).</li>
</ul>

<p>
Due serie di dati statisticamente indipendenti sono incorrelate mentre non è necessariamente vero il contrario.
</p>

<p>
Statisticamente indipendenti \(\implies\) statisticamente incorrelate.
</p>

<p>
Statisticamente incorrelate \(\not\implies\) statisticamente indipendenti.
</p>

<p>
Infatti: \(\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) = \sum_{i=1}^n (x_i - \bar{x}) \sum_{i=1}^n (y_i - \bar{y}) = 0\).
</p>

<p>
Nel caso bidimensionale (variabili \(x\) e \(y\)) la covarianza si può rappresentare attraverso una matrice
\(2 \times 2\):
</p>
\begin{equation*}
c = 
\begin{bmatrix}
c_{xx} &c_{xy}\\
c_{xy} &c_{yy}
\end{bmatrix}
=
\begin{bmatrix}
var(x) &cov(x, y)\\
cov(x, y) & var(y)
\end{bmatrix}
\end{equation*}
<p>
È indipendente dalla grandezza delle varianze.
</p>

<p>
Per una misura indipendente dalla variabilità delle grandezze si usa la matrice di correlazione:
</p>
\begin{equation*}
\text{Corr} =
\begin{bmatrix}
\frac{c_{xx}}{\sigma_x^2} &\frac{c_{xy}}{\sigma_x \sigma_y}\\
\frac{c_{xy}}{\sigma_x \sigma_y} &\frac{c_{yy}}{\sigma_y^2}
\end{bmatrix}
=
\begin{bmatrix}
1 &corr(x, y)\\
corr(x, y) &1
\end{bmatrix}
\end{equation*}
<p>
Nel caso di \(m\) variabili,
</p>
\begin{equation*}
\text{Corr} =
\begin{bmatrix}
1 &\frac{c_{x_1 x_2}}{\sigma_{x_1} \sigma_{x_2}} &\dots &\frac{c_{x_1 x_m}}{\sigma_{x_1} \sigma_{x_m}}\\
\frac{c_{x_1 x_2}}{\sigma_{x_1} \sigma_{x_2}} &1 &\dots &\vdots\\
\vdots &\ddots &\ddots &\vdots\\
\frac{c_{x_1 x_m}}{\sigma_{x_1} \sigma_{x_m}} &\dots &\dots &1
\end{bmatrix}
\end{equation*}

<p>
<i>Regressione lineare per serie di dati</i>
</p>

<p>
Consideriamo un campione costituito da un insieme \(E\) di coppie di dati, relativi a due caratteri \(x\) ed \(y\):
\(E = \{L(x_1, y_1), \dots, (x_n, y_n)\}\). In molti casi ci si pone la questione se tra tali caratteri \(x\) ed \(y\) esista
un legame di tipo funzionale o una relazione di tipo funzionale che ne descriva in modo soddisfacentemente
corretto il legame realmente esistente. Un'analisi tesa a rispondere a una tale questione viene detta <i>analisi
di regressione</i>.
</p>

<p>
Un tale studio viene affrontato pensando ad uno dei due caratteri come ad una <i>variabile indipendente</i>, sia
per esempio il carattere \(x\), e cercando di stabilire quale funzione \(f\), all'interno di una ben determinata
classe, consenta di scrivere la seguente relazione \(y = f(x)\) in modo che essa descriva al meglio il legame
tra la variabile indipendente \(x\) e il carattere \(y\) che a questo punto viene interpretato coma <i>variabile
dipendente</i>. Occorre specificare cosa si intende per funzione che meglio descrive il legame tra i due caratteri.
Solitamente si determina la funzione \(f\) che minimizza le distanze tra i valori osservati del carattere \(y\) e quelli
che si otterrebbero per il carattere \(y\) se la relazione che lega il carattere \(y\) ad \(x\) fosse proprio quella descritta
da \(f\).
</p>

<p>
In altri termini quello che si cerca è la funzione \(f\) che minimizza la seguente quantità \(g(f) = \sum_{i=1}^n [f(x_i) - y_i]^2\) dove
il quadrato si utilizza affinché le distanze vengano tutte considerate con segno positivo. Nel caso particolare in cui \(f\)
sia vincolata ad essere una funzione lineare (retta) allora parleremo di <i>regressione lineare</i>.
</p>

<p>
Nel caso della <i>regressione lineare</i> il problema si riduce alla determinazione dei coefficienti \(m\) e \(q\) della retta
\(y = mx + q\) per cui risulti minima la quantità \(g(m, q) = \sum_{i=1}^n [mx_i + q - y_i]^2\).
</p>

<p>
I valori \(mx_i + q\) sono proprio i valori \(f(x_i)\) che rappresentano l'approssimazione alle \(y_i\) tramite
la funzione \(f\).
</p>

<p>
Risolvendo il sistema algebrico ottenuto e ricordando le definizioni di varianza e covarianza si ottiene in
definitiva \(m = \frac{c_{xy}}{s_x^2}\) e \(q = \bar{y} - \frac{c_{xy}}{s_x^2} \bar{x}\).
</p>

<p>
Questo metodo consente di determinare la retta che meglio descrive la relazione tra i due caratteri senza
peraltro fornire alcuna indicazione circa il grado di approssimazione che è in grado di offrire. Per tale
motivo è stata introdotta una nuova grandezza detta <i>coefficiente di correlazione lineare</i>: \(r_{xy} = \frac{c_{xy}}{s_x s_y}\).
</p>

<p>
L'importanza di tale coefficiente deriva dal fatto che esso assume valori sempre appartenenti all'intervallo
\([-1, 1]\). Inoltre:
</p>
<ul class="org-ul">
<li>È nullo nel caso in cui le serie di dati sono <i>statisticamente incorrelate</i>.</li>
<li>È pari ad 1 (in valore assoluto) quando le <i>coppie di dati</i> si trovano <i>esattamente sulla retta</i>
\(y = mx + q\).</li>
</ul>
<p>
Pertanto esso rappresenta <i>il grado di allineamento delle coppie di dati</i>.
</p>

<p>
Per esempio, supponiamo di voler controllare la resistenza di un campione di 15 travi di cemento, tutte
ottenute dalla stessa gettata, misurando sia i carichi di prima lesione che quelli di rottura finale e
supponiamo che i dati disponibili siano i seguenti:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_14-22-07.png" alt="screenshot_2018-03-01_14-22-07.png" />
</p>
</div>

<p>
È possibile computare il coefficiente di correlazione che sarà pari a \(r_{xy} = 0.0195\).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_14-22-49.png" alt="screenshot_2018-03-01_14-22-49.png" />
</p>
</div>

<p>
<i>Regressione (modello lineare) per serie di dati</i>
</p>

<p>
Abbiamo accennato in precedenza al fatto che non si è sempre vincolati alla scelta di una retta tra le
funzioni che possono descrivere la relazione tra le due serie di dati.
</p>

<p>
Quanto esposto in precedenza può essere applicato anche nel caso in cui si considerino relazioni funzionali
di diversa natura, la cui scelta può essere suggerita da una qualche impressione derivante da ispezioni
visive dei dati o da altre forme di conoscenza circa il fenomeno analizzato.
</p>

<p>
Per esempio, si faccia ancora riferimento ai dati dell'esempio precedente e si valuti l'opportunità di
sfruttare il seguente modello:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-01_14-25-32.png" alt="screenshot_2018-03-01_14-25-32.png" />
</p>
</div>

<p>
Si noti inoltre che molte relazioni funzionali non lineari possono essere ricondotte a tali (lineari)
con opportune trasformazioni delle variabili. Per esempio, una relazione del tipo \(y = a \cdot e^{bx}\) può
essere riscritta come \(\tilde{y} = \beta \cdot \tilde{x} + \alpha\), dove \(\tilde{y} = \log{(y)}\), \(\tilde{x} = x\) e
\(\alpha = \log{(a)}\), \(\beta = b\).
</p>

<p>
La determinazione dei coefficienti \(a\) e \(b\) che meglio permettono di approssimare una serie di punti
\(\{x_i, y_i\}\) può essere effettuata riconducendosi ad una regressione lineare ovvero determinando i
coefficienti \(\alpha\) e \(\beta\) che meglio approssimano, linearmente, la serie dei punti \(\{\tilde{x_i} \tilde{y_i}\}\), dove
\(\tilde{y_i} = \log{(y_i)}\) e \(\tilde{x_i} = x_i\). Una volta determinati tali coefficienti, il calcolo di \(a\) e \(b\)
risulta immediato.
</p>

<p>
Alcune funzioni riconducibili a lineari:
</p>
<ul class="org-ul">
<li>\(y = a \log{(x)} + b\);</li>
<li>\(y = a x^b\);</li>
<li>\(y = \frac{1}{a + b \cdot e^{-x}}\), \(\beta = b\).</li>
</ul>
</div>
</div>

<div id="outline-container-org05b382b" class="outline-3">
<h3 id="org05b382b"><span class="section-number-3">2.2</span> Calcolo delle probabilità</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Teoria (assiomatica o frequentista o soggettiva) che riguarda il calcolo della probabilità del verificarsi di certi
eventi composti di eventi elementari. È lo strumento base per la <i>statistica</i>, che trae conclusioni su una popolazione,
utilizzando i dati osservati su una collezione di individui (campione) appartenenti alla popolazione (inferenza su
popolazione).
</p>

<p>
Al fine di presentare l'<i>impostazione assiomatica</i> supponiamo di voler studiare una situazione (esperimento) avente un 
insieme \(\Omega\) di diversi possibili esiti, ben distinti tra loro. Ogni sottoinsieme \(A\) di \(\Omega\) viene detto <i>evento</i>.
Ad ogni evento \(A\) è associabile una quantità numerica detta <i>probabilità</i> e denotata tramite \(P(A)\) il cui significato
varia a seconda dell'impostazione.
</p>

<p>
<i>Impostazione assiomatica</i>
</p>

<p>
L'insieme \(\Omega\) che può contenere un numero finito o infinito di elementi viene detto <i>spazio campione</i>.
</p>

<p>
Ogni evento può essere <i>elementare</i> se è costituito da un elemento singolo di \(\Omega\), oppure <i>composto</i> in caso
contrario.
</p>

<p>
Due eventi \(A\) e \(B\) vengono detti <i>incompatibili</i> se sono <i>sottoinsiemi disgiunti</i>.
</p>

<p>
Si definisce <i>insieme delle parti</i> di \(\Omega\) l'insieme di tutti i suoi sottoinsiemi e lo si denota tramite \(\mathcal{P}(\Omega)\)
</p>

<p>
La probabilità deve essere definita per tutti gli elementi di \(\mathcal{P}(\Omega)\) con particolari proprietà (algebra di Boole
o \(\sigma\)-algebre).
</p>

<p>
Per esempio:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-06_11-50-52.png" alt="screenshot_2018-03-06_11-50-52.png" />
</p>
</div>

<p>
Possibili eventi sono i suoi sottoinsiemi, \(\{R\}\) e \(\{B, G\}\)
</p>

<p>
Un altro esempio:
</p>

<p>
Consideriamo un esperimento che può fornire come risultato un qualsiasi valore reale in un intervallo
\([a, b] \subseteq \mathbb{R}\).
</p>

<p>
In questo caso avremo:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-06_11-54-12.png" alt="screenshot_2018-03-06_11-54-12.png" />
</p>
</div>

<p>
<i>Definizione di probabilità secondo Kolmogorov</i>
</p>

<p>
Viene detta <i>misura di probabilità</i> ogni applicazione \(P : \mathcal{P}(\Omega) \to \mathbb{R}_0^+\) che associa
un valore reale ad ogni sottoinsieme di \(\Omega\) e per cui valgono le seguenti proprietà:
</p>
<ul class="org-ul">
<li><p>
Per ogni \(A \subseteq \Omega\) esiste ed è unico un numero \(P(A) \geq 0\).
</p>

<p>
Interpretando \(P(A)\) come <i>frequenza relativa</i> dell'evento \(A\), essa è compresa tra 0 e 1.
</p></li>

<li>\(P(\Omega) = 1\);</li>
<li>Data la famiglia \(\{A_i, i \in I \subseteq \mathbb{N}\}\) di eventi incompatibili vale
\(P\left(\bigcup_{i \in I} A_i \right) = \sum_{i \in I} P(A_i)\);</li>
</ul>

<p>
Ogni <i>misura di probabilità</i> è una funzione che assegna valori numerici a sottoinsiemi di \(\Omega\) e non ai suoi
elementi (eventi elementari), come contrariamente si è portati a pensare.
</p>

<p>
Per esempio consideriamo lo spazio campione: \(\Omega = [a, b] \subseteq \mathbb{R}\). Una misura di probabilità
da assegnare a \(\mathcal{P}(\Omega) \to \mathbb{R}_0^+\) definita ponendo \(P((c, d)) = \frac{d-c}{b-a}\) quando
l'evento che consideriamo è un intervallo \((c, d) \subseteq [a, b] \quad a \leq c < d \leq b\). Possiamo, per
esempio, porre \(P(\{s\}) = 0\) per ogni \(s \in [a, b]\), in modo da poter calcolare anche la probabilità
di eventi con estremi inclusi.
</p>

<p>
Dalle 3 proprietà che definiscono le misure di probabilità, discendono in modo immediato alcune <i>proprietà
aggiuntive</i>. Sia \(P\) una misura di probabilità definita sull'insieme delle parti \(\mathcal{P}(\Omega)\) di uno
spazio campione \(\Omega\).
Allora:
</p>
<ul class="org-ul">
<li>Per ogni \(A \subseteq \Omega\) vale \(P(\bar{A}) = 1 - P(A)\);</li>
<li>Per ogni \(A \subseteq \Omega\) vale \(P(A) \leq 1\);</li>
<li>Per ogni \(A, B \subseteq \Omega\) se \(A \subseteq B\) allora \(P(A) \leq P(B)\);</li>
<li>Per ogni \(A, B \subseteq \Omega\) anche non incompatibili, vale \(P(A \cup B) = P(A) + P(B) - P(A \cap B)\);</li>
<li>Per ogni \(A \subseteq \Omega\) vale \(P(\bar{A}) = 1 - P(A)\), infatti \(1 = P(A \cup \bar{A}) = P(A) + P(\bar{A}) - P(A \cap \bar{A}) =
  P(A) + P(\bar{A}) - 0\);</li>
<li>Per ogni \(A, B \subseteq \Omega\) anche non incompatibili, vale \(P(A \cup B) = P(A) + P(B) - P(A \cap B)\);</li>
<li>Per ogni \(A, B \subseteq \Omega\) anche non incompatibili, vale \(P(A \cup B) = P(A \cap \bar{B}) + P(A \cap B) + P(\bar{A} \cap B)\);</li>
<li>Per ogni \(A, B \subseteq \Omega\) anche non incompatibili, vale \(P(A) = P(A \cap \bar{B}) + P(A \cap B)\) e \(P(B) = P(A \cap B) + P(\bar{A} \cap B)\).</li>
</ul>

<p>
In base alle precedenti proprietà è possibile osservare che la proprietà:
</p>
<ul class="org-ul">
<li>Data la famiglia \(\{A_i, i \in I \subseteq N\}\) di eventi incompatibili vale \(P\left(\bigcup_{i \in I} A_i \right) = \sum_{i \in I} P(A_i)\)</li>
</ul>
<p>
È un caso particolare della proprietà:
</p>
<ul class="org-ul">
<li>Per ogni \(A, B \subseteq \Omega\) anche non incompatibili, vale \(P(A \cup B) = P(A) + P(B) - P(A \cap B)\) nel caso in cui gli
eventi \(A\) e \(B\) siano incompatibili (\(A \cap B = \emptyset\)).</li>
</ul>

<p>
Per esempio, supponiamo di avere effettuato un investimento immobiliare e di avere a disposizione 3 appartamenti di
diverso valore da vendere. Supponiamo di essere interessati a fare delle stime sui ricavi del nostro investimento
tenendo conto di quanti di tali appartamenti saranno stati venduti entro la fine dell'anno. Un modo per descrivere
tutte le possibili situazioni relative alle vendite alla fine dell'anno consiste nell'associare a ciascuna di esse
una terna \((\alpha_1, \alpha_2, \alpha_3)\), dove \(\alpha_i = 1\) se l'appartamento \(i\)-mo sarà stato venduto alla fine dell'anno e
\(\alpha_i = 0\) in caso contrario.
</p>

<p>
In questo modo l'insieme delle possibili situazioni alla fine dell'anno può essere descritta come
\(\Omega = \{(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 0, 1), (1, 1, 0), (1, 0, 1), (0, 1, 1), (1, 1, 1)\}\).
</p>

<p>
Supponiamo ora che gli 8 casi realizzabili (eventi elementari) siano egualmente possibili ovvero che la
misura di probabilità adatta a descrivere il fenomeno sia la \(P\) definita come segue:
\(P(A) = \frac{\text{numero di elementi di } A}{\text{numero di elementi di } \Omega}\) per ogni elemento \(A\) di \(\Omega\).
</p>

<p>
Consideriamo ora l'evento \(A\): "almeno un appartamento viene venduto".
</p>

<p>
Siamo pertanto interessati al seguente evento: \(A = \{(1, 0, 0), (0, 1, 0), (0, 0, 1), (1, 1, 0), (1, 0, 1), (0, 1, 1), (1, 1, 1)\}\).
Poiché esso contiene 7 elementi su un totale di 8 casi possibili, allora: \(P(A) = \frac{\text{numero di elementi di } A}{\text{numero di elementi di } \Omega}
= \frac{7}{8}\).
</p>

<p>
Consideriamo ora l'evento \(B\): "almeno due appartamenti vengono venduti". È abbastanza chiaro che ogni situazione di vendita contenuta
in \(B\) lo è a maggior ragione in \(A\) (almeno 1 venduto contiene almeno 2 venduti) per cui \(B \subseteq A\). In effetti avremo
\(B = \{(1, 1, 0), (1, 0, 1), (0, 1, 1), (1, 1, 1)\}\) da cui si ricava \(P(B) = \frac{4}{8} = \frac{1}{2}\), \(P(A) = \frac{7}{8}\).
Pertanto vale quanto asserito in precedenza, ovvero che \(B \subseteq A \implies P(B) \leq P(A)\). Infine, consideriamo l'evento
\(C\) "il terzo appartamento viene venduto", ovvero \(C = \{(0, 0, 1), (1, 0, 1), (0, 1, 1), (1, 1, 1)\}\). Supponiamo
di essere interessati a determinare la probabilità di \(B \cup C\): \(P(B \cup C) = P(B) + P(C) - P(B \cap C) = \frac{1}{2} + \frac{1}{2}
= \frac{5}{8}\) essendo \(B \cap C = \{(1, 0, 1), (0, 1, 1), (1, 1, 1)\}\). In effetti \(P(B \cup C)\) avrebbe potuto essere determinata direttamente
osservando che \(B \cup C = \{(0, 0, 1), (1, 1, 0), (1, 0, 1), (0, 1, 1), (1, 1, 1)\}\).
</p>

<p>
Esempio: da un'urna con 6 palline bianche e 5 palline nere se ne estraggono 2. Qual'è la probabilità che una delle palline
estratte sia bianca e l'altra nera?.
</p>

<p>
Lo spazio campione ha \(11 \cdot 10 = 110 \text{elementi}\). Ci sono \(6 \cdot 5 = 30\) modi in cui la prima estratta è bianca e la seconda è nera,
e \(5 \cdot 6 = 30\) modi in cui la prima estratta è nera e la seconda è bianca. Quindi, pensando che tutti i punti dello spazio
campione siano egualmente probabili, la probabilità cercata è: \(\frac{30 + 30}{110} = \frac{6}{11}\).
</p>

<p>
Secondo esempio: in quanti modi si possono ordinare le lettere \(a, b, c\) (senza ripetizione)?
</p>

<p>
Ce ne sono 6 (\(3 \cdot 2\)): abc, acb, bac, bca, cab, cba. Ciascuno di questi ordinamenti è una <i>permutazione</i>.
</p>

<p>
In generale \(n \cdot (n-1) \cdot \cdots \cdot 2 \cdot 1 = n!\)
</p>

<p>
Terzo esempio: qual'è la probabilità che tra \(n\) persone ce ne siano almeno 2 che compiono gli anni lo stesso
giorno dell'anno? → \(356 \cdot \dots 365 = 365^n\) possibilità.
</p>

<p>
Ragioniamo sull'evento negato, calcoliamo la probabilità che le \(n\) persone abbiano tutte compleanni in giorni
diversi:
</p>
<ul class="org-ul">
<li>La prima persona ha 365 possibili giorni per il proprio compleanno;</li>
<li>La seconda può averlo solo nei rimanenti 364;</li>
<li>La terza solo nei rimanenti 363.</li>
<li>Ecc.</li>
</ul>

<p>
La probabilità che i compleanni non coincidano in nessun caso (per nessuna delle \(n\) persone) è:
\(\frac{365 \cdot 364 \cdot \cdots \cdot (365 - n+1)}{365^n}\). Pertanto, la probabilità che almeno 2 persone su \(n\) compiano
gli anni gli anni lo stesso giorno è \(1 - \frac{365 \cdot 364 \cdot \dots \cdot (365 - n+1)}{365^n}\)
</p>

<p>
Nel caso di n = 23:
</p>

<p>
La probabilità che i compleanni non coincidano in nessuno caso (per nessuna delle \(n\) persone) è:
\(\frac{365 \cdot 364 \cdot \cdots \cdot (365 - 23 + 1)}{365^n} = 0.4927\).
</p>

<p>
Pertanto, la probabilità che almeno 2 persone su \(n\) compiano gli anni lo stesso giorno è:
\(1 - \frac{365 \cdot 364 \cdot \cdots \cdot (365 - 23 + 1)}{365^n} = 0.5073\).
</p>

<p>
Si voglia determinare il numero di differenti gruppi di \(r\) oggetti che è possibile costruire (formare)
usando \(n\) oggetti diversi (non importa l'ordine degli oggetti).
</p>

<p>
Per esempio: quanti gruppi diversi di 3 oggetti è possibile costruire dai 5 oggetti \(A, B, C, D, E\)?
</p>

<ul class="org-ul">
<li>Il primo può esser scelto in 5 modi diversi;</li>
<li>Il secondo in 4;</li>
<li>Il terzo in 3.</li>
</ul>

<p>
Però, lo stesso gruppo di 3, per esempio \(ABC\), può presentarsi come \(ABC, ACB, BAC, BCA, CAB, CBA\), ma il gruppo è
sempre lo stesso. Perciò il numero di gruppi diversi è: \(\frac{5 \cdot 4 \cdot 3}{3 \cdot 2 \cdot 1} = 10\).
</p>

<p>
In generale: \(\frac{n (n-1) \cdots (n - r +1)}{r!} = \frac{n!}{(n-r)! r!} = \binom{n}{r}\)
detto <i>coefficiente binomiale</i>, numero delle <i>combinazioni</i> di \(n\) oggetti presi a gruppi di \(r\).
</p>

<p>
Esempio: si selezioni a caso un gruppo di 5 persone da un insieme di 6 uomini e 9 donne. Qual'è la probabilità che nel gruppo
selezionato ci siano esattamente 3 uomini e 2 donne?
</p>

<p>
Ognuna delle \(\left(\begin{smallmatrix}15\\5\end{smallmatrix}\right)\) combinazioni è ugualmente probabile. Ci sono
\(\left(\begin{smallmatrix}6\\3\end{smallmatrix}\right)\) scelte possibili per la scelta dei 3 uomini e
\(\left(\begin{smallmatrix}9\\2\end{smallmatrix}\right)\) per la scelta delle 2 donne.
</p>

<p>
Perciò la probabilità \(\frac{\left(\begin{smallmatrix}6\\3\end{smallmatrix}\right) \cdot \left(\begin{smallmatrix}9\\2\end{smallmatrix}\right)}{\left(\begin{smallmatrix}15\\5\end{smallmatrix}\right)}
= \frac{240}{1001}\)
</p>

<p>
Siano dati uno spazio campione \(\Omega\) ed una misura di probabilità \(P\) definita sul suo insieme delle parti \(\mathcal{P}(\Omega)\)
</p>

<p>
Secondo l'impostazione assiomatica di probabilità, considerati due eventi, \(A\) e \(B\), con \(P(B) > 0\), è detta <i>probabilità
dell'evento</i> \(A\) condizionata dall'evento \(B\) la quantità \(P(A|B) = \frac{P(A \cap B)}{P(B)}\).
</p>

<p>
Per esempio: si consideri un lotto di produzione di transistor. 5 di questi sono difettosi immediatamente, 10 parzialmente
difettosi (non funzionano dopo un uso di 2 ore), e 25 sono accettabili. Si scelga a caso un transistor. Se non risulta
immediatamente difettoso, qual'è la probabilità che sia accettabile (cioè funzioni dopo un uso di 2 ore)?
</p>

<p>
Poiché non risulta immediatamente difettoso, non è uno dei 5: quindi
\[ P(\text{accett.}|\text{non  immed. difet.}) = \frac{P(\text{accett.} \cap \text{non immed. difet.})}{P(\text{non immed. difet.})}
= \frac{P(\text{accett.})}{P(\text{non immed. difet.})} = \frac{\frac{25}{40}}{\frac{35}{40}} = \frac{5}{7}\]
</p>

<p>
Si riprenda in esame l'esempio degli appartamenti. Si supponga di essere interessati a determinare la probabilità dell'evento \(B\)
"almeno 2 appartamenti verranno venduti" sapendo con certezza che si è verificato l'evento \(C\) "il terzo appartamento viene venduto".
</p>

<p>
In questo caso ci troviamo di fronte ad un condizionamento, infatti il verificarsi certo dell'evento \(C\) influisce sulla
possibilità che si verifichi anche \(B\). La nuova probabilità da associare a \(B\) diventa allora: \(P(B \cap C) = \frac{3}{8}\).
</p>

<p>
\[P(B|C) = \frac{P(B \cap C)}{P(C)} = \frac{P(B \cap C)}{P(C)} = \frac{\frac{3}{8}}{\frac{4}{8}} = \frac{3}{4}\]
con \(P(B) = \frac{1}{2}\) e \(P(C) = \frac{4}{8}\)
</p>

<p>
Due eventi \(A, B \in \mathcal{P}(\Omega)\) sono detti <i>stocasticamente indipendenti</i> se vale la seguente condizione: \(P(A) = P(A|B)\)
ovvero se vale \(P(B) = P(B|A)\), o ancora se \(P(A \cap B) = P(A)P(B)\).
</p>

<p>
Si continui con l'ultimo esempio: si consideri l'evento \(C\) "il terzo appartamento viene venduto" e l'evento \(D\)
"il secondo appartamento viene venduto". In base alla definizione condizionata risulta
\[ P(C|D) = \frac{P(C \cap D)}{P(D)} = \frac{\frac{2}{8}}{\frac{4}{8}} = \frac{1}{2} = P(C)\]
con \(P(C \cap D) = \frac{2}{8}\) e \(P(D) = \frac{4}{8}\), essendo \(D = \{(0, 1, 0), (1, 1, 0), (0, 1, 1), (1, 1, 1)\}\),
\(C \cap D = \{(0, 1, 1), (1, 1, 1)\}\).
</p>

<p>
Pertanto è possibile concludere come gli eventi \(C\) e \(D\) risultino <i>stocasticamente indipendenti</i>. Infatti
varranno anche le altre relazioni collegate.
</p>

<p>
Osserviamo che l'indipendenza è influenzata non solo dagli eventi considerati ma anche dalla particolare misura di
probabilità \(P\) adottata. Infatti, scelte differenti per \(P\), legate a considerazioni non matematiche, avrebbero
potuto portare ad esempio ad avere gli eventi \(C\) e \(D\) non stocasticamente indipendenti.
</p>

<p>
Si riprenda in esame l'urna con 4 palline fisicamente identiche ma di diverso colore, una rossa, due blu e una verde,
(pertanto faremo riferimento alla probabilità \(P'\) e non a \(P\)).
</p>

<p>
Supponiamo di estrarre in maniera casuale una pallina, e di fare poi una seconda estrazione tenendo fuori dall'urna
la pallina appena estratta (senza reimmissione). Si voglia calcolare la probabilità che le 2 palline estratte in questo
modo siano quelle blu.
</p>

<p>
Consideriamo gli eventi \(A_1\): "la pallina è blu" e \(A_2\): "la seconda pallina è blu" e calcoliamo la probabilità di
\(A_1 \cap A_2\) facendo uso della seguente formula: \(P'(A_1 \cap A_2) = P'(A_2|A_1) P'(A_1)\). A tal scopo si osservi che
\(P'(A_1) = \frac{1}{2}\) e \(P'(A_2|A_1) = \frac{1}{3}\). In definitiva avremo \(P'(A_1 \cap A_2) = P'(A_2|A_1) P'(A_1) = \frac{1}{2}
\frac{1}{3} = \frac{1}{6}\).
</p>

<p>
Nello stesso caso, ma <i>con reimmissione</i> della pallina pescata: \(P'(A_1 \cap A_2) = P'(A_1) P'(A_1) = \frac{1}{2}
\frac{1}{2} = \frac{1}{4}\).
</p>

<p>
La formula \(P (A \cap B) = P(A|B) P(B)\) può essere generalizzata al caso dell'intersezione di più eventi, in tal caso
prende il nome di "formula del prodotto" e diviene \(P(A_1 \cap \dots \cap A_n) = P(A_1) P(A_2|A_1) \dots P(A_n|A_1 \cap \dots \cap A_{n-1})\) ed è
valida comunque sia scelto \(n \in \mathbb{N}_+\) e la famiglia \(\{A_i, i = 1, \dots, n\}\) di sottoinsiemi di \(\Omega\).
</p>

<p>
Torniamo all'urna e supponiamo di effettuare 3 estrazioni, senza reimmissione. Si vuole calcolare la probabilità che
la prima volta venga estratta una pallina blu, la seconda una rossa e la terza una verde e denotiamo questi eventi
rispettivamente con \(A_1, A_2\) e \(A_3\): \(P(A_1 \cap A_2 \cap A_3) = P(A_1) P(A_2|A_1)P(A_3|A_1 \cap A_2)\). \(P(A_1) = \frac{1}{2}\),
\(P(A_2|A_1) = \frac{1}{3}\) e \(P(A_3|A_1 \cap A_2) = \frac{1}{2}\). Quindi \(P(A_1 \cap A_2 \cap A_3) = \frac{1}{2} \frac{1}{3}
\frac{1}{2} = \frac{1}{12}\).
</p>

<p>
È utile ricordare altre formule particolarmente importanti nel calcolo delle probabilità. Consideriamo una partizione
\(\{A_i, i = 1, \dots, n; A_i \subseteq \Omega\}\) dello spazio campione \(\Omega\) ovvero una famiglia di eventi <i>mutualmente incompatibili</i>
e tali che la loro unione sia \(\Omega\) stesso. La prima formula è nota come "formula delle probabilità totali":
\[P(B) = \sum_{i=1}^n P(B|A_i) P(A_i)\]
</p>

<p>
Caso particolare: \(A\) e \(B\) siano eventi. \(A = (A \cap B) \cup (A \cap \bar{B})\). \((A \cap B)\) e \((A \cap \bar{B})\) sono esclusivi,
quindi:
\[ P(A) = P(A \cap B) + P(A \cap \bar{B}) = P(A|B) P(B) + P(A|\bar{B}) P(\bar{B}) = P(A|B) P(B) + P(A|\bar{B})[1 - P(B)]\]
Permette di calcolare la probabilità di un evento condizionando al fatto che un secondo evento si sia o meno verificato.
</p>

<p>
Per esempio, un'assicurazione decide di dividere i guidatori in 2 categorie: facili agli incidenti (\(A\)) e non facili
(\(\bar{A}\)). Le statistiche dicono che un guidatore facile agli incidenti ha probabilità 0.4 di fare un incidente
nell'anno mentre uno non facile agli incidenti ha probabilità 0.2 di fare un incidente nell'anno.
</p>

<p>
Supponiamo che il 30% dei guidatori sia facile agli incidenti, qual'è la probabilità che un guidatore abbia un incidente
nell'anno?
</p>

<p>
Sia \(A_1\) l'evento "il guidatore ha un incidente": \(P(A_1) = P(A_1|A) P(A) + P(A_1|\bar{A}) P(\bar{A}) = 0.4 \cdot 0.3 + 0.2 \cdot 0.7
= .26\)
</p>

<p>
Se un cliente ha effettivamente un incidente nell'anno, qual'è la probabilità che sia facile agli incidenti?
</p>

<p>
Si sa che inizialmente la stima della probabilità che fosse facile agli incidenti era 0.3. Sapendo che ha avuto un incidente,
rivalutiamo questa probabilità con la nuova informazione:
</p>

<p>
Dalle formule viste:
\[P(A|A_1) = \frac{P(A, A_1)}{P(A_1)} = \frac{P(A) P(A_1|A)}{P(A_1)} = \frac{(.3)(.4)}{(.26)} = .4615\]
</p>

<p>
Esempio: un laboratorio di analisi del sangue è in grado di scoprire con probabilità 0.99 se una certa malattia è presente.
C'è però una probabilità di 0.01 di falso positivo (cioè anche se la persona è sana il test la valuta come malata).
</p>

<p>
Se la percentuale di popolazione malata è 0.5% qual'è la probabilità che una persona sia effettivamente malata se viene
valutata come malata dal test?
</p>

<p>
Sia \(D\) l'evento: una persona è malata; \(E\) l'evento: il test è positivo (persona valutata come malata). Si deve
calcolare:
\[P(D|E) = \frac{P(D, E)}{P(E)} = \frac{P(E|D) P(D)}{P(E|\bar{D}) P(\bar{D}) + P(E|D) P(D)} =
\frac{(.99)(.005)}{(.01)(.995) + (.99)(.005)} = .3322\]
</p>

<p>
È un caso particolare della seconda formula molto importante: la <i>formula di Bayes</i>.
</p>

<p>
La "formula di Bayes" nella forma generale per eventi \(B\) tali che \(P(B) > 0\) è data da
\[ P(A_i|B) = \frac{P(B|A_i) P(A_i)}{\sum_{j=1}^n P(B|A_j) P(A_j)}\]
ed è valida per ogni \(i = 1, \dots, n\).
</p>

<p>
Si osservi che anche in questo caso è necessario richiedere che la famiglia \(\{A_i, i = 1, \dots, n; A_i \subseteq \Omega\}\)
sia una partizione dello spazio campione \(\Omega\).
</p>

<p>
Esempio: supponiamo di aver effettuato un'indagine sugli individui in età lavorativa abitanti in un quartiere di una
data città italiana, e di aver riscontrato che il 40% di tal individui ha la licenza elementare o media, il 50% ha
un titolo di scuola superiore mentre il restante 10% è laureato.
</p>

<p>
Una seconda indagine ha permesso di rilevare i tassi di disoccupazione tra i tre gruppi di individui che risultano
essere rispettivamente 15%, 5% e 10%.
</p>

<p>
Supponiamo ora di assegnare un numero ad onguno di tali individui e di estrarre uno dei numeri così assegnati,
selezionando quindi in modo del tutto casuale un singolo individuo tra tutti. Si vuole determinare la
probabilità dell'evento \(B\) "l'individuo che verrà estratto è disoccupato".
</p>

<p>
Il metodo migliore per calcolare tale probabilità consiste nel far ricorso alla formula delle probabilità totali,
denotando: \(A_1\) "l'indiviudo ha la licenza elementare o media", \(A_2\) "l'individuo ha un titolo di scuola superiore",
\(A_3\) "l'individuo ha la laurea". Sfruttando l'informazione disponibile assegneremo le seguenti probabilità:
\(P(A_1) = 0.4, P(A_2) = 0.5, P(A_3) = 0.1\).
</p>

<p>
Inoltre, sempre in base ai risultati delle indagini avremo \(P(B|A_1) = 0.15, P(B|A_2) = 0.05, P(B|A_3) = 0.1\).
Osservando che la terna \(A_1, A_2\) ed \(A_3\) costituisce una partizione dello spazio campione si può applicare la
formula delle probabilità totali ottenendo: \(P(B) = \sum_{i=1}^3 P(B|A_i) P(A_i) = 0.4 \cdot 0.15 + 0.5 \cdot 0.05 + 0.1 \cdot 0.1 = 0.095\).
</p>

<p>
Supponiamo ora di essere certi che l'individuo estratto sia un disoccupato, e di essere interessati a determinare
la probabilità, condizionata a tale informazione, che esso sia laureato.
</p>

<p>
Allora è possibile far uso della Formula di Bayes, in base alla quale si ricava:
\[ P(A_3|B) = \frac{P(B|A_3) P(A_3)}{\sum_{j=1}^3 P(B|A_j) P(A_j)} = \frac{0.1 \cdot 0.1}{0.095} = 0.105\]
</p>

<p>
Delle opportune trasformazioni, chiamate "variabili aleatorie", consentono di ricondursi sempre ad \(\mathbb{R}\) come spazio
campione e di considerare quali suoi sottoinsiemi tutti gli intervalli del tipo (a, b) o [a, b] con \(-\infty \leq a < b \leq +\infty\),
tutte le possibili unioni ed intersezioni (finite o infinite), e tutti i loro complementi. Formalmente:
dato  uno spazio campione \(\Omega\), è detta "variabile aleatoria" (o casuale) un'applicazione \(X: \Omega \to \mathbb{R}\) che associa un
numero reale ad ogni elemento di \(\Omega\).
</p>

<p>
In base a questa definizione è possibile assegnare delle probabilità ad eventi del tipo \(X \in B \subseteq \mathbb{R}\) essendo
\(P(\{X \in B\}) = P(\{\omega \in \Omega | X(\omega) \in B\})\) dove \(P\) rappresenta una misura di probabilità definita su \(\mathcal(P)(\Omega)\).
Per comodità denoteremo da qui in avanti con \(P(X \in B)\) tali probabilità, ma ci si ricordi sempre che \(X \in B\) va pensato
come evento di \(\Omega\).
</p>

<p>
Facciamo riferimento all'esempio degli appartamenti e consideriamo lo spazio \(\Omega\) e la probabilità \(P\) in esso definiti.
Una variabile aleatoria che ha senso considerare in questo caso potrebbe essere la \(X :=\) "numero di appartamenti venduti
a fine anno". Formalmente essa andrebbe definita come funziona da \(\Omega\) in \(\mathbb{R}\) che assegna:
</p>
<ul class="org-ul">
<li>\(X((0, 0, 0)) = 0\)</li>
<li>\(X((0, 0, 1)) = X((0, 1, 0)) = X((1, 0, 0)) = 1\)</li>
<li>\(X((0, 1, 1)) = X((1, 1, 0)) = X((1, 0, 1)) = 2\)</li>
<li>\(X((1, 1, 1)) = 3\)</li>
</ul>

<p>
In base alla definizione della variabile casuale \(X\) che abbiamo fornito, ha senso definire la probabilità che
esattamente un appartamento venga venduto \(X\) = 1. Infatti, vale quanto segue:
\[ P(X=1) = P(\omega \in \Omega : X(\omega) = 1) = P(\{(0, 0, 1), (0, 1, 0), (1, 0, 0)\}) = \frac{3}{8}\]
</p>

<p>
La definizione di variabile aleatoria può risultare poco chiara dal punto di vista intuitivo anche se per gli scopi
del corso sarà necessario pensare alle variabili aleatorie come ad esiti esprimibili numericamente di esperimenti
ancora da effettuare, dove per esperimento intenderemo un qualsiasi fenomeno o situazione con sviluppi imprevedibili
a priori.
</p>

<p>
Come notazione adotteremo quella solitamente utilizzata in campo statistico, indicando con lettere maiuscole le
variabili aleatorie e con lettere minuscole le rispettive possibili realizzazioni.
</p>

<p>
Essendo imprevedibile a priori il valore assunto da una variabile aleatoria, tutto ciò che si può fare relativamente ad
essa è esprimere delle valutazioni di tipo probabilistico sui valori che essa assumerà. Per tale ragione ad ogni variabile
aleatoria \(X\) è associata una funzione che esprime in modo chiaro tali valutazioni. Essa è la <i>funzione di ripartizione</i>:
\[F_X : \mathbb{R} \to [0, 1] \subseteq \mathbb{R}\]
definita come \(F_X(t) = P(X \leq t)\) per ogni valore di \(t \in \mathbb{R}\).
Riconsideriamo la variabile aleatoria definita nell'esempio precedente, e determiniamone la corrispondente funzione di
ripartizione. Per questo osserviamo prima di tutto che la \(X\) può assumere solo i valori 0, 1, 2 e 3.
Quindi sicuramente sarà \(F_X(t) = P(X \leq t) = 0\) per \(t < 0\). Avremo poi
</p>
\begin{align*}
&F_X(t) = P(X = 0) = P(\{0, 0, 0\}) = \frac{1}{8} \text{ per } t <0\\
&F_X(t) = P(X = 0 \text{ oppure } 1) = P(\{(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 0, 1)\}) = \frac{1}{2} \text{ per } 1 \leq t \leq 2\\
&F_X(t) = P(X = 0 \text{ oppure } 1 \text{ oppure } 2) = 1 - P(X = 3) = 1 - P(\{(1, 1, 1)\}) = 1 - \frac{1}{8} = \frac{7}{8} \text{ per } 2 \leq t < 3\\
&F_X(t) = P(X = 0 \text{  oppure  } 1 \text{ oppure } 2 \text{ oppure } 3) = P(\Omega) = 1 \text{ per } t \geq 3
\end{align*}

<p>
La funzione di ripartizione risulta essere descritta dal grafico nella figura sottostante:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_10-05-12.png" alt="screenshot_2018-03-14_10-05-12.png" />
</p>
</div>

<p>
Una volta nota la funzione di ripartizione di una variabile aleatoria, è possibile determinare la probabilità che
essa assuma valori in intervalli dell'asse reale di nostro interesse osservando che vale:
\[ P(X \in (a, b]) = F_X (b) - F_X (a) \text{ per ogni $a, b, \in \mathbb{R}$ con } a < b\]
</p>

<p>
La dimostrazione di questa uguaglianza segue dal fatto che, per ogni \(a < b\), gli eventi \(X \in (-\infty, a]\) ed \(X \in (a, b]\)
sono incompatibili e che dalla seguente proprietà:
</p>
<ul class="org-ul">
<li>Data la famiglia \(\{A_i, i \in I \subseteq N\}\) di eventi incompatibili vale \(P\left(\bigcup_{i \in I} A_i \right) = \sum_{i \in I} P(A_i)\)
risulta \(P(\{X \in (-\infty, a]\} \cup \{X \in (a, b]\}) = P(X \in (-\infty, a]) + P(X \in (a, b])\).</li>
</ul>
<p>
Vale allora anche la seguente relazione:
\[F_X (b) = P(X \leq b) = P(\{X \in (-\infty, a]\} \cup \{X \in (a, b]\}) = P(X \in (-\infty, a]) + P(X \in (a, b]) = F_X (a) + P(X \in (a, b])\]
da cui si ricava appunto la seguente: \(P(X \in (a, b]) = F_X(b) - F_X(a)\) per ogni \(a, b \in \mathbb{R}\) con \(a < b\).
</p>

<p>
Per esempio, si voglia determinare la probabilità che la variabile aleatoria introdotta negli esempi precedenti assuma
valori in [1, 2]. Si osservi innanzitutto che in base alla seguente relazione:
</p>
<ul class="org-ul">
<li>Per ogni \(A, B \subseteq \Omega\) anche non incompatibili, vale \(P(A \cup B) = P(A) + P(B) - P(A \cap B)\) vale nel caso specifico
la seguente relazione \(P(X \in [1, 2]) = P(X = 1) + P(X \in (1, 2])\) essendo \(X=1\) ed \(X \in (1, 2]\) eventi incompatibili.</li>
</ul>

<p>
Da cui segue che \(P(X \in [1, 2]) = P(X = 1) + P(X \in (1, 2]) = \frac{3}{8} + [F_X(2) - F_X(1)] = \frac{3}{8} + \left[
\frac{7}{8} - \frac{1}{2} \right] = \frac{3}{4}\):
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_11-40-34.png" alt="screenshot_2018-03-14_11-40-34.png" />
</p>
</div>

<p>
Notiamo però che in genere la funzione di ripartizione di una variabile aleatoria non è nota; obiettivo della
statistica è quello di determinarla o di determinare grandezze ad essa associate, mentre nella probabilità e
nelle sue applicazioni si assume che essa sia nota.
</p>

<p>
È possibile dimostrare che sono delle funzioni di ripartizione tutte e sole le funzioni \(F: \mathbb{R} \to [0, 1]\) che
godono simultaneamente delle seguenti proprietà:
</p>
<ul class="org-ul">
<li>\(F\) è monotona non decrescente;</li>
<li>\(\lim_{t \to +\infty} F(t) = 1\);</li>
<li>\(\lim_{t \to -\infty} F(t) = 0\);</li>
<li>\(\lim_{t \to t_0^+} F(t) = F(t_0)\) per ogni \(t_0 \in \mathbb{R}\).</li>
</ul>

<p>
Per esempio, immaginiamo di essere interessati ad effettuare delle valutazioni sul tasso di inflazione \(X\) che vi sarà
alla fine dell'anno. Poiché al momento attuale non è noto il valore che assumerà \(X\), possiamo pensare ad esso come
ad una variabile aleatoria. Un economista contattato, in proposito afferma, in base alle sue considerazioni, che
\(X\) è una variabile avente <i>funzione di ripartizione</i> definita come segue:
</p>
\begin{equation*}
F_X (t) =
\begin{cases}
0 \quad &\text{per $t < 0$}\\
1-e^{-t} \quad &\text{per $t \geq 0$}
\end{cases}
\end{equation*}
<p>
Il grafico dell'andamento di tale funzione è riportato nella figura sottostante:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_12-08-28.png" alt="screenshot_2018-03-14_12-08-28.png" />
</p>
</div>

<p>
È facile verificare che la funzione \(F_X(t)\) così soddisfa le condizioni richieste, e pertanto risulta effettivamente una
funzione di ripartizione.
</p>

<p>
Supponiamo di essere ora interessati a determinare la probabilità che tale tasso sia compreso nell'intervallo \((1, 2]\), a
tal scopo sarà sufficiente applicare la seguente formula: \(P(X \in (a, b]) = F_X(b) - F_X(a)\) per ogni \(a, b \in \mathbb{R}\) con \(a < b\),
che nel caso in questione diviene \(P(X \in (1, 2])\) = F<sub>X</sub>(2) - F<sub>X</sub>(1) e dalla cui applicazione si ricava
\[P(X \in (1, 2]) = F_X(2) - F_X(1) = (1 - e^{-2}) - (1-e^{-1}) = 0.865 - 0.632 = 0.233\]
</p>

<p>
Si osservi che la relazione \(P(X \in (a, b]) = F_X(b) - F_X(a)\) per ogni \(a, b \in \mathbb{R}\) con \(a < b\) può essere utilizzata
anche se desideriamo calcolare la probabilità che il tasso sia strettamente maggiore di 2, infatti averemo quanto segue:
\[P(X \in (2, +\infty]) = \lim_{t \to +\infty} F_X(t) - F_X(2) = 1 - (1 - e^{-2}) = 0.135\]
Si può inoltre osservare che le funzioni di ripartizione considerate negli ultimi 2 esempi, sebbene entrambe soddisfino
tutte le proprietà, presentano una significativa differenza:
</p>
<ul class="org-ul">
<li>La prima non è una funzione continua su \(\mathbb{R}\);</li>
<li>La seconda è una funzione continua su \(\mathbb{R}\).</li>
</ul>

<p>
In effetti le variabili aleatorie si distinguono in due categorie in base alla proprietà di continuità delle corrispondenti
funzioni di ripartizione:
</p>
<ul class="org-ul">
<li><p>
Variabile aleatoria <i>discreta</i>: l'insieme dei valori \(S\) che essa può assumere (supporto) è finito o costituito da
un'infinità di valori discreti. Ad ogni variabile aleatoria discreta è associabile, oltre alla funzione di ripartizione,
una seconda funzione che fornisce delle valutazioni sulle probabilità che essa assuma specifici valori.
</p>

<p>
Sia \(S\) il supporto della variabile aleatoria discreta \(X\). Viene detta <i>distribuzione discreta di probabilità</i> la funzione
\(p_x : \mathbb{R} \to [0, 1]\) definita come segue:
</p>
\begin{equation*}
p_x(t) =
\begin{cases}
P(X=t) \quad &\text{per ogni $t \in S$}\\
0 \quad &\text{altrimenti}
\end{cases}
\end{equation*}
<p>
Come per le funzioni di ripartizione, esistono alcune proprietà che identificano le distribuzioni discrete di probabilità.
Infatti, una funzione \(p_x\) definita su un insieme finito \(S\) è una distribuzione di probabilità se e solo se sono
soddisfatte simultaneamente le seguenti proprietà:
</p>
<ul class="org-ul">
<li>\(p_x (t) \geq 0, t \in \mathbb{R}\);</li>
<li>\(\sum_{s \in S} p_x(s) = 1\).</li>
</ul>
<p>
Si osservi che la seconda delle due proprietà è conseguenza diretta delle due seguenti proprietà precedentemente introdotte:
</p>
<ul class="org-ul">
<li>\(P(\Omega) = 1\);</li>
<li>Data la famiglia \(\{A_i, i \in I \subseteq N\}\) di eventi incompatibili vale \(P\left(\bigcup_{i \in I} A_i \right) = \sum_{p \in I} P(A_i)\).</li>
</ul>
<p>
Tra le funzioni di ripartizione delle variabili discrete e le distribuzioni discrete di probabilità esiste una corrispondeza
biunivoca. Infatti, valgono le seguenti relazioni:
</p>
<ul class="org-ul">
<li>\(F_X(t) = \sum_{s \in S : s \leq t} p_x(s)\) per ogni \(t \in \mathbb{R}\);</li>
<li>\(p_X(s) = F_X(s) - \lim_{t \to s^-} F_X(t)\) per ogni \(s \in S\).</li>
</ul>
<p>
Dalla prima di tali relazioni se ne deduce che le funzioni di ripartizione delle variabili aleatorie discrete presentano dei
"salti" in corrispondenza dei valori \(s\), mentre sono costanti per gli altri valori: per tale ragione vengono dette
<i>funzioni a gradino</i>.
</p>

<p>
Per esempio si consideri la variabile aleatoria definita negli esempi relativi agli appartamenti. Essa è discreta in
quanto può assumere i seguenti valori \(S = \{0, 1, 2, 3\}\). La sua distribuzione discreta di probabilità può essere
definita facendo uso o della seguente relazione:
\[ p_X(s) = F_X(s) - \lim_{t \to s^-} F_X(t) \quad \text{per ogni } s \in S\]
considerando la funzione di ripartizione calcolata precedentemente, oppure direttamente andando a calcolare la
probabilità che \(X\) assuma i singoli valori in \(S\) facendo uso della seguente relazione:
</p>
\begin{equation*}
p_x(t) =
\begin{cases}
P(X=t) \quad &\text{per ogni $t \in S$}\\
0 \quad &\text{altrimenti}
\end{cases}
\end{equation*}</li>
</ul>

<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_12-41-38.png" alt="screenshot_2018-03-14_12-41-38.png" />
</p>
</div>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_12-43-10.png" alt="screenshot_2018-03-14_12-43-10.png" />
</p>
</div>
<ul class="org-ul">
<li><p>
Variabile aleatoria <i>continua</i>: la corrispondente funzione \(F_X\) è continua. In particolare, è detta
<i>assolutamente continua</i> se esiste una funzione \(f_X : \mathbb{R} \to \mathbb{R}_+\) tale che
\(F_X(t) = \int_{-\infty}^t f_X(u)du\) per ogni \(t \in \mathbb{R}\). Una tale funzione, quando esiste, viene detta <i>densità di
probabilità</i> di \(X\). È detto poi <i>supporto</i> della variabile \(X\) l'insieme \(S = \{t \in \mathbb{R} : f_X(t) \neq 0\}\).
Si osservi che se la densità di probabilità di una variabile casuale esiste allora la funzione di ripartizione
è una sua primitiva.
</p>

<p>
Per semplicità supporremo nel seguito che le variabili aleatorie assolutamente continue abbiano funzione di
ripartizione derivabile e che la funzione di densità di probabilità sia la derivata della funzione di ripartizione.
</p>

<p>
Come per le distribuzioni discrete di probabilità anche le funzioni di densità di probabilità per essere tali
devono soddisfare le seguenti due proprietà:
</p>
<ul class="org-ul">
<li>\(f_X(t) \geq 0\) per ogni \(t \in \mathbb{R}\);</li>
<li>\(\int_{-\infty}^{+\infty} f_X(t)dt = 1\)</li>
</ul>

<p>
La probabilità che una variabile aleatoria continua (o assolutamente continua) assuma un ben determinato valore è
sempre nulla. Infatti, se \(X\) è una variabile aleatoria continua allora per ogni \(t_0 \in \mathbb{R}\) vale:
\[P(X = t_0) = P(X \leq t_0) - \lim_{t \to t_0^-} P(X \leq t) = F_X(t_0) - \lim_{t \to t_0^-} F_X(t) = F_X(t_0) - F_X(t_0) = 0\]
Pertanto quando si pensa a variabili aleatorie continue, non ha mai senso domandarsi, quale sia la probabilità
che assumano valori esatti. Al contrario ha senso domandarsi quale sia la probabilità che tali variabili
assumano valori in specifici intervalli dell'asse reale.
</p>

<p>
Per calcolare la probabilità che una variabile casuale continua \(X\) assuma un valore in un intervallo \((a, b] \subseteq \mathbb{R}\)
è possibile far ricorso alla seguente formula: \(P(X \in (a, b]) = F_X(b) - F_X(a)\) per ogni \(a, b \in \mathbb{R}\) con \(a < b\), oppure
alla seguente formula: \(P(X \in (a, b]) = \int_a^b f_X(u)du\) per ogni \(a, b \in \mathbb{R}\) con \(a < b\). La quale è ricavabile dalla
precedente combinata con la seguente \(F_X(t) = \int_{-\infty}^t f_X(u)du\) per ogni \(t \in \mathbb{R}\).
</p>

<p>
È utile segnalare che \(P(X \in (a, b]) = F_X(b) - F_X(a) = \int_{-\infty}^b f_x(u)du - \int_{-\infty}^a f_x(u)du = \int_a^b f_x(u)du\).
</p>

<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_14-40-36.png" alt="screenshot_2018-03-14_14-40-36.png" />
</p>
</div>

<p>
Essendo \(P(X=a) = 0\) risulta sempre \(P(X \in [a, b]) = P(X \in (a, b])\) per ogni \(a, b \in \mathbb{R}\) con \(a < b\).
</p></li>
</ul>

<p>
Si consideri la variabile aleatoria \(X\) introdotta nell'esempio precedente. Essa è continua in quanto la sua funzione
di densità di probabilità, ottenuta derivando la ripartizione, è data da:
</p>
\begin{equation*}
f_X(t) =
\begin{cases}
0 \quad &\text{per $t < 0$}\\
e^{-t} \quad &\text{per $t \geq 0$}
\end{cases}
\end{equation*}
<p>
In realtà è possibile osservare che la funzione di ripartizione non è derivabile in 0 e pertanto la scelta di porre la sua
derivata pari a \(f_X(0) = e^{-0} = 1\) in quel punto è arbitraria, anche se non influenza in alcun modo le valutazioni sulla
variabile considerata \(X\).
</p>

<p>
Calcoliamo la probabilità che \(X\) assuma valori in \([1, 2]\) facendo ricorso ala formula
\(P(X \in (a, b]) = \int_a^b f_X(u)du\) per ogni \(a, b\), con \(a < b\), ottenendo
\[P(X \in [1, 2]) = P(X = 1) + \int_1^2 f_X(u)du = 0 + \int_1^2 e^{-u} du = 0 - e^{-2} + e^{-1} = 0.233\]
</p>

<p>
La funzione di ripartizione è la funzione integrale della funzione di densità di probabilità. Quindi, data la funzione
di partizione, si ottiene la funzione di densità di probabilità tramite derivazione \(\frac{d}{dt} F_X(t) = f_X(t)\).
</p>

<p>
In molti casi è lecito considerare situazioni (esperimenti) il cui esito è rappresentato, anziché da un valore numerico,
da una coppia o da una \(n\)-pla di valori; si pensi ad esempio alla coppia costi-ricavi in un investimento immobiliare.
Si parla allora di <i>variabili aleatorie multidimensionali</i>.
</p>

<p>
In modo analogo a quanto visto per le variabili unidimensionali, le variabili di tal tipo sono definite come applicazioni
da uno spazio campione \(\Omega\) allo spazio \(\mathbb{R}^n\) dove \(n\) è la dimensione della variabile. Come per le variabili aleatorie
unidimensionali, conviene pensare a queste variabili aleatorie come a risultati di esperimenti esprimibili tramite
\(n\)-ple di valori numerici. Anche in questo caso è consuetudine considerare funzioni che esprimano le valutazioni
probabilistiche sui valori assumibili delle variabili.
</p>

<p>
Per il momento definiremo tali funzioni limitandoci a considerare <i>variabili aleatorie bidimensionali assolutamente
continue</i> anche se quanto descritto in seguito può essere facilmente esteso al caso di più dimensioni e non
necessariamente continuo.
</p>

<p>
Sia quindi \((X;Y): \Omega \to \mathbb{R}^2\) una variabile aleatoria bidimensionale dove \(\Omega\) è uno spazio campione al quale è associata
una probabilità \(P\) definita sui sottoinsiemi di \(\Omega\).
</p>

<p>
È detta <i>funzione di ripartizione congiunta</i> la funzione bidimensionale \(F_{X, Y} (t, s) : \mathbb{R}^2 \to [0, 1] \subseteq \mathbb{R}\)
definita come \(F_{X, Y}(t, s) = P(\{X \leq t\} \cap \{Y \leq s\})\) per ogni \((t, s) \in \mathbb{R}^2\).
</p>

<p>
Se, come qui assunto, la variabile \((X;Y)\) è assolutamente continua, allora esiste la <i>funzione di densità congiunta</i>
\(F_{X, Y} : \mathbb{R}^2 \to \mathbb{R}_+\) tale che
\(F_{X, Y}(t, s) = \int_{-\infty}^t \int_{-\infty}^s f_{X, Y} (u, v)du dv\) per ogni \((t, s) \in \mathbb{R}^2\).
</p>

<p>
Conoscendo la funzione di ripartizione congiunta o quella di densità congiunta è possibile determinare la probabilità
che la coppia \((X;Y)\) assuma valori in un qualsiasi sottoinsieme rettangolare \((a_1, b_1] \times (a_2, b_2] \in \mathbb{R}^2\).
</p>

<p>
Infatti, valgono le seguenti formule:
</p>
<ul class="org-ul">
<li>\(P((X, Y) \in (a_1, b_1] \times (a_2, b_2]) = F_{X, Y}(b_1, b_2) - F_{X, Y}(a_1, b_2) - F_{X, Y}(b_1, a_2) + F_{X, Y}(a_1, a_2)\)</li>
<li>\(P((X, Y) \in (a_1, b_1] \times (a_2, b_2]) = \int_{a_1}^{b_1} \int_{a_2}^{b_2} f_{X, Y} (u, v) du dv\)</li>
</ul>
<p>
per ogni \((a_1, b_1] \times (a_2, b_2] \in \mathbb{R}^2\).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_15-11-47.png" alt="screenshot_2018-03-14_15-11-47.png" />
</p>
</div>

<p>
In molti casi, benché ci si trovi di fronte a situazioni i cui esiti sono di tipo multidimensionali, capita di essere
interessati ai valori che possono essere assunti solamente da una delle variabili (si è interessati a valutare probabilità
associate a solo uno dei valori numerici che descrivono l'esito dell'esperimento). Per questo motivo sono state introdotto
le <i>funzioni marginali</i>. Anche per la loro descrizione ci limitiamo al caso bidimensionale. Data una variabile aleatoria
bidimensionale \((X;Y)\) assolutamente continua, avente funzione di ripartizione congiunta \(F_{X, Y}\) e funzione di densità
congiunta \(f_{X, Y}\) sono dette <i>funzione di ripartizione marginale di \(X\)</i> e <i>funzione di densità marginale di \(X\)</i>:
\[F_X(t) = P(X \leq t) = P(\{X \leq t\} \cap \{Y \leq +\infty\}) = F_{X, Y}(t, +\infty)\]
\[f_X(t) = \int_{-\infty}^{+\infty} f_{X, Y}(t, s)ds\]
</p>

<p>
Concludiamo questa parte introducendo la nozione di indipendenza tra variabili aleatorie. Data una variabile aleatoria
bidimensionale (\(X;Y\)) diciamo che due variabili \(X\) ed \(Y\) considerate singolarmente sono <i>stocasticamente
indipendenti</i> se e solo se per ogni \((t, s) \in \mathbb{R}^2\) vale \(F_{X, Y}(t, s) = F_X(t) \cdot F_Y(s)\). È possibile verificare
che tale condizione è equivalente alla seguente: \(P(\{X \in A\} \cap \{Y \in B\}) = P(X \in A) \cdot P(Y \in B)\) per ogni \(A, B \subseteq \mathbb{R}\)
e che questa è a sua volta equivalente alla seguente \(f_{X, Y}(t, s) = f_X(t) \cdot f_Y(s)\) per ogni coppia \((t, s) \in \mathbb{R}^2\)
quando la coppia di variabili \((X, Y)\) sia assolutamente continua.
</p>

<p>
Nell'esempio che segue esaminiamo una variabile aleatoria bidimensionale discreta.
</p>

<p>
Supponiamo di dover lanciare un dato equilibrato e di essere interessati agli eventi \(A\) "esce un numero pari" e \(B\)
"esce un numero minore o uguale a 4". Al fine di esplicitare il fatto che questi eventi si verifichino lanciando il dado,
consideriamo la coppia di variabili \((X, Y)\) dove:
</p>
\begin{equation*}
X :=
\begin{cases}
1 \quad &\text{se l'evento $A$ si verifica}\\
0 \quad &\text{se l'evento $A$ non si verifica}
\end{cases}
\end{equation*}
\begin{equation*}
Y :=
\begin{cases}
1 \quad &\text{se l'evento $B$ si verifica}\\
0 \quad &\text{se l'evento $B$ non si verifica}
\end{cases}
\end{equation*}
<p>
Poiché le due variabili dipendono dallo stesso esperimento è logico studiarle congiuntamente. Come prima cosa potremmo
determinarne la funzione di ripartizione congiunta.
</p>

<p>
In realtà però quando si abbia a che fare con variabili multidimensionali discrete si preferesce considerare la
distribuzione di probabilità congiunta definita come \(P_{X, Y}(t, s) = P(\{X = t\} \cap \{Y = s\})\) dove \((t, s)\) è una
coppia di valori assumibili da \((X, Y)\).
Osserviamo ora che al variare del risultato del lancio del dado la coppia \((X, Y)\) assume i seguenti valori
</p>
\begin{equation*}
(X, Y) =
\begin{cases}
(0, 0) \quad &\text{se esito 5}\\
(0, 1) \quad &\text{se esito 1 oppure 3}\\
(1, 0) \quad &\text{se esito 6}\\
(1, 1) \quad &\text{se esito 2 oppure 4}
\end{cases}
\end{equation*}
<p>
Supponendo che il dado sia equilibrato sarà lecito attribuire le seguenti probabilità:
</p>
<ul class="org-ul">
<li>\(p_{X, Y}(0, 0) = P(\text{"esito 5"}) = \frac{1}{6}\)</li>
<li>\(p_{X, Y}(0, 1) = P(\text{"esito 1 o 3"}) = \frac{2}{6}\)</li>
<li>\(p_{X, Y}(1, 0) = P(\text{"esito 6"}) = \frac{1}{6}\)</li>
<li>\(p_{X, Y}(1, 1) = P(\text{"esito 2 o 4"}) = \frac{2}{6}\)</li>
</ul>
<p>
Calcoliamo ora le probabilità marginali della coppia \((X, Y)\) ottenendo
</p>
<ul class="org-ul">
<li>\(p_X(0) = P(\{X = 0\} \cap \{Y \text{ qualsiasi}\}) = p_{X, Y}(0, 0) + p_{X, Y}(0, 1) = \frac{1}{2}\)</li>
<li>\(p_X(1) = P(\{X = 1\} \cap \{Y \text{ qualsiasi}\}) = p_{X, Y}(1, 0) + P_{X, Y}(1, 1) = \frac{1}{2}\)</li>
<li>\(p_Y(0) = P(\{X \text{ qualsiasi}\} \cap \{Y = 0\}) = p_{X, Y}(0, 0) + p_{X, Y}(1, 0) = \frac{1}{3}\)</li>
<li>\(p_Y(0) = P(\{X \text{ qualsiasi}\} \cap \{Y = 1\}) = p_{X, Y}(0, 1) + p_{X, Y}(1, 1) = \frac{2}{3}\)</li>
</ul>
<p>
Le due variabili aleatorie \(X\) ed \(Y\) risultano essere stocasticamente indipendenti, infatti risulta:
</p>
<ul class="org-ul">
<li>\(p_{X, Y} (0, 0) = \frac{1}{6} = \frac{1}{2} \cdot \frac{1}{3} = p_X(0) \cdot p_Y(0)\)</li>
<li>\(p_{X, Y}(0, 1) = \frac{2}{6} = \frac{1}{2} \cdot \frac{2}{3} = p_X(0) \cdot p_Y(1)\)</li>
<li>\(p_{X, Y} (1, 0) = \frac{1}{6} = \frac{1}{2} \cdot \frac{1}{3} = p_X(1) \cdot p_Y(0)\)</li>
<li>\(p_{X, Y}(1, 1) = \frac{2}{6} = \frac{1}{2} \cdot \frac{2}{3} = p_X(1) \cdot p_Y(1)\)</li>
</ul>

<p>
Gli indici di tendenza centrare e la variabilità sono grandezze numeriche associate alle variabili aleatorie
in grado di sintetizzare, con un solo valore, le principali caratteristiche delle loro distribuzioni.
Risultano strettamente legati agli indici introdotti nella prima parte in relazione alla statistica descrittiva.
</p>

<p>
Il più importante degli <i>indici di tendenza centrale</i> è il <i>valore atteso</i>, corrispondente alla media matematica
dei dati statistici. Data una variabile aleatoria unidimensionale \(X\) con supporto \(S \subseteq \mathbb{R}\) è detto
<i>valore atteso</i> di \(X\) la quantità
</p>
\begin{equation*}
E[X] =
\begin{cases}
\sum_{s \in S} s \cdot p_X(s) \quad &\text{se $X$ è discreta}\\
\int_{-\infty}^{+\infty} u \cdot f_X(u)du \quad &\text{se $X$ è assolutamente continua}
\end{cases}
\end{equation*}
<p>
Si osservi l'analogia di questa formula con quella della media pesata di una serie di dati statistici.
In effetti il valore atteso, così come la media di una serie di dati, va pensato come una "media pesata" dei
valori assumibili dalla variabile, e fornisce un'indicazione di massima del posizionamento delle variabili
lungo l'asse dei numeri reali.
</p>

<p>
Il valore atteso gode delle seguenti tre proprietà:
</p>
<ol class="org-ol">
<li>Per ogni \(a \in \mathbb{R}\), se \(X=a\) con probabilità uguale ad 1 allora \(E[x] = a\);</li>
<li>\(E[a \cdot X + b] = a \cdot E[x] + b\) per ogni variabile \(X\) e per ogni \(a, b, \in \mathbb{R}\);</li>
<li>Data una funzione \(y = g(X)\) della variabile aleatoria \(X\), il suo valore atteso è \(E[g(X)] = \int_{-\infty}^{+\infty} g(u) f_X(u) du\)</li>
</ol>
<p>
Occorre osservare che il valore atteso di una variabile potrebbe anche non esistere, poiché esso è definito come
integrale improprio.
Questa situazione può verificarsi nel caso in cui l'integrale o la sommatoria non convergano.
</p>

<p>
Il valore atteso è in realtà un caso particolare di momento centrale, per ogni \(r = 1, 2, \dots\) è detto <i>momento centrale
di \(X\) di ordine \(r\)</i> la quantità
</p>
\begin{equation*}
E[X^r] =
\begin{cases}
\sum_{s \in S} s^r \cdot p_X(s) \quad &\text{se $X$ è discreta}\\
\int_{-\infty}^{+\infty} u^r \cdot f_X(u)du \quad &\text{se $X$ è assolutamente continua}
\end{cases}
\end{equation*}
<p>
Un secondo indice di tendenza centrale che occorre descrivere è la moda.
</p>

<p>
Data una variabile aleatoria \(X\) è detta <i>moda</i> una quantitò \(\tilde{X} \in \mathbb{R}\) corrispondente al valore per
cui è massima la distribuzione discreta di probabilità (se \(X\) è discreta) oppure la funzione di densità (se \(X\)
è assolutamente continua).
</p>

<p>
Non è detto che un tale valore sia unico, se lo è diremo che la distribuzione di \(X\) è <i>unimodale</i>, in caso contrario
si parlerà di distribuzione <i>multimodale</i>. Può capitare in alcuni casi che la distribuzione discreta di probabilità o la
funzione di densità presentino diversi punti di massimo locale. Sebbene ciò non sarebbe formalmente corretto, tutti
questi punti di massimo locale vengono solitamente considerati come punti modali e pertanto anche in questo caso si
parla di distribuzione multimodale.
</p>

<p>
Un terzo indice di tendenza centrale è la <i>mediana</i>. Data una variabile aleatoria \(X\) diciamo mediana una quantità
\(\hat{X} \in \mathbb{R}\) che soddisfa la diseguaglianza \(\lim_{t \to \hat{X}^-} F_X(t) \leq \frac{1}{2} \leq F_X (\hat{X})\).
</p>

<p>
Nel caso in cui la funzione di ripartizione della variabile sia continua ed invertibile allora \(\hat{X} = F_X^{-1}(0.5)\).
</p>

<p>
Nel caso di variabili discrete invece la mediana è il valore dell'ascissa in cui la funzione di ripartizione passa
da un valore minore di 0.5 ad uno superiore.
</p>

<p>
Più semplicemente è possibile pensare alla mediana come a quel valore
per cui sia la probabilità che \(X\) assuma valori più piccoli che la probabilità che \(X\) assuma valori più grandi
sono pari a 0.5.
</p>

<p>
La mediana può non essere unica e ciò si verifica quando esistano più valori \(t\) per i quali risulti \(F_X(t) = \frac{1}{2}\).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_16-28-48.png" alt="screenshot_2018-03-14_16-28-48.png" />
</p>
</div>

<p>
Unitamente alla mediana è possibile considerare altri indici definiti in maniera simile e che dividono la retta
dei reali in due intervalli di probabilità assegnata e che sono detti "quantili". Dato un valore
\(p \in [0, 1] \subseteq \mathbb{R}\) è detto <i>quantile \(p\)-esimo della variabile aleatoria \(X\)</i> il valore
\(x_p \in \mathbb{R} : \lim_{t \to x_p^-}F_X(t) \leq p \leq F_X(x_p)\). Nel caso in cui la funzione di ripartizione sia continua ed
invertibile allora \(x_p = F_X^{-1}(p)\).
</p>

<p>
Pertanto è possibile pensare ad \(x_p\) come a quel valore per cui risulta \(P(X \leq x_p) = p\) e \(P(X > x_p) = 1 - p\).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_17-22-18.png" alt="screenshot_2018-03-14_17-22-18.png" />
</p>
</div>

<p>
Supponiamo di avere a disposizione 2 appartamenti da vendere entro la fine dell'anno e supponiamo che la
vendita di ciascuno di essi sia indipendente dalla vendità dell'altro. Supponiamo inoltre di sapere, in base alla nostra
esperienza, che le probabilità di vendere i due appartementi nel tempo prefissato siano 3/4 e 2/3.
</p>

<p>
Consideriamo la variabile aleatoria \(X\) "numero di appartamenti venduti a fine anno". Essa è una variabile discreta per
il cui computo della distribuzione di probabilità conviene considerare i seguenti eventi: \(A\) "il primo alloggio viene
venduto" e \(B\) "il secondo alloggio viene venduto".
</p>

<p>
Osservando che in base a quanto affermato in precedenza avremo \(P(A) = \frac{3}{4}\), \(P(\bar{A}) = \frac{1}{4}\),
\(P(B) = \frac{2}{3}\) e \(P(\bar{B}) = \frac{1}{3}\) si ricava immediatamente:
</p>
<ul class="org-ul">
<li>\(p_X(0) = P(\bar{A} \cap \bar{B}) = P(\bar{a}) \cdot P(\bar{B}) = \frac{1}{12}\);</li>
<li>\(p_X(1) = P(\{\bar{A} \cap B\} \cup \{A \cap \bar{B}\}) = P(\{\bar{A} \cap B\}) + P(\{A \cap \bar{B}\}) = P(\bar{A}) \cdot P(B) + P(A) \cdot P(\bar{B})
  = \frac{5}{12}\);</li>
<li>\(p_X(2) = P(A \cap B) = P(A) \cdot P(B) = \frac{6}{12}\).</li>
</ul>
<p>
Possiamo determinare facilmente sia il valore atteso \(E[X] = \sum_{s \in S} s \cdot p_X(s) = 0 \cdot p_X(0) + 1 \cdot p_X(1) + 2 \cdot p_X(2) =
0 \cdot \frac{1}{12} + 1 \cdot \frac{5}{12} + 2 \cdot \frac{6}{12} = 1.416\)
che la moda per la variabile \(X\): \(\tilde{X} = 2\). Il calcolo della mediana richiede la determinazione preventiva della
funzione di ripartizione.
</p>

<p>
Tale funzione può essere calcolata per mezzo della distribuzione di probabilità e sarà:
</p>
\begin{equation*}
F_X(t) =
\begin{cases}
0 \quad &\text{per $t < 0$}\\
\frac{1}{12} \quad &\text{per $0 \leq t < 1$}\\
\frac{1}{2} \quad &\text{per $1 \leq t < 2$}\\
1 \quad &\text{per $t \geq 2$}
\end{cases}
\end{equation*}
<p>
Il grafico della funzione di ripartizione è riportato in seguito:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_17-38-00.png" alt="screenshot_2018-03-14_17-38-00.png" />
</p>
</div>

<p>
Dal grafico è possibile osservare che tutti i valori \(t \in [1, 2)\) sono mediane, infatti per ognuno di tali valori si ha che
\(P(X \leq t) = \frac{1}{2}\) e \(P(X \geq t) = \frac{1}{2}\).
</p>

<p>
Consideriamo la variabile assolutamente continua \(X\) già vista avente funzione di densità di probabilità data da
</p>
\begin{equation*}
f_X (t) =
\begin{cases}
0 \quad &\text{per $t < 0$}\\
e^{-t} \quad &\text{per $t \geq 0$}
\end{cases}
\end{equation*}
<p>
e funzione di ripartizione data da
</p>
\begin{equation*}
F_X (t) =
\begin{cases}
0 \quad &\text{per $t < 0$}\\
1-e^{-t} \quad &\text{per $t \geq 0$}
\end{cases}
\end{equation*}
<p>
Per questa variabile si ricavano immediatamente il valore atteso \(E[X] = \int_{-\infty}^{+\infty} t \cdot f_X(t)dt = \int_0^{+\infty} t \cdot e^{-t}dt = \lim_{b \to +\infty}|-e^{-t}(t+1)|_0^b = 1\),
la mediana \(\bar{X} = F_X^{-1}(0.5) = - \log 0.5 = 0.693\) ed infine la moda \(\tilde{X} = 0\) essendo questo
il punto di massimo della funzione di densità di probabilità.
</p>

<p>
Per misurare il grado di dispersione dei valori assumibili da una variabile aleatoria vengono usati gli <i>indici di
variabilità</i>. Tra questi quello che risulta in assoluto il più importante è senza dubbio la <i>varianza</i>. Formalmente,
data una variabile aleatoria \(X\) è detta <i>varianza</i> di \(X\) la quantità
</p>
\begin{equation*}
V[X] =
\begin{cases}
\sum_{s \in S}(s - E[X])^2 p_X(s) \quad &\text{se $X$ è discreta}\\
\int_{-\infty}^{+\infty}(u - E[X])^2 f_X(u)du \quad &\text{se $X$ è assolutamente continua}
\end{cases}
\end{equation*}
<p>
Così come il valore atteso anche la varianza talvolta può non esistere, quando la sommatoria o l'integrale divergono.
</p>

<p>
Così come il valore atteso di una variabile aleatoria \(X\) viene spesso indicato con \(\mu_x\) la <i>varianza</i> viene sovente indicata
\(\sigma_X^2\). Essa viene indicata con il quadrato in quanto la sua radice è un altro indice molto importante chiamato
<i>deviazione standard</i> \(\sigma_X = \sqrt{\sigma_X^2}\). La deviazione standard ha il vantaggio rispetto alla varianza di avere la stessa
unità di misura del valore atteso.
</p>

<p>
Anche la varianza gode di alcune proprietà che è meglio ricordare:
</p>
<ul class="org-ul">
<li>Per ogni \(a \in \mathbb{R}\), se \(X = a\) con probabilità uguale ad 1 allora \(V[X] = 0\);</li>
<li>\(V[a \cdot X + b] = a^2 \cdot V[X]\) per ogni variabile \(X\) e per ogni \(a, b \in \mathbb{R}\);</li>
<li>\(V[X] = E[X^2] - (E[X])^2\) per ogni variabile aleatoria \(X\).</li>
</ul>

<p>
Consideriamo la variabile aleatoria descritta nell'esempio dei 2 appartamenti. Possiamo determinare la varianza o tramite la
definizione stessa o tramite la seguente proprietà: \(V[X] = E[X^2] - (E[X])^2\) per ogni variabile aleatoria \(X\).
</p>

<p>
In generale risulta più comodo utilizzare la proprietà sopra riportate così come faremo di seguito pertanto determiniamo
il momento centrale di ordine 2 della variabile \(X\).
\[E[X^2] = 0^2 \cdot p_X (0) + 1^2 \cdot p_X (1) + 2^2 \cdot p_X (2) = 0^2 \cdot \frac{1}{12} + 1^2 \cdot \frac{5}{12} + 2^2 \cdot \frac{6}{12} = \frac{29}{12}\]
La varianza risulta quindi essere \(V[X] = E[X^2] - (E[X])^2 = \frac{29}{12} - (1.416)^2 = 0.42\) mentre la deviazione standard
è \(\sigma_X = \sqrt{0.42} = 0.65\).
</p>

<p>
Consideriamo la variabile aleatoria \(X\) descritta precedentemente. Calcoliamone la varianza:
\[V[X] = E[X^2] - (E[X])^2 = \int_0^{+\infty} t^2 \cdot e^{-t} dt - 1^2 = \lim_{b \to +\infty}|-e^{-t}(t^2 + 2t + 2)|_0^b - 1= 2 - 1 = 1\]
inoltre la deviazione standard è \(\sigma_X = \sqrt{1} = 1\) ed è pertanto maggiore di quella dell'esempio precedente.
</p>

<p>
Gli indici visti fino ad ora sono relativi a variabili unidimensionali. Anche per le variabili multidimensionali ed in
particolare per quelle bidimensionali esistono indici di tendenza centrale e variabilità.
</p>

<p>
Sia \((X, Y)\) una variabile aleatoria bidimensionale discreta o continua. Sono detti <i>valori attesi marginali</i> e
<i>varianze marginali</i> le quantità \(E[X], E[Y], V[X], V[Y]\) ottenute considerando le distribuzioni marginali di \(X\) ed \(Y\)
ed integrando (o sommando) in accordo alle seguenti
</p>
\begin{equation*}
E[X] =
\begin{cases}
\sum_{s \in S} s \cdot p_X(s) \quad &\text{se $X$ è discreta}\\
\int_{-\infty}^{+\infty} u \cdot f_X(u)du \quad &\text{se $X$ è assolutamente continua}
\end{cases}
\end{equation*}
\begin{equation*}
V[X] =
\begin{cases}
\sum_{s \in S}(s - E[X])^2 p_X(s) \quad &\text{se $X$ è discreta}\\
\int_{-\infty}^{+\infty}(u - E[X])^2 f_X(u)du \quad &\text{se $X$ è assolutamente continua}
\end{cases}
\end{equation*}
<p>
Si noti che la varianza è il valore atteso di \(g(X) = (X - E[X])^2\).
</p>

<p>
È utile ricordare che valgono le seguenti relazioni:
</p>
<ul class="org-ul">
<li>\(E[a \cdot X + b \cdot Y] = a \cdot E[X] + b \cdot E[Y]\) per ogni coppia \(X, Y\) e per ogni \(a, b \in \mathbb{R}\);</li>
<li>\(E[X \cdot Y] = E[X] \cdot E[Y]\) per ogni coppia \(X, Y\) stocasticamente indipendenti;</li>
<li>\(V[X + Y] = V[X] + V[Y]\) per ogni coppia \(X, Y\) stocasticamente indipendenti.</li>
</ul>
<p>
Oltre ai valori attesi ed alle varianze marginali, un altro indice è estremamente importante, si tratta della
<i>covarianza</i> definita come
\[\text{Cov}[X, Y] = E[(X - E[X]) \cdot (Y - E[Y])] = \iint_{\mathbb{R}^2} (t - E[X]) \cdot (s - E[Y]) \cdot f_{X, Y} (t, s) dt ds\]
o equivalentemente come
\[\text{Cov}[X, Y] = E[X \cdot Y] - E[X] \cdot E[Y] = \iint_{\mathbb{R}^2} t \cdot s \cdot f_{X, Y}(t, s)dt ds - \int_{\mathbb{R}} t \cdot f_X (t) dt \cdot \int_{\mathbb{R}} s \cdot f_Y(s)ds\]
La covarianza è un indice della correlazione che sussiste tra due variabili ovvero del loro grado di dipendenza reciproca.
Tanto più essa è grande tanto più forte è il legame di dipendenza tra le variabili. Si noti ad esempio che se le variabili
\(X\) ed \(Y\) sono stocasticamente indipendenti, allora in base alla seguente proprietà:
</p>

<p>
\(E[X \cdot Y] = E[X] \cdot E[Y]\). Per ogni coppia \(X, Y\) stocasticamente indipendente
si ottiene che \(\text{Cov}[X, Y] = E[X \cdot Y] - E[X] \cdot E[Y] = E[X] \cdot E[Y] - E[X] - E[Y] = 0\).
Due variabili aleatorie aventi covarianza nulla vengono dette <i>incorrelate</i>.
</p>

<p>
Occorre però sottolineare che la nozione di incorrelazione è più debole di quella di indipendenza. Infatti, è possibile
mostrare che seppur esistono coppie di variabili incorrelate esse non sono indipendenti.
</p>

<p>
Un ultimo indice da ricordare, strettamente legato alla covarianza ed utilizzato per esprimere più chiaramente il grado
di dipendenza tra due variabili, è il <i>coefficiente di correlazione lineare di Pearson</i>:
\[ \rho_{XY} = \frac{\text{Cov}[X, Y]}{\sqrt{V[X]\cdot V[Y]}} = \frac{\text{Cov}[X, Y]}{\sigma_X \cdot \sigma_Y}\]
Tale indice rispetto alla covarianza ha il vantaggio di godere delle seguenti proprietà:
</p>
<ul class="org-ul">
<li>\(\rho_{XY} = 0\) se \(X\) ed \(Y\) sono incorrelate;</li>
<li>\(|\rho_{XY}| = 1\) se vale la relazione \(Y = a \cdot X + b\) per ogni \(a, b \in \mathbb{R}\). Più precisamente, se \(\rho_{XY}\) vale +1 allora \(a > 0\),
e se vale -1 allora \(a < 0\).</li>
</ul>
</div>
</div>

<div id="outline-container-org459715e" class="outline-3">
<h3 id="org459715e"><span class="section-number-3">2.3</span> Distribuzioni Notevoli</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Abbiamo visto che esiste una corrispondenza biunivoca tra la <b>funzione di ripartizione</b> e la
</p>
<ul class="org-ul">
<li>Densità di probabilità (variabili assolutamente continue);</li>
<li>Distribuzione di probabilità (variabili discrete).</li>
</ul>

<p>
Per tale ragione si usa parlare di "Distribuzione" di una variabile intendendo indifferentemente la sua ripartizione o
la sua densità (o distribuzione di probabilità).
</p>

<p>
La notazione \(X \sim F\) va letta come "la variabile \(X\) è distribuita secondo \(F\)".
</p>
</div>

<div id="outline-container-org9740ce3" class="outline-4">
<h4 id="org9740ce3"><span class="section-number-4">2.3.1</span> Distribuzione Bernoulliana</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
Una variabile aleatoria \(X\) è detta <i>distribuita secondo una Bernoulliana di parametro \(p\)</i>, \(p \in [0, 1]\), \(X \sim B(p)\),
se essa può assumere solo i valori 1 e 0 rispettivamente con probabilità \(p\):
</p>
\begin{equation*}
p_X(t) =
\begin{cases}
1 - p &\text{se $t = 0$}\\
p     &\text{se $t = 1$}\\
0     &\text{altrimenti}
\end{cases}
\end{equation*}
\begin{equation*}
F_X(t)=
\begin{cases}
0 &\text{se $t < 0$}\\
1 - p &\text{se $0 \leq t < 1$}\\
1 &\text{se $t \geq 1$}
\end{cases}
\end{equation*}
<p>
L'importanza di questa semplice distribuzione è ovvia, sono variabili di Bernoulli tutte quelle che individuano il verificarsi
di uno specifico evento e che valgono 1 se questo si verifica e 0 altrimenti.
</p>

<p>
Immediate sono le determinazioni della <i>media</i> e della <i>varianza</i> di una <i>Bernoulliana</i> che risultano essere:
\[ E[X] = 0 \cdot (1 - p) + 1 \cdot p = p\]
\[ V[X] = [0^2 \cdot (1 - p) + 1^2 \cdot p] - p^2 = (1 - p)p\]
</p>
</div>
</div>

<div id="outline-container-org0209c57" class="outline-4">
<h4 id="org0209c57"><span class="section-number-4">2.3.2</span> Distribuzione Binomiale</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
Siano \(X_1, \dots, X_n, n\) variabili Bernoulliane di identico parametro \(p\) e stocasticamente indipendenti tra loro. Sia poi \(X\)
una variabile aleatoria definita come somma delle \(X_i\) ovvero sia \(X = X_1 + \dots + X_n\). Una tale variabile è detta
<i>distribuita secondo una Binomiale con parametri \(n\) e \(p\)</i>: \(X \sim \text{Bin}(n, p)\). Una tale variabile può assumere qualsiasi
valore intero \(k\) compreso tra \(0\) ed \(n\) in accordo alla seguente probabilità:
\[P(X=k) = \binom{n}{k} \cdot p^k \cdot (1 - p)^{n-k}\]
</p>

<p>
La motivazione della precedente formula è la seguente: \(p^k \cdot (1 - p)^{n-k}\) fornisce la probabilità che \(k\) delle \(n\) variabili \(X_i\)
assuma il valore 1 e che le restanti \((n-k)\) assumano valore 0.
</p>

<p>
\(\binom{n}{k} = \frac{n!}{(n-k)! k!}\) esprime il numero di combinazioni possibili per cui \(k\) variabili valgono 1 e \((n-k)\)
valgono 0.
</p>

<p>
In definitiva la <i>distribuzione di probabilità</i> e la <i>funzione di ripartizione</i> risultano essere
</p>

\begin{equation*}
p_X(t)=
\begin{cases}
\binom{n}{t}p^t(1-p)^{n-t} &\text{se $t \in \{0, 1, \dots, n\}$}\\
0 &\text{altrimenti}
\end{cases}
\end{equation*}
<p>
\[F_X(t) = \sum_{0 \leq k \leq n:k \leq t} \binom{n}{k} p^k(1-p)^{n-k} \quad \text{per ogni $t \in \mathbb{R}$}\]
L'indipendenza tra le variabili \(X_i\) consente di determinare facilmente il <i>valore atteso</i> e la <i>varianza</i> della
variabile \(X\):
\[E[X] = E[X_1 + \dots + X_n] = E[X_1] + \dots + E[X_n] = n \cdot p\]
\[V[X] = V[X_1] + \dots + V[X_n] = n \cdot (1-p) \cdot p\]
La principale applicazione della distribuzione binomiale consiste nella definizione di variabile che "contano" le realizzazioni
di eventi quando questi siano da considerarsi indipendenti e con identica probabilità di verificarsi.
</p>

<p>
Questo è per esempio il caso della variabile \(X\) definita nei 2 seguenti esempi visti in precedenza:
</p>

<p>
Facciamo riferimento all'esempio degli appartamenti e consideriamo lo spazio \(\Omega\) e la probabilità \(P\) in esso definiti.
Una variabile aleatoria che ha senso considerare in questo caso potrebbe essere la \(X :=\) "numero di appartamenti venduti
a fine anno". Formalmente essa andrebbe definita come funziona da \(\Omega\) in \(\mathbb{R}\) che assegna:
</p>
<ul class="org-ul">
<li>\(X((0, 0, 0)) = 0\)</li>
<li>\(X((0, 0, 1)) = X((0, 1, 0)) = X((1, 0, 0)) = 1\)</li>
<li>\(X((0, 1, 1)) = X((1, 1, 0)) = X((1, 0, 1)) = 2\)</li>
<li>\(X((1, 1, 1)) = 3\)</li>
</ul>

<p>
In base alla definizione della variabile casuale \(X\) che abbiamo fornito, ha senso definire la probabilità che
esattamente un appartamento venga venduto \(X\) = 1. Infatti, vale quanto segue:
\[ P(X=1) = P(\omega \in \Omega : X(\omega) = 1) = P(\{(0, 0, 1), (0, 1, 0), (1, 0, 0)\}) = \frac{3}{8}\]
</p>

<p>
Riconsideriamo la variabile aleatoria definita nell'esempio precedente, e determiniamone la corrispondente funzione di
ripartizione. Per questo osserviamo prima di tutto che la \(X\) può assumere solo i valori 0, 1, 2 e 3.
Quindi sicuramente sarà \(F_X(t) = P(X \leq t) = 0\) per \(t < 0\). Avremo poi
</p>
\begin{align*}
&F_X(t) = P(X = 0) = P(\{0, 0, 0\}) = \frac{1}{8} \text{ per } t <0\\
&F_X(t) = P(X = 0 \text{ oppure } 1) = P(\{(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 0, 1)\}) = \frac{1}{2} \text{ per } 1 \leq t \leq 2\\
&F_X(t) = P(X = 0 \text{ oppure } 1 \text{ oppure } 2) = 1 - P(X = 3) = 1 - P(\{(1, 1, 1)\}) = 1 - \frac{1}{8} = \frac{7}{8} \text{ per } 2 \leq t < 3\\
&F_X(t) = P(X = 0 \text{  oppure  } 1 \text{ oppure } 2 \text{ oppure } 3) = P(\Omega) = 1 \text{ per } t \geq 3
\end{align*}

<p>
La funzione di ripartizione risulta essere descritta dal grafico nella figura sottostante:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-14_10-05-12.png" alt="screenshot_2018-03-14_10-05-12.png" />
</p>
</div>

<p>
In questi 2 esempi \(X\) risulta essere una variabile aleatoria distribuita secondo una Binomiale con parametri 3 e 1/2.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_11-26-21.png" alt="screenshot_2018-03-24_11-26-21.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgf7a050d" class="outline-4">
<h4 id="orgf7a050d"><span class="section-number-4">2.3.3</span> Distribuzione di Poisson</h4>
<div class="outline-text-4" id="text-2-3-3">
<p>
La distribuzione di <i>Poisson</i> può essere vista come un caso particolare della distribuzione Binomiale che si ottiene quando il
numero di variabili \(X_i\) che compaiono in \(X = X_1 + \dots X_n\) tende ad infinito mentre il valore del parametro \(p\) tende a
zero in modo tale che il prodotto \(n \cdot p\) resti costante.
</p>

<p>
In questo caso, assumendo \(\lambda = n \cdot p\) diremo che la variabile \(X = X_1 + \dots + X_n\) è distribuita secondo una Poisson con parametro
\(\lambda, \lambda \in \mathbb{R}_+\): \(X \sim \text{Poi}(\lambda)\).
</p>

<p>
Osserviamo che la variabile così definita può assumere un qualsiasi valore intero \(k\). Le probabilità associate ai valori
assumibili da \(X\) si ricavano dalla seguente relazione: \(P(X=k) = \binom{n}{k} \cdot p^k \cdot (1-p)^{n-k}\) con un passiaggio al limite per
\(n \to +\infty\) (sotto il vincolo \(\lambda = n \cdot p\) costante) e risultano:
\[ P(X=k) = \frac{\lambda^k}{k!} e^{-\lambda} \quad \forall k \in \mathbb{N}\]
In definitiva la <i>distribuzione di probabilità</i> e la <i>funzione di ripartizione</i> risultano essere:
</p>
\begin{equation*}
p_X(t) =
\begin{cases}
\frac{\lambda^t}{t!}\cdot e^{-\lambda} &\text{se $t \in \{0, 1, \dots\}$}\\
0 &\text{altrimenti}
\end{cases}
\end{equation*}
<p>
\[F_X(t) = \sum_{k \in \mathbb{N} : k \leq t} \frac{\lambda^k}{k!} \cdot e^{-\lambda} \quad \text{per ogni $t \in \mathbb{R}$}\]
Il <i>valore atteso</i> e la <i>varianza</i> di una tale variabile Poissoniana si ricavano facilmente da quelli delle Bernoulliane,
ricordando che \(\lambda = n \cdot p\).
</p>

<p>
Il <i>valore atteso</i> risulta essere
\[E[X] = n \cdot p = \lambda\]
mentre per calcolare la <i>varianza</i> è necessario osservare che \(V[X] = n \cdot (1-p) \cdot p = n \cdot p - n \cdot p^2 = \lambda - \frac{\lambda^2}{n}\) e
che tale quantità diviene uguale a \(\lambda\) quando \(n\) tende ad infinito per cui
\[ V[X] = \lambda\]
La distribuzione di Poisson viene utilizzata quando si considerino grandi popolazioni di individui in cui ogni individuo ha
una probabilità \(p\) molto piccola di essere soggetto ad uno specifico evento in esame. Per tale ragione la <i>distribuzione
di Poisson viene anche detta degli eventi rari</i>.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_11-47-08.png" alt="screenshot_2018-03-24_11-47-08.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orge4d0927" class="outline-4">
<h4 id="orge4d0927"><span class="section-number-4">2.3.4</span> Distribuzione Geometrica</h4>
<div class="outline-text-4" id="text-2-3-4">
<p>
Una variabile aleatoria \(X\) è detta <i>distribuita secondo una Geometrica</i> di parametro \(p\), \(p \in [0, 1]\): \(X \sim \text{Geo}(p)\) se può
assumere qualsiasi valore intero non negativo \(k\) con probabilità \(P(X=k) = p \cdot (1-p)^k\) ovvero se ha la <i>distribuzione di probabilità</i>
e la <i>funzione di ripartizione</i> date da
</p>
\begin{equation*}
p_X(t)=
\begin{cases}
p \cdot (1-p)^t &\text{se $t \in \mathbb{N}$}\\
0 &\text{altrimenti}
\end{cases}
\end{equation*}
<p>
\[F_X(t) = \sum_{k \in \mathbb{N} : k \leq t} p \cdot (1-p)^k \quad \text{per ogni $t \in \mathbb{R}$}\]
Si consideri un esperimento, ripetuto a istanti rappresentati da numeri interi, di verifica di funzionamento di una macchina:
</p>

<p>
Se interpretiamo \(p\) come la probabilità che a un certo istante la macchina si guasti, la distribuzione geometrica dà la
<i>distribuzione di probabilità del PRIMO guasto</i>, cioè \(p_X(t)\) è la probabilità che il guasto si verifichi al tempo \(t+1\)-mo
(nei primi \(t\) istanti funziona).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_11-58-21.png" alt="screenshot_2018-03-24_11-58-21.png" />
</p>
</div>

<p>
<i>Valore atteso</i> e <i>varianza</i> di una variabile \(X\) con distribuzione Geometrica sono:
\[E[X] = \frac{1 - p}{p} \quad V[X] = \frac{1-p}{p^2}\]
L'importanza di questa distribuzione sta nella <i>proprietà di assenza di memoria</i>: \(P(X=k+m|X \geq m) = P(X=k)\).
</p>

<p>
Per comprenderne il significato, supponiamo che \(X\) sia il tempo di vita di una macchina soggetta a guasti (possono
avvenire solo in corrispondenza di intervalli di tempo unitari), e supponiamo di aver rilevato che per \(m\) unità di
tempo essa non si sia guastata.
</p>

<p>
La proprietà di assenza di memoria asserisce che la probabilità che la macchina si guasti all'istante \(k+m\)-esimo,
condizionata dall'evento \(X \geq m\), è uguale alla probabilità iniziale che essa si guasti all'istante \(k\)-esimo.
</p>

<p>
In definitiva, la proprietà di assenza di memoria asserisce che il tempo trascorso da quando abbiamo iniziato ad esaminare
il funzionamento della macchina non influisce sulla distribuzione del tempo restante al verificarsi del guasto.
</p>
</div>
</div>

<div id="outline-container-orgf0cf99a" class="outline-4">
<h4 id="orgf0cf99a"><span class="section-number-4">2.3.5</span> Distribuzione Uniforme</h4>
<div class="outline-text-4" id="text-2-3-5">
<p>
La <i>distribuzione uniforme</i> rappresenta la più semplice distribuzione continua e viene adottata nel caso in cui
la variabile considerata possa assumere qualsiasi valore compreso in un dato intervallo con probabilità costante.
</p>

<p>
Formalmente diciamo che la variabile \(X\) è <i>distribuita secondo una Uniforme di supporto</i> \([a, b]\): \(X \sim U[a, b]\) se
essa è assolutamente continua con <i>densità</i> e <i>funzione di ripartizione</i>:
</p>
\begin{equation*}
f_X(t)=
\begin{cases}
\frac{1}{b-a} &\text{se $t \in [a, b]$}\\
0 &\text{altrimenti}
\end{cases}
\end{equation*}
\begin{equation*}
F_X(t) =
\begin{cases}
0 &\text{se $t < a$}\\
\frac{t-a}{b-a} &\text{se $t \in [a, b]$}\\
1 &\text{se $t > b$}
\end{cases}
\end{equation*}
<p>
Tramite semplici integrazioni è possibile ricavare il <i>valore atteso</i> e la <i>varianza</i>:
\[ E[X] = \frac{a + b}{2} \quad V[X] = \frac{(b-a)^2}{12}\]
Come accennato in precedenza l'interesse in questa distribuzione è giustificato dal fatto che essa descrive bene
situazioni nelle quali le variabili possono assumere valori in intervalli finiti di \(\mathbb{R}\) con probabilità uniforme
ovvero tale da essere identica per intervalli di medesima ampiezza (purché contenuti nel supporto della variabile stessa).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_12-23-30.png" alt="screenshot_2018-03-24_12-23-30.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org0fc4d4b" class="outline-4">
<h4 id="org0fc4d4b"><span class="section-number-4">2.3.6</span> Distribuzione triangolare</h4>
<div class="outline-text-4" id="text-2-3-6">
<p>
Quando si considerano variabili aleatorie con supporto \([a, b] \subseteq \mathbb{R}\) può essere limitativo pensare che i
valori assumibili abbiano tutti la stessa probabilità di presentarsi. Per questa ragione sono state introdotte in letteratura
diverse generalizzazioni della distribuzione uniforme. Una di queste è la distribuzione triangolare, che assegna alla
densità di probabilità valori maggiori al centro del supporto e minori in prossimità degli estremi.
</p>

<p>
Formalmente diciamo che la variabile \(X\) è <i>distribuita secondo una Triangolare di supporto</i> \([a, b]\): \(X \sim T[a, b]\)
se essa è assolutamente continua con <i>densità</i> e <i>funzione di ripartizione</i>
</p>
\begin{equation*}
f_X(t)=
\begin{cases}
\frac{4 \cdot (t-a)}{(b-a)^2} &\text{se $t \in \left[a, \frac{a + b}{2}\right)$}\\
\frac{4 \cdot (b-t)}{(b-a)^2} &\text{se $t \in \left[\frac{a + b}{2}, b\right]$}
\end{cases}
\end{equation*}
\begin{equation*}
F_X(t)=
\begin{cases}
0 &\text{se $t < a$}\\
2 \cdot \frac{(t-a)^2}{(b-a)^2} &\text{se $t \in \left[a, \frac{a+b}{2}\right)$}\\
1 - 2 \cdot \frac{(b-t)^2}{(b-a)^2} &\text{se $t \in \left[\frac{a+b}{2}, b\right]$}
\end{cases}
\end{equation*}
<p>
Tramite integrazione è possibile ricavare il <i>valore atteso</i> e la <i>varianza</i>
\[E[X] = \frac{a+b}{2} \quad V[X] = \frac{(b-a)^2}{24}\]
</p>
</div>
</div>

<div id="outline-container-org6e8b451" class="outline-4">
<h4 id="org6e8b451"><span class="section-number-4">2.3.7</span> Distribuzione esponenziale</h4>
<div class="outline-text-4" id="text-2-3-7">
<p>
La distribuzione esponenziale è particolarmente importante nello studio di quelle variabili che descrivono i tempi
occorrenti al verificarsi di un evento (tempi di attesa per la vendita o per la costruzione di un immobile).
</p>

<p>
Formalmente, una variabile aleatoria \(X\) è <i>distribuita secondo una Esponenziale di parametro \(\lambda\)</i>, con \(\lambda \in \mathbb{R}_+\):
\(X \sim \text{Exp}(\lambda)\) se essa è assolutamente continua con <i>densità</i> e <i>funzione di ripartizione</i>
</p>
\begin{equation*}
f_X(t) =
\begin{cases}
\lambda \cdot e^{-\lambda t} &\text{se $t \geq 0$}\\
0 &\text{se $t < 0$}
\end{cases}
\end{equation*}
\begin{equation*}
F_X(t)=
\begin{cases}
1 - e^{-\lambda t} &\text{se $t \geq 0$}\\
0 &\text{se $t < 0$}
\end{cases}
\end{equation*}
<p>
Tramite integrazione si ricavano il <i>valore atteso</i> e la <i>varianza</i> che risultano essere
\[E[X] = \frac{1}{\lambda} \quad V[X] = \frac{1}{\lambda^2}\]
Proprietà di assenza di memoria: \(P(X > s + t | X > s) = P(X > t)\).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_14-44-08.png" alt="screenshot_2018-03-24_14-44-08.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgad633a3" class="outline-4">
<h4 id="orgad633a3"><span class="section-number-4">2.3.8</span> Distribuzione normale</h4>
<div class="outline-text-4" id="text-2-3-8">
<p>
Una variabile aleatoria \(X\) è detta distribuita secondo una <i>Normale</i> con parametri \(\mu\) e \(\sigma\), con \(\mu \in \mathbb{R}\)
e \(\sigma \in \mathbb{R}_+\): \(X \sim N(\mu, \sigma)\) se essa è <i>assolutamente continua</i> con densità
\[f_X(t) = \frac{1}{\sqrt{2 \cdot \pi \cdot \sigma^2}} \cdot e^{-\frac{(t - \mu)^2}{2 \cdot \sigma^2}}\]
per ogni \(t \in \mathbb{R}\).
</p>

<p>
Nonostante la funzione di densità della distribuzione Normale sia molto complessa, questa distribuzione è fondamentale
nella statistica in virtù del <i>teorema centrale limite</i> e delle numerose proprietà da essa possedute che vedremo nel
seguito. Per ora limitiamoci ad osservare che tramite integrazioni non particolarmente semplici si ricavano
<i>valore atteso</i> e <i>varianza</i> date da
\[E[X] = \mu \quad V[X] = \sigma^2\]
Pertanto i parametri della distribuzione sono rispettivamente il <i>valore atteso</i> e la <i>deviazione standard</i> della distribuzione.
</p>

<p>
Inoltre, la variabile aleatoria ha supporto su tutto l'asse reale.
</p>

<p>
Graficamente la densità di una Normale risulta come quella presentata sotto:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_14-51-43.png" alt="screenshot_2018-03-24_14-51-43.png" />
</p>
</div>

<p>
Si osservi che la moda coincide con la media e che in corrispondenza dei valori \(\mu - \sigma\) e \(\mu + \sigma\) vi sono dei punti di flesso.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_14-52-56.png" alt="screenshot_2018-03-24_14-52-56.png" />
</p>
</div>

<p>
Non è facile, dati \(a\) e \(b \in \mathbb{R}\) con \(a < b\), determinare la probabilità che la variabile \(X \sim N(\mu, \sigma)\)
assuma valori in \([a, b]\) ovvero calcolare
\[P(X \in [a, b]) = \int_a^b \frac{1}{\sqrt{2 \cdot \pi \cdot \sigma^2}} \cdot e^{-\frac{(t - \mu)^2}{2 \cdot \sigma^2}}dt\]
in quanto la risoluzione dell'integrale non è immediata.
</p>

<p>
Per questa ragione si ricorre ad opportune tavole che si riferiscono alla <i>distribuzione normale standard</i> ovvero
con parametri \(\mu=0\) e \(\sigma=1\) e che forniscono i valori di \(\int_0^z f_X(t)dt\) per un elevato numero di valodi
di \(z \in \mathbb{R}_+\).
</p>

<p>
Quando si sia interessati a determinare delle probabilità associate ad una generica \(X ~ N(\mu, \sigma)\) è possibile
ricondursi al caso appena presentato osservando che la variabile \(Z = \frac{X - \mu}{\sigma}\) è distribuita secondo
una <i>Normale Standard</i> ovvero vale la seguente proprietà:
\[\text{se } X \sim N(\mu, \sigma) \text{ allora } Z = \frac{X - \mu}{\sigma} \sim N(0, 1)\]
In base a tale proprietà ogni variabile \(X \sim N(\mu, \sigma)\) può essere ricondotta ad una <i>Normale Standardizzata</i>, ovvero
ancora per ogni \([a, b] \subseteq \mathbb{R}\) si avrà:
</p>
\begin{equation*}
P(X \in [a, b]) = P(a \leq X \leq b) = P\left(\frac{a - \mu}{\sigma} \leq \frac{X - \mu}{\sigma} \leq \frac{b - \mu}{\sigma}\right)
= P\left(Z \in \left[\frac{a - \mu}{\sigma}, \frac{b-\mu}{\sigma}\right]\right)
\end{equation*}

<p>
Per esempio, sia \(X\) una variabile aleatoria con distribuzione normale di parametri \(\mu = 10\) e \(\sigma = 1\) e si voglia
determinare la probabilità dell'evento "\(X \in [9.2, 11.35]\)".
In base a quanto appena esposto avremo:
\[P(X \in [9.2, 11.35]) = P \left(Z \in \left[\frac{9.2 - 10}{1}, \frac{11.35 - 10}{1}\right]\right) = P(Z \in [-0.8, 1.35])\]
L'ultimo valore di probabilità è relativo ad una normale standard e può essere calcolato tramite le tavole,
inoltre data la simmetria della normale si può scrivere:
\[P(Z \in [-0.8, 0]) = P(Z \in [0, 0.8])\]
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_15-14-09.png" alt="screenshot_2018-03-24_15-14-09.png" />
</p>
</div>

<p>
Inoltre, dalle tavole si ricava \(P(Z \in [0, 1.35]) = 0.4115\) e \(P(Z \in [-0.8, 0]) = P(Z \in [0, 0.8]) = 0.2881\).
</p>

<p>
In definitiva avremo \(P(X \in [9.2, 11.35]) = P(Z \in [-0.8, 1.35]) = P(Z \in [0, 0.8]) + P(Z \in [0, 1.35]) = 0.44115 + 0.2881 = 0.6996\)
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_15-16-37.png" alt="screenshot_2018-03-24_15-16-37.png" />
</p>
</div>

<p>
Se invece avessimo voluto determinare la probabilità \(P(X \in [10.53, 12.15])\). Avremmo dovuto innanzitutto osservare
che \(P(X \in [10.53, 12. 15]) = P(Z \in [0.53, 2.15])\). Tramite le tavole determinare
\(P(Z \in [0.00, 0.53]) = 0.2019\) e \(P(Z in [0.00, 2.15]) = 0.4842\) ed osservare che
\(P(Z \in [0.53, 2.15]) = P(Z \in [0.00, 2.15]) - P(Z \in [0.00, 0.53]) = 0.4842 - 0.2019 = 0.2823\)
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_15-19-48.png" alt="screenshot_2018-03-24_15-19-48.png" />
</p>
</div>

<p>
Infine, se avessimo voluto determinare la probaiblità \(P(X \in [10.3, +\infty])\), avremmo dovuto innanzitutto osservare che
\(P(X \in [10.3, +\infty]) = P(Z \in [0.3, +\infty]) = 1 - P(Z \in [-\infty, 0.3])\). Poiché in base alle tavole
\(P(Z \in [0, 0.3]) = 0.1179\) segue che
\(P(X \in [10.3, +\infty]) = 1 - P(Z \in [-\infty, 0.3]) = 1 - 0.5 - 0.1179 = 0.3821\)
</p>

<p>
<i>Regole di calcolo per normali standardizzate da tabelle per integrali</i> \(\int_0^b f(u)du\):
</p>
<ul class="org-ul">
<li>Integrali della forma \(\int_{-\infty}^b f(u)du\):
<ul class="org-ul">
<li>\(b\) finito &gt; 0: \(\int_{-\infty}^b f(u)du = \frac{1}{2} + \int_0^b f(u)du\);</li>
<li>\(b\) finito &lt; 0: \(\int_{-\infty}^b f(u)du = \frac{1}{2} - \int_0^b f(u)du\);</li>
</ul></li>
<li>\(\int_a^{+\infty} f(u)du = 1 - \int_{-\infty}^a f(u)du\);</li>
<li>\(\int_a^b f(u)du = \int_{-\infty}^b f(u)du - \int_{-\infty}^a f(u)du\);</li>
</ul>

<p>
In base a quanto presentato nell'esempio è possibile verificare che per ogni variabile \(X\) con distribuzione Normale
e per qualsiasi valore dei suoi parametri valgono le seguenti eguaglianze:
</p>
<ul class="org-ul">
<li>\(P(X \in [\mu - \sigma, \mu + \sigma]) = 0.683\);</li>
<li>\(P(X \in [\mu - 2 \cdot \sigma, \mu + 2 \cdot \sigma]) = 0.954\);</li>
<li>\(P(X \in [\mu - 3 \cdot \sigma, \mu + 3 \cdot \sigma]) = 0.997\).</li>
</ul>
<p>
È interessante verificare in base alla terza di tali uguaglianze che ogni variabile casuale \(X \sim N(\mu, \sigma)\) assumerà valori compresi
tra \(\mu - 3\sigma\) e \(\mu + 3\sigma\) con probabilità molto prossima ad uno.
</p>

<p>
Una delle principali <i>proprietà</i> della distribuzione normale è quella <i>di chiusura rispetto all'operazione di somma di variabili
aleatorie stocasticamente indipendenti</i>:
</p>
<ul class="org-ul">
<li>Se \(X_1 \sim N(\mu_1, \sigma_1)\) e \(X_2 \sim N(\mu_2, \sigma_2)\) e se \(X_1\) e \(X_2\) sono indipendenti, allora la variabile \(Y = X_1 + X_2\) è tale che
\(Y \sim N(\mu_1 + \mu_2, \sqrt{\sigma_1^2 + \sigma_2^2})\)</li>
</ul>
<p>
In altri termini la variabile somma di due variabili aleatorie stocasticamente indipendenti con distribuzioni normali è
ancora una variabile aleatoria distribuita secondo una normale i cui parametri sono ricavabili facilmente da quelli delle
distribuzioni degli addendi.
</p>
</div>
</div>

<div id="outline-container-orgf8c28cb" class="outline-4">
<h4 id="orgf8c28cb"><span class="section-number-4">2.3.9</span> Distribuzione Chi-Quadro</h4>
<div class="outline-text-4" id="text-2-3-9">
<p>
Siano \(X_1, \dots, X_n\) \(n\) variabili con distribuzione normale di parametri 0 ed 1 (normali standardizzate) ed
indipendenti tra loro. Sia poi \(X\) una variabile aleatoria definita come somma dei quadrati delle \(X_i\)
ovvero sia \(X = X_1^2 + \dots + X_n^2\). Una tale variabile è distribuita secondo una <i>Chi-Quadro con \(n\) gradi di libertà</i>:
\(X \sim \chi_n^2\).
</p>

<p>
Notiamo che, essendo definita come somma di quadrati, una variabile con distribuzione Chi-Quadro può assumere solo valori
non negativi.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_16-06-24.png" alt="screenshot_2018-03-24_16-06-24.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org66bb5ea" class="outline-4">
<h4 id="org66bb5ea"><span class="section-number-4">2.3.10</span> Distribuzione t di STUDENT</h4>
<div class="outline-text-4" id="text-2-3-10">
<p>
Siano \(Z \sim N(0, 1)\) e \(Y \sim \chi_n^2\) due variabili indipendenti. Sia poi \(X\) una variabile aleatoria definita come
\[X = \frac{Z}{\sqrt{\frac{Y}{n}}}\]
Una tale variabile è distribuita secondo una <i>t di student</i> con \(n\) gradi di libertà: \(X \sim t_n\). Questa distribuzione è
di grande interesse come la distribuzione Normale e al distribuzione Chi-Quadro.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_16-10-15.png" alt="screenshot_2018-03-24_16-10-15.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org25384c3" class="outline-4">
<h4 id="org25384c3"><span class="section-number-4">2.3.11</span> Distribuzione F di FISHER</h4>
<div class="outline-text-4" id="text-2-3-11">
<p>
Siano \(U \sim \chi_m^2\) e \(V \sim \chi_n^2\) due variabili indipendenti. Sia poi \(X\) una variabile aleatoria definita come
\[X = \frac{\frac{U}{m}}{\frac{V}{n}}\]
Una tale variabile è <i>distribuita secondo una \(F\) con \(m\) ed \(n\) gradi di libertà</i>: \(X \sim F(m, n)\).
</p>

<p>
Questa distribuzione è di grande interesse coma la distribuzione Normale, la distribuzione Chi Quadro e la distribuzione \(t\)
di Student.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-03-24_16-12-57.png" alt="screenshot_2018-03-24_16-12-57.png" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfc27058" class="outline-3">
<h3 id="orgfc27058"><span class="section-number-3">2.4</span> Teoremi di Convergenza</h3>
<div class="outline-text-3" id="text-2-4">
<p>
In questo capitolo presentiamo 2 teoremi fondamentali nella statistica inferenziale:
</p>
<ul class="org-ul">
<li>Legge dei Grandi Numeri;</li>
<li>Teorema Limite Centrale.</li>
</ul>
<p>
Questi 2 teoremi richiedono la nozione di convergenza di variabili aleatorie.
</p>

<p>
<i>Convergenza in distribuzione</i>
</p>

<p>
Consideriamo una successione \(\{X_n, n \in \mathbb{N}\}\) di variabili aleatorie, e sia \(F_n\) la funzione di ripartizione
della generica variabile \(X_n\) della successione. Diremo che <i>la successione converge in distribuzione alla variabile
X</i> avente funzione di ripartizione \(F\) se vale \(\lim_{n \to \infty}F_n(t) = F(t)\) per ogni \(t \in \mathbb{R}\) che sia punto
di continuità per la \(F\). Verranno utilizzate le notazioni \(X_n \overset{d}{\to} X \quad F_n \overset{d}{\to} F\).
</p>

<p>
Per esempio, consideriamo una successione di variabili aleatorie \(\{X_n, n \in \mathbb{N}\}\) in cui la generica variabile
\(X_n\) ha funzione di ripartizione
</p>
\begin{equation*}
F_n(t) =
\begin{cases}
0 &\text{ se $t \leq 0$}\\
t^{\left(\frac{n}{n+1}\right)} &\text{ se $0 < t < 1$}\\
1 &\text{ se $t \geq 1$}
\end{cases}
\end{equation*}

<p>
Osserviamo ora che per ogni \(t \in (0, 1) \subseteq \mathbb{R}\) vale \(\lim_{n \to \infty}t^{\left(\frac{n}{n+1}\right)} = t\) da
cui se ne deduce che vale \(X_n \overset{d}{\to} X\) dove \(X\) ha funzione di ripartizione data da
</p>
\begin{equation*}
F_n(t) =
\begin{cases}
0 &\text{ se $t \leq 0$}\\
t &\text{ se $0 < t < 1$}\\
1 &\text{ se $t \geq 1$}
\end{cases}
\end{equation*}

<p>
Ovvero la successione di variabili aleatorie considerata converge ad una variabile aleatoria avente distribuzione
uniforme di supporto \([0, 1]\).
</p>

<p>
Il grafico della successione per \(n = 10\) mostra un comportamento molto simile a quello proprio di una variabile
aleatoria con distribuzione uniforme in \([0, 1]\).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-26_15-50-00.png" alt="screenshot_2018-04-26_15-50-00.png" />
</p>
</div>

<p>
Nella definizione di convergenza in distribuzione vengono esclusi, nel passaggio al limite, i punti in cui la funzione
di ripartizione limite \(F\) è discontinua, e ciò affinché si abbia un concetto di convergenza il più possibile vicino
all'intuizione.
</p>

<p>
Consideriamo ad esempio una successione di numeri reali \(\{a_n, n \in \mathbb{N}\}\) tale che sia \(a_n \overset{d}{\to} a\) per
\(n \to \infty\) dove \(a \in \mathbb{R}\) e pensiamo alle variabili aleatorie \(X_n\) aventi funzione di ripartizione
</p>
\begin{equation*}
F_n(t) =
\begin{cases}
0 &\text{ se $t < a_n$}\\
1 &\text{ se $t \geq a_n$}
\end{cases}
\end{equation*}

<p>
In pratica la generica variabile \(X_n\) assume valore \(a_n\) con probabilità uguale ad uno. Da un punto di vista intuitivo
siamo portati a pensare che valga \(X_n \overset{d}{\to} X\) dove la variabile \(X\) ha funzione di ripartizione
</p>
\begin{equation*}
F (t) =
\begin{cases}
0 &\text{ se $t < a$}\\
1 &\text{ se $t \geq a$}
\end{cases}
\end{equation*}
<p>
Ovvero \(X=a\) con probabilità uguale ad uno.
</p>

<p>
Osserviamo però che se la successione \({a_n, n \in \mathbb{N}}\) è tale che \(a < a_n\) con \(n\) pari e \(a_n < a\) con \(n\)
dispari, allora risulta \(F_n(a) = 0\) per \(n\) pari e \(F_n(a) = 1\) per n dispari. Pertanto non esiste il limite
\(\lim_{n \to \infty} F_n(a)\).
</p>

<p>
Pertanto non saremmo autorizzati a dire che vale \(X_n \overset{d}{\to} X\). Non essendo definibile in \(a\) la funzione
di ripartizione limite \(F\).
</p>

<p>
Problemi di questo tipo non si verificano se si escludono, nella definizione di convergenza, i valori in cui la \(F\)
limite non è continua. Si osservi infatti che per tutti gli altri valori di \(t\) risulta, correttamente:
</p>
\begin{gather*}
&\lim_{n \to \infty} F_n(t) = 0 = F(t) \quad \text{ se } t < a\\
&\lim_{n \to \infty} F_n(t) = 1 = F(t) \quad \text{ se } a < t
\end{gather*}

<p>
Osservazione: segnaliamo che la convergenza in distribuzione non è l'unico tipo di convergenza tra variabili aleatorie
definito in letteratura. Due tipi di convergenza estremamente importanti sono ad esempio la
</p>
<ul class="org-ul">
<li>Convergenza quasi certa;</li>
<li>Converganza in probabilità;</li>
</ul>
<p>
che comunque possiamo non considerare ai fini della nostra trattazione.
</p>
</div>
<div id="outline-container-org475815b" class="outline-4">
<h4 id="org475815b"><span class="section-number-4">2.4.1</span> Legge dei grandi numeri</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
Consideriamo una successione \(\{X_i, i \in \mathbb{N}_+\}\) di variabili aleatorie, Indipendenti ed Identicamente
Distribuite (I.I.D). Consideriamo poi la variabile aleatoria definita come
\[ \bar{X}_n = \frac{X_1 + \dots + X_n}{n}\]
detta <i>media aritmetica \(n\)-sima della successione</i>.
</p>

<p>
Se le variabili \(X_i\) hanno <i>valore atteso e varianza esistenti e finiti</i> \(E[X_i] = \mu\) e \(V[X_i] = \sigma^2\) allora vale
\[\bar{X}_n \overset{d}{\to} M\]
dove \(M\) è una variabile aleatoria che assume valore \(\mu\) con probabilità 1.
</p>

<p>
La proprietà appena introdotta costituisce una <i>forma debole</i> del risultato noto sotto il nome di <i>Legge dei Grandi Numeri</i>.
</p>

<p>
La <i>Legge dei Grandi Numeri</i> asserisce che:
</p>

<p>
Se consideriamo una successione di variabili aleatorie I.I.D \(\{X_i, i \in \mathbb{N}_+\}\) per cui esistono valore atteso e
varianza (finiti) allora possiamo affermare che la successione \(\{\bar{X}_n, n \in \mathbb{N}\}\) delle corrispondenti medie
aritmetiche tende, al crescere di \(n\), ad una variabile che assume certamente il valore \(E[X_i] = \mu\).
</p>

<p>
In altre parole, se consideriamo una successione \(\{x_i, i \in \mathbb{N}_+\}\) di realizzazioni delle variabili
\(\{X_i, i \in \mathbb{N}_+\}\) e se consideriamo la successione \(\{\bar{x}_n, n \in \mathbb{N}_+\}\) delle corrispondenti
realizzazioni delle medie aritmetiche, abbiamo che questa seconda successione tende, per \(n\) tendente ad infinito,
al valore \(E[X_i] = \mu\).
</p>

<p>
Per esempio, supponiamo di avere acquistato 50 appartamenti dello stesso valore commerciale e di averli successivamente
ristrutturati con l'intenzione di rivenderli ottenendone un profitto. Supponiamo di sapere che, tenuto conto della
situazione di mercato e delle eventuali contrattazioni con gli acquirenti, il ricavato della vendita di ciascuno di
questi appartamenti (milioni di lire) sia rappresentabile con una variabile \(X_i, i = 1, \dots, 50\), avente distribuzione
triangolare di supporto \([5, 15]\). Supponiamo poi che sia lecito assumere che i singoli ricavi \(X_i\), siano indipendenti
tra loro.
</p>

<p>
La Legge dei Grandi Numeri consente di affermare che la <i>media aritmetica dei ricavi</i> che otterremo per ogni appartamento,
data dalla variabile \(\bar{X}_{50}\) non si discosterà troppo dal valore atteso, della singola \(X_i\), ovvero da \(\frac{5 + 15}{2} = 10\).
Pertanto il ricavato totale dell'investimento non si discosterà troppo da \(10 \cdot 50 = 500\).
</p>

<p>
Osservazione: in realtà le ipotesi della Legge dei Grandi Numeri possono essere indebolite rispetto a quelle riportare in
precedenza. Infatti, esistono versioni alternative di questa proprietà in cui non è richiesta l'ipotesi che le variabili
\(X_i\) siano identicamente distribuite.
</p>
</div>
</div>
<div id="outline-container-org2e8a10b" class="outline-4">
<h4 id="org2e8a10b"><span class="section-number-4">2.4.2</span> Teorema Limite Centrale</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
La Legge dei Grandi Numeri assicura la convergenza \(\bar{X}_n \overset{d}{\to} M\), ma non specifica nulla circa la rapidità con
cui questa avviene. Non sappiamo dire per quale valore di \(n\) sarà lecito pensare che una realizzazione \(\bar{x}_n\) assuma
valore \(\mu\) o un valore molto prossimo ad esso.
</p>

<p>
Nell'esempio visto si asserisce infatti che il ricavo totale dell'investimento sarà prossimo a 500 milioni ma non quanto
prossimo.
</p>

<p>
È intuitivo pensare che la convergenza sia tanto più rapida quanto più la varianza sarà piccola. Quanto appena asserito
viene formalizzato tramite il <i>Teorema Limite Centrale</i>, il quale specifica quale sia la distribuzione della variabile
aleatoria \(\bar{X}_n\) per \(n\) <i>sufficientemente</i> grande e quali siano il valore atteso e la varianza della stessa.
</p>

<p>
Sia \(\{X_i, i \in \mathbb{N}_+\}\) una successione di variabili aleatorie che soddisfa le ipotesi della Legge dei Grandi
Numeri, ovvero siano le \(X_i\) I.I.D ed aventi valore atteso \(E[X_i] = \mu\) e varianza \(V[X_i] = \sigma^2\) entrambe esistenti e finiti.
</p>

<p>
Consideriamo la variabile aleatoria \(S_n\) definita come segue: \(S_n = X_1 + \dots + X_n\), vale
\[S_n \overset{d}{\to} X \sim N(n \cdot \mu, \sqrt{n} \cdot \sigma) = N(n \cdot \mu, n \cdot \sigma^2)\]
ovvero \(S_n\) converge in distribuzione ad una variabile distribuita come una Normale di media \(n \cdot \mu\) e deviazione
standard \(\sqrt{n} \cdot \sigma\).
</p>

<p>
Tale proprietà è una forma debole di un noto risultato che prende il nome di <i>Teorema Limite Centrale</i>. Osservato
che vale \(\bar{X}_n = \frac{S_n}{n}\), dalle seguenti relazioni:
\[S_n \overset{d}{\to} X \sim N(n \cdot \mu, \sqrt{n} \cdot \sigma) = N(n \cdot \mu, n \cdot \sigma^2)\]
\[E[a \cdot X + b] = a \cdot E[X] + b \quad \text{per ogni variabile $X$ e per ogni $a, b \in \mathbb{R}$}\]
si ricava
\[E[\bar{X}_n] = E\left[\frac{S_n}{n}\right] = \frac{1}{n} E[S_n] = \frac{1}{n} E[X_1 + \dots + X_n] = \frac{1}{n}(n \mu) = \mu\]
e dalle seguenti
\[S_n \overset{d}{\to} X \sim N(n \cdot \mu, \sqrt{n} \cdot \sigma) = N(n \cdot \mu, n \cdot \sigma^2)\]
\[V[a \cdot X + b] = a^2 \cdot V[X] \quad \text{per ogni variabile $X$ e per ogni $a, b \in \mathbb{R}$}\]
si ricava
\[V[\bar{X}_n] = V\left[\frac{S_n}{n}\right] = \frac{1}{n^2} V[S_n] = \frac{1}{n^2} V[X_1 + \dots + X_n] = \frac{1}{n^2}(n \sigma^2) = \frac{\sigma^2}{n}\]
</p>

<p>
Si conclude che
\[ \bar{X}_n \overset{d}{\to} X \sim N\left(\mu, \frac{\sigma}{\sqrt{n}}\right) = N \left(\mu, \frac{\sigma^2}{n}\right)\]
</p>

<p>
Praticamente il <i>Teorema Limite Centrale</i> asserisce che per \(n\) <i>sufficientemente</i> grande, possiamo approssimare le
variabili \(S_n\) e \(\bar{X}_n\) con delle variabili aventi distribuzione normale, i cui parametri dipendono da quelli
delle variabili \(X_i\). Relativamente all'espressione <i>per \(n\) sufficientemente grande</i> possiamo dire che in genere
si utilizza questa approssimazione tutte le volte che \(n \geq 30\).
</p>

<p>
Per esempio, riprendiamo in considerazione l'esempio dell'investimento immobiliare. Abbiamo visto che dobbiamo attenderci
un ricavo totale prossimo ai 500 milioni di lire. Supponiamo ora di avere pronto un preventivo delle spese da sostenere
per la ristrutturazione degli appartamenti e supponiamo che questo sia di 470 milioni di lire. Qual'è la probabilità
che il nostro ricavo sia inferiore alle spese che dobbiamo sostenere per le ristrutturazioni?
</p>

<p>
Per rispondere alla domande precedente possiamo fare ricorso al Teorema Limite Centrale. Infatti, questo teorema consente
di pensare alla variabile \(S_n\) (totale ricavi) \(S_n = X_1 + \dots + X_n\) come ad una variabile normalmente distribuita, i cui
parametri si ricavano da quelli delle variabili \(X_i\), che sono: \(E[X_i] = \frac{5 + 15}{2} = 10\) e
\(V[X_i] = \frac{(15 - 5)^2}{24} = 4.16\).
</p>

<p>
I parametri \(\mu\) e \(\sigma\) relativi alla seguente formula:
\[S_n \overset{d}{\to} X \sim N(n \cdot \mu, \sqrt{n} \cdot \sigma) = N(n \cdot \mu, n \cdot \sigma^2)\]
sono quindi rispettivamente 10 e 2.04, ed è lecito pensare che \(S_n \sim N(50 \cdot 10, \sqrt{50} \cdot 2.04) = N(500, 14.42)\).
</p>

<p>
Per rispondere alla nostra domanda basta ora osservare che
\[P(\text{spesa supera ricavato}) = P(S_n \leq 470) = P \left(\frac{S_n - 500}{14.42} \leq \frac{470 - 500}{14.42}\right) =
P(Z \leq -2.08) = P(Z \geq 2.08) = 1 - P(Z \leq 2.08)\]
</p>

<p>
Dove \(Z\) è una Normale Standardizzata.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-26_19-22-21.png" alt="screenshot_2018-04-26_19-22-21.png" />
</p>
</div>

<p>
\[P(S_n \leq 470) = 1 - P(Z \leq 2.08) = 1 - 0.98124 = 0.01876\]
</p>
</div>
</div>
</div>
<div id="outline-container-org68566c8" class="outline-3">
<h3 id="org68566c8"><span class="section-number-3">2.5</span> Stime di parametri</h3>
<div class="outline-text-3" id="text-2-5">
<p>
La <i>statistica inferenziale</i> consente di dedurre particolari caratteristiche di una popolazione limitandosi ad analizzare
un numero finito e preferibilmente piccolo di suoi individui. Quando le <i>caratteristiche</i> che si vogliono individuare sono
<i>esprimibili numericamente</i>, allora esse sono dette <i>parametri</i>.
</p>

<p>
Per <i>stima di parametri</i> si intende quindi il problema della <i>deduzione</i> di <i>caratteristiche di tipo numerico</i> di una
<i>popolazione</i> facendo ricorso per questo all'analisi di un suo sottoinsieme finito opportunamente scelto detto <i>campione</i>.
</p>

<p>
Diverse tecniche possono essere utilizzate per effettuare delle stime di parametri. Noi ci limiteremo a considerare quelle
classiche basate sulla conoscenza delle <i>distribuzioni campionarie</i>, vale a dire distribuzioni di particolari indici
statistici associati alle caratteristiche del campione. Tecniche alternative vengono comunque succintamente descritte
nel paragrafo conclusivo di questo capitolo.
</p>
</div>
<div id="outline-container-orgffe1ff6" class="outline-4">
<h4 id="orgffe1ff6"><span class="section-number-4">2.5.1</span> Campionamento e campioni</h4>
<div class="outline-text-4" id="text-2-5-1">
<p>
Diverse ragioni possono portare a voler determinare le caratteristiche di una popolazione facendo ricorso esclusivamente
ad un numero limitato di suoi individui. Può trattarsi di un problema economico o di tempo, può altresì capitare che non
tutti gli elementi della popolazione siano disponibili o ancora che le misure da effettuare "distruggano" le unità della
popolazione che vengono analizzate. In questi casi occorre allora effettuare un <i>campionamento</i>, vale a dire una scelta
degli individui che verranno analizzati per effettuare le inferenze sull'intera popolazione.
</p>

<p>
Questo è un problema che non va trascurato, infatti dal metodo utilizzato nel condurre un campionamento dipende anche
la validità della tecnica utilizzata nella fase di inferenza.
</p>

<p>
Tutte le tecniche che verranno presentate in questo capitolo sono valide solo nel caso in cui il campione sia stato scelto
secondo una procedura detta <i>campionamento casuale</i>, che assegna la stessa probabilità di essere estratto ad ogni individuo
della popolazione.
</p>

<p>
Il metodo solitamente utilizzato per generare un <i>campione casuale</i> consiste nell'assegnare, in maniera progressiva, un
numero ad ogni individuo della popolazione, e quindi estrarre, con un qualsiasi generatore casuale, tanti numeri quanti
devono essere gli elementi del campione.
</p>

<p>
Questa procedura è dispendiosa in termini di tempo, ma per contro occorre tener presente che altrimenti è facile commettere
l'errore di <i>ritenere casuale un campione che invece non lo è</i>.
</p>

<p>
Nel caso in cui la popolazione sulla quale condurre l'indagine sia costituita dagli abitanti di una città potremmo essere
portati a scegliere il campione facendo uso di un elenco telefonico o fermando a caso le persone per strada.
</p>

<p>
Così facendo non si ottiene un campione casuale:
</p>
<ul class="org-ul">
<li>Nel primo caso vengono escluse le persone che non posseggono un apparecchio telefonico;</li>
<li>Nel secondo caso le persone che raramente escono di casa hanno minore probabilità di essere parte del campione.</li>
</ul>

<p>
Un'altra considerazione che occorre sempre fare durante un'operazione di campionamento riguarda la possibilità di estrarre più
volte uno stesso individuo (campionamento con ripetizione o senza ripetizione). La scelta tra queste 2 alternative diviene
rilevante quando la popolazione considerata è di numerosità limitata e diviene trascurabile nel caso di popolazioni di
vaste dimensioni o infinite, e questo è il caso che verrà trattato d'ora in avanti.
</p>

<p>
Nel seguito introduciamo alcune definizioni e notazioni relative ai campioni casuali ed alle distribuzioni di variabili ad
essi associate.
</p>

<p>
A tale scopo denotiamo con \(X\) il carattere della popolazione su cui siamo interessati a fare dell'inferenza. Ovviamente
il valore assunto da questo carattere varia a seconda dell'individuo considerato. Pertanto conviene pensare ad \(X\) come
ad una variabile aleatoria la cui distribuzione (sconosciuta) corrisponde a quella che si otterrebbe facendo ricorso alle
tecniche della statistica descrittiva (potendo analizzare l'intera popolazione), e pensare invece ai valori assunti dai
singoli individui come a delle realizzazioni di \(X\).
</p>

<p>
Formalmente, ipotizzando di aver effettuato un <i>campionamento casuale da una popolazione di numerosità infinita</i>,
un <i>campione casuale di numerosità \(n\)</i> è una \(n\)-pla \((X_1, \dots, X_n)\) di <i>variabili aleatorie stocasticamente
indipendenti</i> aventi ognuna la <i>stessa distribuzione del carattere \(X\)</i> della popolazione.
</p>

<p>
I valori \((x_1, \dots, x_n)\) assunti da questa \(n\)-pla sono una <i>realizzazione</i> di \((X_1, \dots, X_n)\).
</p>

<p>
Per comodità abbiamo l'espressione <i>distribuzione della popolazione</i> anziché il termine più corretto <i>distribuzione
del carattere in esame della popolazione \(X\)</i>.
</p>

<p>
Un <i>parametro</i> è un <i>valore numerico che descrive una caratteristica della popolazione</i>, e come tale è una
grandezza associata alla sua distribuzione.
</p>

<p>
Una <i>stima</i> è invece una <i>misura che descrive una caratteristica del campione</i>, o meglio un'espressione funzionale
delle realizzazioni \((x_1, \dots, x_n)\) di \((X_1, \dots, X_n)\).
</p>

<p>
Per esempio, si consideri la seguente tabella:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-26_22-01-26.png" alt="screenshot_2018-04-26_22-01-26.png" />
</p>
</div>

<p>
dove i valori rappresentano i costi al metro quadro di 80 appartamenti scelti a caso tra quelli di un determinato quartiere
di una città italiana.
</p>

<p>
Possiamo pensare a tali valori come ad una realizzazione \((x_1, x_{80})\) di un campione \((X_1, \dots, X_{80})\) di numerosità \(n = 80\)
e che si riferisce alla popolazione \(X := \text{"costo al metro quadro degli appartamenti del quartiere"}\). Ovviamente
tale costo non è lo stesso per ogni appartamento, per questa ragione si pensa ad \(X\) come ad una variabile aleatoria,
la cui distribuzione \(F\) coincide con la distribuzione di frequenza cumulata che si otterrebbe se fossero noti i costi al
metro quadro di tutti gli appartamenti del quartiere.
</p>

<p>
Il costo di ogni singolo appartamento corrisponde invece ad una specifica realizzazione di \(X\). Consideriamo ora il parametro
\(\mu\) "costo medio (al metro quadro) degli appartamenti del quartiere". Ovviamente non possiamo dire quale sia il valore di
tale parametro, non avendo a disposizione i dati relativi a tutti gli appartamenti. Però possiamo farne una stima considerando
la media aritmetica dei costi degli 80 appartamenti estratti con campionamento casuale, ovvero
\[ \bar{x} = \frac{1}{80} \sum_{i=1}^{80} x_i = 2.68\]
Presumibilmente il valore vero di \(\mu\) sarà diverso da 2.68, ma questa è comunque una sua stima, sulla cui accuratezza, come
vedremo, si possono fare diversi commenti.
</p>

<p>
Si osservi che, a priori, le stime non sono altro che delle realizzazioni di variabili aleatorie definite come funzione del
campione \((X_1, \dots, X_n)\) in cui non compare alcun parametro incognito, ovvero sono del tipo \(H_n = h(X_1, \dots, X_n)\) dove \(h\)
è una funzione in \(n\) variabili.
</p>

<p>
Le variabili aleatorie definite in questo modo sono dette <i>statistiche campionarie</i> e sono dette <i>distribuzioni campionarie</i>
le loro distribuzioni.
</p>

<p>
Come vedremo, la conoscenza della distribuzione campionaria di una statistica è fondamentale nella formulazione e nella
verifica di ipotesi fatte sulla popolazione partendo dai dati campionari. Concludiamo accennando ad alcuni metodi di
campionamento alternativi al campionamento casuale.
</p>

<p>
Un metodo noto è quello detto <i>stratificato</i>, che presuppone una suddivisione preventiva della popolazione in gruppi detti
strati con caratteristiche omogenee.
</p>

<p>
Effettuata questa operazione gli individui che costituiscono il campione vengono poi estratti da ogni gruppo in
proporzione alla numerosità del gruppo stesso (<i>campionamento stratificato proporzionale</i>). Il vantaggio di tale metodo
consiste nel fatto che se i gruppi sono stati creati in maniera appropriata esso permette di ridurre la numerosità finale
del campione. A scapito di ciò però tutte le formule classiche utilizzate nella fase inferenziale devono essere di volta
in volta modificate. Inoltre, la suddivisione della popolazione in strati comporta sempre un aumento del tempo necessario
al campionamento.
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-26_22-19-08.png" alt="screenshot_2018-04-26_22-19-08.png" />
</p>
</div>

<p>
Un secondo metodo di campionamento alternativo è il <i>campionamento a grappoli</i> che prevede una fase di suddivisione della
popolazione in gruppi, in questo caso gruppi eterogenei, in modo tale che ogni singolo gruppo sia rappresentativo
dell'intera popolazione. Fatta questa operazione è sufficiente limitarsi ad estrarre un singolo gruppo quale campione,
anziché estrarre dei singoli individui da ogni gruppo. Questo metodo presenta dei vantaggi in termini di raccolta dei dati
ma risulta generalmente meno efficiente degli altri in termini di inferenze.
</p>

<p>
Tra gli altri metodi ricordiamo il <i>campionamento longitudinale</i> ed il <i>casuale doppio</i>. Nella pratica è poi uso comune
fare ricorso a più di uno di questi metodi contemporaneamente.
</p>

<p>
Ricordiamo infine che un altro problema associato al campionamento è quello della scelta della <i>numerosità del campione</i>.
I criteri da adottare per questa scelta risulteranno più chiari con le nozioni presentate nei prossimi paragrafi.
</p>
</div>
</div>
<div id="outline-container-org3775207" class="outline-4">
<h4 id="org3775207"><span class="section-number-4">2.5.2</span> Principali distribuzioni campionarie</h4>
<div class="outline-text-4" id="text-2-5-2">
<p>
In base a quanto affermato in precedenza possiamo pensare al carattere della popolazione su cui vogliamo fare delle
inferenze come ad una <i>variabile aleatoria \(X\)</i>, avente una <i>funzione di ripartizione \(F\) sconosciuta</i>, ma <i>corrispondente
alla distribuzione di frequenza cumulata di tale carattere</i>, che si potrebbe ottenere se fosse possibile analizzare
per intero la <i>popolazione</i>.
</p>

<p>
Una stima di un parametro \(F\) è costituita da una <i>funzione di una realizzazione</i> \((x_1, \dots, x_n)\) di un campione
casuale, che è una \(n\)-pla \((X_1, \dots, X_n)\) di variabili stocasticamente indipendenti ed aventi tutte distribuzione \(F\).
</p>

<p>
In pratica una <i>stima</i> è una <i>realizzazione di una statistica campionaria</i> \(H_n = h(X_1, \dots, X_n)\). Ogni statistica campionaria,
essendo una funzione di variabili aleatorie, è una variabile aleatoria, e come tale avrà una sua distribuzione.
</p>

<p>
Nel seguito prenderemo in considerazione alcune statistiche particolarmente importanti e ne descriveremo le principali
proprietà. Nel seguito denoteremo con \(\mu\) e \(\sigma^2\) il <i>valore atteso</i> e la <i>varianza</i> della <i>popolazione \(X\)</i>
(distribuita secondo \(F\) ignota).
</p>

<p>
Considerato un campione \((X_1, \dots, X_n)\) estratto da una popolazione con distribuzione \(F\), media \(\mu\) e deviazione
standard \(\sigma\), è detta <i>media campionaria \(n\)-sima</i> la variabile \(\bar{X}_n = \frac{X_1 + \dots + X_n}{n}\).
</p>

<p>
È detta poi "<i>distribuzione campionaria della media \(n\)-sima</i>" la distribuzione della variabile \(\bar{X}_n\).
</p>

<p>
È intuitivo pensare che la statistica \(\bar{X}_n\) sia appropriata per stimare la media \(\mu\) della popolazione e come
vedremo ciò è vero. In genere trovare l'espressione analitica della distribuzione campionaria di \(\bar{X}_n\)
conoscendo la distribuzione \(F\) di \(X\) non è facile. È però facile determinare il <i>valore atteso</i> e la <i>varianza</i> di
\(\bar{X}_n\).
</p>

<p>
Ricordando che si assume indipendenza tra le variabili \(X_1, \dots, X_n\) del campione e che queste hanno tutte <i>valore atteso</i>
uguale a \(\mu\) e <i>varianza</i> uguale a \(\sigma^2\). Allora in base alla seguente proprietà:
\[E[a \cdot X + b \cdot Y] = a \cdot E[X] + b \cdot E[Y] \text{ per ogni coppia $X, Y$ e per ogni $a, b, \in \mathbb{R}$}\]
otterremo
\[E[\bar{X}_n] = E\left[\frac{X_1 + \dots + X_n}{n}\right] = \frac{1}{n} E[X_1 + \dots + X_n] = \frac{1}{n}(E[X_1] + \dots + E[X_n]) =
\frac{1}{n}(n \mu) = \mu\]
Mentre, in base alle seguenti proprietà:
\[V[a \cdot X + b] = a^2 \cdot V[X] \quad \text{per ogni variabile $X$ e per ogni $a, b \in \mathbb{R}$}\]
otterremo
\[V[\bar{X}_n] = V\left[\frac{S_n}{n}\right] = \frac{1}{n^2} V[S_n] = \frac{1}{n^2} V[X_1 + \dots + X_n] = \frac{1}{n^2}(n \sigma^2) = \frac{\sigma^2}{n}\]
Osserviamo che mentre il valore atteso di \(\bar{X}_n\) non dipende dalla numerosità del campione \(n\), la sua varianza dipende
anche da \(n\) ed è tanto minore quanto \(n\) è più grande. Questo vuol dire che le realizzazioni di \(\bar{x}_n\) di \(\bar{X}_n\)
saranno tanto più vicine al valore incognito \(\mu\) quanto più è grande la numerosità del campione.
</p>

<p>
Inoltre abbiamo visto in precedenza che per \(n\) sufficientemente grande la variabile \(\bar{X}_n\) può essere approssimata
con una variabile avente distribuzione normale di parametri \(\mu\) e \(\frac{\sigma^2}{n}\) e ciò indipendentemente dall'espressione
della distribuzione \(F\).
</p>

<p>
Una considerazione particolare va fatta nel caso in cui al distribuzione della popolazione
sia già normale in partenza. In questo caso, per la proprietà di chiusura rispetto all'operazione di somma di variabili
aleatorie con distribuzione normale, la media campionaria \(\bar{X}_n\) è anch'essa una variabile con distribuzione
normale ovvero vale \(\bar{X}_n \sim N\left(\mu, \frac{\sigma^2}{n}\right)\).
</p>

<p>
La seconda statistica che viene introdotta è solitamente usata per stimare la varianza della popolazione.
</p>

<p>
Considerato un campione \((X_1, \dots, X_n)\) estratto da una popolazione con distribuzione \(F\), media \(\mu\) e deviazione standard
\(\sigma\) detta <i>varianza campionaria \(n\)-sima</i> la variabile:
\[S_n^2 = \frac{1}{n} \cdot \sum_{i=1}^n (X_i - \bar{X}_n)^2\]
È detta poi "<i>distribuzione campionaria della varianza \(n\)-sima</i>" la distribuzione della variabile \(S_n^2\).
</p>

<p>
Come nel caso precedente, trovare l'espressione analitica della distribuzione di \(S_n^2\) conoscendo \(F\) non è facile.
È però un po' più facile determinare il valore atteso e la varianza di \(S_n^2\). Infatti, è possibile dimostrare che valogno
le seguenti relazioni:
</p>
\begin{gather*}
E[S_n^2] = \frac{n-1}{n} \cdot \sigma^2\\
V[S_n^2] = \frac{1}{n}\left(E[(X - \mu)^4] - \frac{n-3}{n-1} \cdot \sigma^4 \right)
\end{gather*}
<p>
Anche per questa statistica è possibile dimostrare, facendo ricorso al Teorema Limite Centrale, che per \(n\) sufficientemente
grande la sua distribuzione può essere approssimata con una normale con parametri dati dalle formule precedenti.
</p>

<p>
Notiamo che la presenza del coefficiente \(\frac{n-1}{n}\) può talvolta risultare scomoda e, per tale ragione, in molti processi
inferenziali si preferisce considerare alternativamente alla varianza campionaria, una nuova statistica detta
<i>varianza campionaria \(n\)-sima corretta</i>:
</p>
\begin{gather*}
E[S_n^2] = \sigma^2\\
\hat{S}_n^2 = \frac{n}{n-1} \cdot S_n^2 = \frac{1}{n-1} \sum_{i=1}^n (X_i - \bar{X}_n)^2
\end{gather*}

<p>
Nel caso particolare in cui la popolazione sia normalmente distribuita si possono dimostrare due importanti risultati che
coinvolgono la statistica \(S_n^2\). A tale scopo è utile introdurre due nuove variabili aleatorie:
</p>
\begin{gather*}
Q_n = \frac{n \cdot S_n^2}{\sigma^2} = \frac{(n-1) \cdot \hat{S}_n^2}{\sigma^2}\\
T_n = \frac{\bar{X}_n - \mu}{\frac{\hat{S}_n}{\sqrt{n}}}
\end{gather*}
<p>
dove \(\hat{S}_n = \sqrt{\hat{S}_n^2}\).
</p>

<p>
Le due quantità appena introdotte <i>nono vengono dette statistiche</i> in quanto esse sono funzioni anche dei parametri \(\mu\) e \(\sigma^2\),
che vanno pensati come non noti.
</p>

<p>
Si può dimostrare che nell'ipotesi in cui \((X_1, \dots, X_n)\) sia un campione casuale estratto da una popolazione con distribuzione
Normale con parametri \(\mu\) e \(\sigma^2\), allora:
</p>
<ul class="org-ul">
<li>\(Q_n\) è distribuito come una <i>Chi-quadro</i>: \(Q_n = \frac{n \cdot S_n^2}{\sigma^2} = \frac{(n-1) \cdot \hat{S}_n^2}{\sigma^2} \sim \chi_{n-1}^2\);</li>
<li>\(T_n\) è distribuito coma una <i>t di Student</i>: \(T_n = \frac{\bar{X}_n - \mu}{\frac{\hat{S}_n}{\sqrt{n}}} \sim t_{n-1}\).</li>
</ul>
<p>
Entrambe con \((n-1)\) gradi di libertà.
</p>

<p>
Si osservi che le distribuzioni delle quantità \(Q_n\) e \(T_n\) non dipendono dai parametri \(\mu\) e \(\sigma^2\) poiché la Chi-quadro
e la t di Student hanno i gradi di libertà \((n-1)\) quale unico parametro.
</p>
</div>
</div>
<div id="outline-container-org1eb0707" class="outline-4">
<h4 id="org1eb0707"><span class="section-number-4">2.5.3</span> Stimatori e stime puntuali</h4>
<div class="outline-text-4" id="text-2-5-3">
<p>
Sia \(\theta\) un parametro incognito della popolazione \(X\). Una statistica campionaria \(H_n = h(X_1, \dots, X_n)\) è detta
<i>stimatore puntuale</i> quando viene utilizzata per stimare il parametro incognito \(\theta\).
</p>

<p>
È detta invece <i>stima puntuale</i> del parametro \(\theta\), il valore \(\hat{\theta}(x_1, \dots, x_n)\) assunto dallo stimatore puntuale
\(H_n = h(X_1, \dots, X_n)\) nella realizzazione \(x_1, \dots, x_n\) del campione casuale.
</p>

<p>
Vi sono due proprietà minime di cui una statistica campionaria deve godere affinché possa essere considerata uno stimatore
puntuale, queste sono:
</p>
<ul class="org-ul">
<li><i>Proprietà di correttezza</i>: uno <i>stimatore</i> \(H_n = h(X_1, \dots, X_n)\) del parametro \(\theta\) è detto <i>corretto</i> (<i>non distorto</i>),
se, qualunque sia l'effettivo valore del parametro \(\theta\) risulta \(E[H_n] = E[h(X_1, \dots, X_n)] = \theta\);</li>
<li><i>Proprietà di consistenza</i>: uno <i>stimatore</i> \(H_n = h(X_1, \dots, X_n)\) del parametro \(\theta\) è detto <i>consistente</i> se, qualunque
sia l'effettivo valore del parametro \(\theta\) risulta \(\lim_{n \to \infty} P[|H_n - \theta| \leq \epsilon] = 1\) per ogni \(\epsilon > 0\).</li>
</ul>

<p>
Talvolta è difficile verificare se uno stimatore è consistente. Comunque, è possibile dimostrare che uno stimatore corretto 
è anche consistente se vale \(\lim_{n \to \infty} V[H_n] = 0\).
</p>

<p>
Per esempio, consideriamo le due statistiche campionarie \(\bar{X}_n\) e \(\hat{S}_n^2\), stimatori puntuali dei parametri \(\mu\) e \(\sigma^2\)
della popolazione. Questi sono stimatori corretti, essendo:
\[E[\bar{X}_n] = \mu \quad E[\hat{S}_n^2] = \sigma^2\]
Inoltre, sono anche consistenti, infatti valgono
</p>
\begin{gather*}
\lim_{n \to \infty} V[\bar{X}_n] = \lim_{n \to \infty} \frac{\sigma^2}{n} = 0\\
\lim_{n \to \infty} V[\hat{S}_n^2] = \lim_{n \to \infty} \frac{n}{(n-1)^2} \left(E\left[(X - \mu)^4 \right] - \frac{n-3}{n-1} \sigma^4 \right) = 0\\
\hat{S}_n^2 = \frac{n}{n-1} \cdot S_n^2\\
V[\hat{S}_n^2] = V\left[\frac{n}{n-1} \cdot S_n^2 \right] = \frac{n^2}{(n-1)^2} V[S_n^2]\\
V[S_n^2] = \frac{1}{n} \left( E \left[(X - \mu)^4 \right] - \frac{n-3}{n-1} \sigma^4 \right)
\end{gather*}

<p>
Osservazione: in base a quanto appena affermato la <i>varianza campionaria corretta</i> \(\hat{S}_n^2\) è uno <i>stimatore corretto</i>
di \(\sigma^2\). Occorre però fare attenzione che contrariamente a quanto si è portati a pensare, la sua radice
\(\hat{S}_n = \sqrt{\hat{S}_n^2}\) non è uno stimatore corretto della deviazione standard \(\sigma\) della popolazione:
\[E[\hat{S}_n] \neq \sigma\]
Proprio per tale ragione, nelle analisi statistiche troviamo sempre riportare le stime delle varianze anziché quelle delle
deviazioni standard.
</p>

<p>
Osserviamo che per stimare un generico parametro \(\theta\) possono essere definiti diversi stimatori. In molti casi è possibile
stabilire un criterio per dire se uno stimatore è preferibile ad un altro.
</p>

<p>
Siano per questo \(H_{1, n} = h_1 (X_1, \dots, X_n)\) e \(H_{2, n} = h_2 (X_1, \dots, X_n)\) due diversi stimatori, entrambi corretti, per un unico
parametro \(\theta\). Diremo che lo stimatore \(H_{1, n}\) è più efficiente di \(H_{2, n}\) se vale \(V[H_{1, n}] \leq V[H_{2, n}]\) per ogni
numerosità del campione \(n\) e per ogni effettivo valore del parametro \(\theta\) da stimare.
</p>

<p>
Per esempio, consideriamo i seguenti stimatori della media \(\mu\) di una popolazione:
\[H_{1, n} = \bar{X}_n = \frac{X_1 + \dots + X_n}{n} \quad \quad \quad H_{2, n} = \frac{X_1}{2} + \frac{X_2 + \dots + X_n}{2(n-1)}\]
Il secondo stimatore (definibile solo per \(n\) maggiore di 1) è in pratica una variazione del primo e dà maggior 
importanza alla prima componente del campione a cui è assegnato un peso di \(\frac{1}{2}\) anziché \(\frac{1}{2(n-1)}\)
come avviene per le restanti componenti.
</p>

<p>
Come mostrato nell'esempio precedente, lo stiamtore \(H_{1, n}\) è corretto e lo stesso vale anche per \(H_{2, n}\), infatti:
\[E[H_{2, n}] = E\left[\frac{X_1}{2}\right] + E \left[\frac{X_2 + \dots + X_n}{2(n-1)}\right] = \frac{1}{2} E[X_1] + \frac{1}{2(n-1)} E[X_2 + \dots + X_n]
= \left[\frac{1}{2} + \frac{n - 1}{2(n-1)}\right] E[X] = E[X] = \mu\]
Osserviamo poi che vale
\[V[H_{2, n}] = V \left[\frac{X_1}{2} \right] + V \left[\frac{X_2 + \dots + X_n}{2(n-1)}\right] = \frac{1}{4}V[X_1] + \frac{1}{4(n-1)^2}
V[X_2 + \dots + X_n] = \frac{1}{4}V[X] + \frac{n-1}{4(n-1)^2} V[X] = \left[\frac{1}{4} + \frac{1}{4(n-1)}\right] \sigma^2\]
</p>

<p>
Ricordando che \(V[H_{1, n}] = \frac{\sigma^2}{n}\), con pochi calcoli non è difficile verificare che \(V[H_{1, n} \leq V[H_{2, n}]]\) per
ogni \(n\) maggiore o uguale a 2. Pertanto lo stimatore \(H_{1, n}\) è più efficiente di \(H_{2, n}\) e per questa ragione è preferibile.
</p>

<p>
Lo stimatore \(H_{2, n}\) non è neanche consistente, infatti risulta
\(V[H_{2, n}]= \left[\frac{1}{4} + \frac{1}{4(n-1)}\right] \sigma^2 \geq \frac{1}{4} \sigma^2 > 0\), e quindi la sua varianza
non può tendere a 0 per \(n\) che tende ad infinito.
</p>

<p>
In particolare, uno stimatore di un parametro \(\theta\) è detto <i>miglior stimatore</i> se è più efficiente di ogni altro stimatore
corretto e consistente.
</p>

<p>
Abbiamo già visto che la media e la varianza campionaria corretta \(\bar{X}_n\) e \(\hat{S}_n^2\) sono 2 stimatori corretti e
consistenti dei parametri \(\mu\) e \(\sigma^2\). Per questi 2 stimatori in realtà è possibile dimostrare qualche cosa in più, ovvero
che essi sono i <i>migliori stimatori</i> per media e varianza della popolazione.
</p>

<p>
Per esempio, riprendiamo in considerazione la seguente tabella:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-26_22-01-26.png" alt="screenshot_2018-04-26_22-01-26.png" />
</p>
</div>

<p>
Se pensiamo a questi 80 costi come alla realizzazione di un campione \((X_1, \dots, X_{80})\) estratto dalla popolazione
\(X := "\text{costo al metro quadro degli appartamenti del quartiere}"\), possiamo fornire una stima della media e della
varianza di \(X\) per mezzo della media e della varianza campionaria corretta, le cui realizzazioni risultano
</p>
\begin{gather*}
\bar{x}_{80} = \frac{x_1 + \dots + x_{80}}{80} = 2.68\\
\hat{s}_{80}^2 = \frac{1}{79} \sum_{i=1}^{80} (x_i -\bar{x}_{80}) = 1.49
\end{gather*}
<p>
I due valori ottenuti sono le stime dei 2 parametri.
</p>
</div>
</div>
<div id="outline-container-org8103643" class="outline-4">
<h4 id="org8103643"><span class="section-number-4">2.5.4</span> Stime intervallari</h4>
<div class="outline-text-4" id="text-2-5-4">
<p>
Abbiamo visto come trovare un valore approssimato di un parametro incognito della popolazione per mezzo di una stima puntuale.
Tali stime però non forniscono informazioni sul grado di approssimazione delle stesse. Per questo motivo alle stime
puntuali vengono preferite, quando possibile determinarle, le stime intervallari che sono stime espresse sotto forma di
intervalli (<i>intervalli fiduciari</i>) all'interno dei quali, con buona probabilità, si trova il valore vero del parametro da
stimare.
</p>

<p>
Pensiamo ad uno stimatore puntuale \(H_n\) di un parametro \(\theta\) e sia \(\hat{\theta} = h_n (x_1, \dots, x_n)\) una sua realizzazione.
</p>

<p>
Molto difficilmente il valore del parametro \(\theta\) di cui \(H_n\) è stimatore corrisponderà alla realizzazione sopra riportata.
Pensiamo allora ad un intervallo \(I = [\hat{\theta} - e_1, \hat{\theta} + e_2] \subseteq \mathbb{R}\). Un intervallo di questo tipo
conterrà il reale valore di \(\theta\) con maggiore o minore probabilità a seconda della sua ampiezza, vale a dire a seconda dei
valori di \(e_1\) e di \(e_2\).
</p>

<p>
Quando sia nota la distribuzione campionaria dello stimatore \(H_n\) è possibile calcolare esattamente tali probabilità al variare
di \(e_1\) e di \(e_2\). In altre parole è possibile, dato \(\alpha \in [0, 1] \subseteq \mathbb{R}\), determinare dei corrispondenti valori
di \(e_1\) e di \(e_2\) tali che risulti \(P(\theta \in [\hat{\theta} - e_1, \hat{\theta} + e_2]) = 1 - \alpha\), dove \(\hat{\theta}\) è una realizzazione
dello stimatore \(H_n\).
</p>

<p>
In questo caso il valore \(\alpha\) è detto <i>livello di confidenza</i> della stima ed il corrispondente intervallo è detto
<i>intervallo di confidenza</i>.
</p>

<p>
I valori solitamente utilizzati come livello di fiducia (confidenza) \(\alpha\) sono 0.1, 0.05 e 0.01.
</p>

<p>
Vedremo qui come si costruiscono degli intervalli di confidenza per la media di una popolazione. Nel farlo distingueremo
tra il caso in cui la popolazione non sia normalmente distribuita ed il caso in cui la popolazione sia normalmente
distribuita.
</p>

<p>
Suddividiamo il problema della determinazione di un intervallo di confidenza per il valor medio \(\mu\) in 4 sottocasi a
seconda che la popolazione sia o non sia normalmente distribuita e che la varianza sia o non sia nota.
</p>
</div>

<ol class="org-ol">
<li><a id="orgeabc8a8"></a><i>Popolazione non normalmente distribuita e varianza \(\sigma^2\) nota</i><br />
<div class="outline-text-5" id="text-2-5-4-1">
<p>
In questo caso la media campionaria \(\bar{X}_n = \frac{X_1 + \dots + X_n}{n}\) è approssimabile per \(n \geq 30\), tramite una variabile
con distribuzione normale di media \(\mu\) e deviazione standard \(\frac{\sigma}{\sqrt{n}}\).
</p>

<p>
Pensiamo allora a \(\bar{X}_n \sim N \left(\mu, \frac{\sigma}{\sqrt{n}}\right)\), dove l'unico parametro incognito è \(\mu\).
</p>

<p>
Normalizzando abbiamo quanto segue: \(Z = \frac{\bar{X}_n - \mu}{\frac{\sigma}{\sqrt{n}}} \sim N(0, 1)\).
</p>

<p>
I valori assunti dalla variabile \(Z\) così definita dipenderanno ovviamente dalle realizzazioni di \(\bar{X}_n\) e
quindi dalle realizzazioni del campione \((X_1, \dots, X_n)\)
</p>

<p>
Nonostante ciò, in base alla relazione \(Z = \frac{\bar{X}_n - \mu}{\frac{\sigma}{\sqrt{n}}} \sim N(0, 1)\), siamo in grado di
determinare un valore \(z_{1 - \frac{\alpha}{2}}\) per cui valga la seguente relazione
\(P\left(Z \in \left[-z_{1 - \frac{\alpha}{2}} , z_{1-\frac{\alpha}{2}}\right]\right) = 1 - \alpha\)
e quindi anche
\(P \left(\mu - z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}} \leq \bar{X}_n \leq \mu + z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\right) = 1 - \alpha\).
</p>

<p>
Pertanto, in base all'ultima relazione sappiamo che con probabilità \(1 - \alpha\) lo stimatore \(\bar{X}_n\) assume valori in
un ben definito intervallo, ma ancora dipendente da \(\mu\). A questo punto è possibile scrivere
\[P \left(\bar{X}_n - z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}} \leq \mu \leq \bar{X}_n + z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\right) = 1 - \alpha\]
</p>

<p>
Pertanto, in base all'ultima relazione, possiamo dire che data una realizzazione \(\bar{x}_n\) di \(\bar{X}_n\), il
parametro incognito \(\mu\) è compreso nell'intervallo
\(P \left(\bar{x}_n - z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}, \bar{x}_n + z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\right)\)
con probabilità \((1 - \alpha)\). Pertanto questo è proprio l'intervallo di confidenza cercato.
</p>

<p>
Occorre fare ancora 2 considerazioni.
</p>

<p>
La prima è che quello così ricavato non è l'unico intervallo di confidenza
ottenibile per il livello di fiducia \(\alpha\). Esso è quello chiamato <i>simmetrico</i> in cui i 2 estremi sono pensati alla stessa distanza
dalla realizzazione \(\bar{x}_n\). Avremmo però potuto scegliere anche diversi valori di \(z_1\) e \(z_2\) per cui
\(P(Z \in [-z_1, +z_2]) = 1 - \alpha\). Da questa espressione, ragionando come sopra, saremmo poi arrivati ad ottenere un intervallo di
fiducia alternativo, ovvero:
\(P \left(\bar{x}_n - z_1 \frac{\sigma}{\sqrt{n}}, \bar{x}_n + z_2 \frac{\sigma}{\sqrt{n}}\right)\)
</p>

<p>
Una seconda considerazione è che occorre sempre ricordare che questo metodo è applicabile quando la numerosità del campione è
sufficientemente grande. In generale lo si applica quando \(n\) è maggiore o uguale a 30, anche se è ammissibile applicarlo
anche per valori più piccoli (\(n = 10\)) nel caso in cui si sappia che la distribuzione della popolazione non si discosta molto da
una normale o almeno è simmetrica rispetto al suo valor medio.
</p>
</div>
</li>

<li><a id="orgace4217"></a><i>Popolazione non normalmente distribuita e varianza \(\sigma^2\) non nota</i><br />
<div class="outline-text-5" id="text-2-5-4-2">
<p>
In questo caso si ragiona analogamente a quanto sopra, andando però a sostituire al valore \(\sigma\) la sua stima \(\hat{s}_n\)
ottenuta come realizzazione della statistica \(\hat{S}_n = \sqrt{\hat{S}_n^2}\), dove \(\hat{S}_n^2\) è la varianza campionaria
corretta definita precedentemente. Si può mostrare infatti che per \(n\) sufficientemente grande, anche la variabile
\(Z = \frac{\bar{X}_n - \mu}{\frac{\sigma}{\sqrt{n}}}\) risulta essere approssimativamente una normale standardizzata.
</p>

<p>
Pertanto per \(n \geq 30\), quando non è nota la varianza della popolazione, è possibile definire un intervallo di confidenza
per la media \(\mu\):
\[P \left(\bar{X}_n - z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}} \leq \mu \leq \bar{X}_n + z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\right) = 1 - \alpha\]
</p>

<p>
Per esempio, riprendiamo nuovamente in considerazione la tabella
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-26_22-01-26.png" alt="screenshot_2018-04-26_22-01-26.png" />
</p>
</div>

<p>
e supponiamo di voler determinare un intervallo di confidenza per la media della popolazione richiedendo un livello di fiducia
\(\alpha = 0.05\). Poiché nel nostro caso la varianza della popolazione non è nota, avremo
\[\left[\bar{X}_{80} - z_{1-\frac{0.05}{2}} \frac{\hat{S}_{80}}{\sqrt{80}} \leq \mu \leq \bar{X}_{80} + z_{1-\frac{0.05}{2}}
\frac{\hat{S}_{80}}{\sqrt{80}}\right] \subseteq \mathbb{R}\]
L'intervallo ottenuto è \(I = [2.41, 2.94]\) e con probabilità \((1 - 0.05) = 0.95\) contiene il valore effettivo della media \(\mu\).
</p>

<p>
Per lo stesso livello di fiducia avremmo potuto scegliere un diverso intervallo di confidenza. Supponiamo ad esempio di
essere interessati a determinare una limitazione superiore per il parametro \(\mu\) e sempre con livello di fiducia \(\alpha = 0.05\).
In questo caso occorre determinare il valore \(z_{1-\alpha}\) tale che \(P(Z \in [-\infty, +z_{1-\alpha}]) = 1 - \alpha\).
</p>

<p>
A questo punto osserviamo che dall'uguaglianza precedente si ottiene:
</p>
\begin{align*}
&P \left(\bar{X}_{80} - \infty \frac{\hat{S}_{80}}{\sqrt{80}} \leq \mu \leq \hat{X}_{80} + z_{1 - \alpha} \frac{\hat{S}_{80}}{\sqrt{80}}\right) =\\
&= P\left(-\infty \leq \mu \leq \hat{X}_{80} + z_{1 - \alpha} \frac{\hat{S}_{80}}{\sqrt{80}}\right) =\\
&= 1 - \alpha
\end{align*}

<p>
Il valore di \(z_{1-\alpha}\) si ricava facilmente dalle tavole della distribuzione normale come il quantile che lascia alla sua
destra un'area uguale a 0.05 e risulta \(z_{1 - \alpha} = 1.65\) per cui l'intervallo desiderato è \((- \infty, 2.90)\). In definitiva
è possibile affermare che il parametro \(\mu\) è minore di 2.90 con probabilità 0.95.
</p>
</div>
</li>

<li><a id="org2b13603"></a><i>Popolazione normalmente distribuita e varianza \(\sigma^2\) nota</i><br />
<div class="outline-text-5" id="text-2-5-4-3">
<p>
In questo caso sappiamo che la media campionaria \(\bar{X}_n = \frac{X_1 + \dots + X_n}{n}\) è ancora una variabile con distribuzione
normale di media \(\mu\) e deviazione standard \(\frac{\sigma}{\sqrt{n}}\).
</p>

<p>
Possiamo ragionare esattamente come per il caso di popolazione non normalmente distribuita e varianza nota con l'unica differenza
che ora non viene fatta alcuna richiesta sulla numerosità del campione. Si può pertanto continuare ad utilizzare la formula:
\[P \left(\bar{X}_n - z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}} \leq \mu \leq \bar{X}_n + z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\right) = 1 - \alpha\]
</p>
</div>
</li>
<li><a id="orgf596b5f"></a><i>Popolazione normalmente distribuita e varianza \(\sigma^2\) non nota</i><br />
<div class="outline-text-5" id="text-2-5-4-4">
<p>
La variabile di cui si fa uso in questo caso è \(T_n = \frac{\bar{X}_n - \mu}{\frac{\hat{S}_n}{\sqrt{n}}}\),
che per quanto detto in precedenza è distribuita secondo una t di Student con \((n-1)\) gradi di libertà.
</p>

<p>
Facendo uso delle tavole della t di Student è possibile determinare un valore \(t_{1-\frac{\alpha}{2}}\) per cui valga
\(P \left(T_n \in \left[-t_{1-\frac{\alpha}{2}, n-1}, t_{1-\frac{\alpha}{2}, n-1}\right]\right) = 1 - \alpha\)
e quindi anche
\(P\left(-t_{1-\frac{\alpha}{2}} \frac{\hat{S}_n}{\sqrt{n}} \leq \bar{X}_n - \mu \leq t_{1-\frac{\alpha}{2}} \frac{\hat{S}_n}{\sqrt{n}}\right) = 1 - \alpha\)
</p>

<p>
A questo punto la precedente diseguaglianza può essere riscritta come
\[P\left(\bar{X}_n-t_{1-\frac{\alpha}{2}} \frac{\hat{S}_n}{\sqrt{n}} \leq \mu \leq \bar{X}_n + t_{1-\frac{\alpha}{2}} \frac{\hat{S}_n}{\sqrt{n}}\right) = 1 - \alpha\]
</p>

<p>
Ciò significa che date le realizzazioni \(\bar{x}_n\) di \(\bar{X}_n\) ed \(\hat{s}_n\) di \(\hat{S}_n\), il parametro incognito \(\mu\)
è compreso nell'intervallo
\[\left[\bar{x}_n - t_{1-\frac{\alpha}{2}} \frac{\hat{s}_n}{\sqrt{n}}, \bar{x}_n + t_{1-\frac{\alpha}{2}} \frac{\hat{s}_n}{\sqrt{n}}\right]\]
con probabilità \((1 - \alpha)\).
Pertanto \(\bar{x}_n - t_{1-\frac{\alpha}{2}} \frac{\hat{s}_n}{\sqrt{n}}, \bar{x}_n + t_{1-\frac{\alpha}{2}} \frac{\hat{s}_n}{\sqrt{n}}\)
è l'intervallo di confidenza cercato.
</p>

<p>
Anche in questo caso è necessario precisare che questo intervallo non è l'unico ricavabile per il dato livello di fiducia.
</p>

<p>
Questo intervallo è <i>simmetrico</i>, ovvero i 2 estremi sono pensati alla stessa distanza dalla realizzazione \(\bar{x}_n\).
Avremmo però potuto scegliere anche valori diversi di \(t_1\) e \(t_2\) per cui \(P(T_n \in [-t_1, t_2]) = 1 - \alpha\) da cui si ottiene
un intervallo di fiducia alternativo \(\left[\bar{x}_n - t_1 \frac{\hat{s}_n}{\sqrt{n}}, \bar{x}_n + t_2 \frac{\hat{s}_n}{\sqrt{n}}\right]\)
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-orga299535" class="outline-4">
<h4 id="orga299535"><span class="section-number-4">2.5.5</span> Intervalli di Confidenza per la Varianza</h4>
<div class="outline-text-4" id="text-2-5-5">
<p>
Vediamo ora come determinare un intervallo di confidenza per la varianza \(\sigma^2\) della popolazione. Purtroppo non possiamo dire
nulla quando la popolazione non è normalmente distribuita. È vero che la distribuzione campionaria della statistica \(S_n^2\)
per \(n\) sufficientemente grande può essere approssimata da una normale. Purtroppo però l'espressione
\(V[S_n^2] = \frac{1}{n} \left(E[(X - \mu)^4] - \frac{n-3}{n-1} \cdot \sigma^4 \right)\) della varianza di tale statistica non consente di far
uso di questa proprietà.
</p>

<p>
Possiamo invece definire un intervallo fiduciario per \(\sigma^2\) quando la popolazione da cui è stato estratto il campione è
normalmente distribuita facendo uso del fatto che in tale caso la variabile \(Q_n = \frac{(n-1) \cdot \hat{S}_n^2}{\sigma^2}\) è
distribuita secondo una Chi-Quadro con \((n-1)\) gradi di libertà.
</p>

<p>
Utilizzando le tavole della distribuzione Chi-Quadro, è possibile determinare almeno 2 valori \(q_1\) e \(q_2\) per i quali vale
\(P(Q_n \in [q_1, q_2]) = 1 - \alpha\) e quindi \(P\left(q_1 \leq \frac{(n-1) \cdot \hat{S}_n^2}{\sigma^2} \leq q_2 \right) = 1 - \alpha\).
</p>

<p>
Risolvendo la diseguaglianza rispetto al parametro incognito \(\sigma^2\):
\[P \left(\frac{(n-1) \cdot \hat{S}_n^2}{q_2} \leq \sigma^2 \leq \frac{(n-1) \cdot \hat{S}_n^2}{q_1}\right) = 1 - \alpha\]
Ciò significa che date le realizzazioni \(\hat{s}_n^2\) di \(\hat{S}_n^2\), il parametro incognito \(\sigma^2\) è compreso nell'intervallo
\[\left[\frac{(n-1) \cdot \hat{s}_n^2}{q_2}, \frac{(n-1) \cdot \hat{s}_n}{q_1}\right]\]
con probabilità \((1 - \alpha)\) e pertanto questo è l'intervallo di confidenza cercato.
</p>

<p>
Anche in questo caso occorre sengnalare che quello definito tramite
\[P \left(\frac{(n-1) \cdot \hat{S}_n^2}{q_2} \leq \sigma^2 \leq \frac{(n-1) \cdot \hat{S}_n^2}{q_1}\right) = 1 - \alpha\]
non è l'unico intervallo di confidenza ottenibile per il livello \(\alpha\) in quanto è possibile scegliere più coppie di valori
\(q_1\) e \(q_2\). Solitamente viene utilizzata la coppia \(q_{\frac{\alpha}{2}} \quad q_{1-\frac{\alpha}{2}}\), costituita dai 2 quantili
\(\frac{\alpha}{2}\) e \(1 - \frac{\alpha}{2}\) della distribuzione Chi-Quadro con \((n-1)\) gradi di libertà.
</p>

<p>
Per esempio, riprendiamo in considerazione i carichi a rottura delle travi di cemento dati dalla seguente tabella:
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-27_17-36-57.png" alt="screenshot_2018-04-27_17-36-57.png" />
</p>
</div>

<p>
E sotto l'ipotesi di distribuzione normale si voglia determinare un intervallo di confidenza per la varianza con livello
di fiducia \(\alpha = 0.01\). Occorre allora far ricorso alla seguente formula:
\[P \left(\frac{(n-1) \cdot \hat{S}_n^2}{q_2} \leq \sigma^2 \leq \frac{(n-1) \cdot \hat{S}_n^2}{q_1}\right) = 1 - \alpha\]
scegliendo 2 opportuni valori \(q_1\) e \(q_2\).
</p>

<p>
Potremmo prendere ad esempio i 2 quantili della Chi-Quadro con 14 gradi di libertà che lasciano rispettivamente un'area
uguale a 0.005 alla loro sinistra ed alla loro destra. Consultando le tavole della Chi-Quadro si vede che i 2 quantili
cercati sono \(q_{\sqrt{0.01}{2}} = 4.07 \quad q_{1-\frac{0.01}{2}} = 31.3\).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-27_17-42-20.png" alt="screenshot_2018-04-27_17-42-20.png" />
</p>
</div>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-27_17-41-35.png" alt="screenshot_2018-04-27_17-41-35.png" />
</p>
</div>

<p>
Inoltre la realizzazione \(\hat{s}_{15}^2\) di \(\hat{S}_{15}^2\) è \(\hat{s}_{15}^2 = 48266\).
</p>

<p>
L'intervallo di confidenza cercato è \(I = \left[\frac{14 \cdot 48266}{31.3}, \frac{14 \cdot 48266}{4.07}\right] = [21588, 166025]\).
</p>

<p>
Ancora una volta avremmo potuto scegliere un intervallo diverso per lo stesso livello di confidenza, ad esempio prendendo
i quantili \(q_1 = 0\) e \(q_2 = 29.1\), ottenendo \(P(q_1 \leq Q_{15} \leq q_2) = 0.99\) quando \(Q_{15} \sim \chi_{14}^2\). Ragionando come sopra si ricava
l'intervallo fiduciario \(I = \left[\frac{14 \cdot \hat{s}_{15}^2}{q_2}, \frac{14 \cdot \hat{s}_{15}^2}{q_1}\right] = [23220, \infty]\).
</p>


<div class="figure">
<p><img src="Lezioni/screenshot_2018-04-27_17-47-55.png" alt="screenshot_2018-04-27_17-47-55.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org711d164" class="outline-4">
<h4 id="org711d164"><span class="section-number-4">2.5.6</span> Considerazioni sulla Numerosità del Campione</h4>
<div class="outline-text-4" id="text-2-5-6">
<p>
In base alle formule:
\[P\left(\bar{X}_n-z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}} \leq \mu \leq \bar{X}_n + z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\right) = 1 - \alpha\]
\[P\left(\bar{X}_n-t_{1-\frac{\alpha}{2}} \frac{\hat{S}_n}{\sqrt{n}} \leq \mu \leq \bar{X}_n + t_{1-\frac{\alpha}{2}} \frac{\hat{S}_n}{\sqrt{n}}\right) = 1 - \alpha\]
appare evidente che mantenendo fisso il livello di confidenza \(\alpha\), l'ampiezza dell'intervallo si riduce al crescere di \(n\).
</p>

<p>
Questo accade anche nel caso della stima di \(\sigma^2\) per popolazioni normalmente distribuite anche se non è evidente dalla formula
\[P \left(\frac{(n-1) \cdot \hat{S}_n^2}{q_2} \leq \sigma^2 \leq \frac{(n-1) \cdot \hat{S}_n^2}{q_1}\right) = 1 - \alpha\]
poiché il restringimento dell'intervallo di fiducia segue dalla variazione dei gradi di libertà della Chi-Quadro con cui è
distribuita la statistica \(Q_n\).
</p>

<p>
Volendo, nella definizione di un intervallo di confidenza per il valor medio è possibile decidere in anticipo l'ampiezza
dell'intervallo e quindi fissare di conseguenza la numerosità del campione come mostrato nell'esempio seguente.
</p>

<p>
Per esempio, riprendiamo in considerazione il problema nel quale si sono determinati 2 intervalli di confidenza per la
media \(\mu\) del costo al metro quadro delgli appartamenti di un dato quartiere di una città italiana.
</p>

<p>
Si voglia determinare quanto deve essere grande il campione affinché l'intervallo di confidenza simmetrico abbia ampiezza non
superiore a 0.3 mantenendo sempre un livello di confidenza \(\alpha = 0.05\).
</p>

<p>
In base alla formula
\[P\left(\bar{X}_n-t_{1-\frac{\alpha}{2}} \frac{\hat{S}_n}{\sqrt{n}} \leq \mu \leq \bar{X}_n + t_{1-\frac{\alpha}{2}} \frac{\hat{S}_n}{\sqrt{n}}\right) = 1 - \alpha\]
è immediato osservare che l'ampiezza di un intervallo di confidenza simmetrico per \(\alpha=0.05\) risulta essere uguale a
\[ 2 \cdot z_{1 - \frac{\alpha}{2}} \cdot \frac{\hat{S}_n}{\sqrt{n}} = 2 \cdot 1.96 \cdot \frac{\hat{S}_n}{\sqrt{n}} = 3.92 \cdot \frac{\hat{S}_n}{\sqrt{n}}\].
Poiché la deviazione standard non è nota, possiamo sostituirla con una stima e la più indicata è ovviamente:
\(\hat{s}_n = \hat{s}_{80} = 1.22\).
</p>

<p>
Pertanto l'ampiezza risulta essere uguale a
\[\frac{3.92 \cdot 1.22}{\sqrt{n}} = \frac{4.783}{\sqrt{n}}\]
Notiamo che questa diminuisce con l'aumentare della numerosità del campione, pertanto, per avere l'ampiezza minore di 0.3,
occorrerà avere \(n\) sufficientemente grande.
\[ \frac{4.783}{\sqrt{n}} \leq 0.3 \iff \frac{4.783}{0.3} \leq \sqrt{n} \iff 15.94 \leq \sqrt{n} \iff 254.13 \leq n\]
In particolare risulta un'ampiezza poco minore a 0.3 quando \(n=255\).
</p>
</div>
</div>
<div id="outline-container-org3efe878" class="outline-4">
<h4 id="org3efe878"><span class="section-number-4">2.5.7</span> Stime di parametri</h4>
</div>
</div>
</div>

<div id="outline-container-org2895b52" class="outline-2">
<h2 id="org2895b52"><span class="section-number-2">3</span> Laboratorio</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org09148cf" class="outline-3">
<h3 id="org09148cf"><span class="section-number-3">3.1</span> Libri</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Help:
</p>
<div class="org-src-container">
<pre class="src src-R">help(solve)
</pre>
</div>
<div class="org-src-container">
<pre class="src src-R">?solve
</pre>
</div>
<div class="org-src-container">
<pre class="src src-R">help.start()
</pre>
</div>
<div class="org-src-container">
<pre class="src src-R">??solve
</pre>
</div>

<p>
Source:
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #558b2f;">source</span>(<span style="color: #689f38;">"commands.R"</span>)
</pre>
</div>

<p>
Basics:
</p>
<div class="org-src-container">
<pre class="src src-R">ls()

rm(x, y)

rm(list = ls())
</pre>
</div>

<p>
Vectors
</p>
<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(2, 5, 4)
y <span style="color: #558b2f;">&lt;-</span> c(x, 3)

y
</pre>
</div>

<pre class="example">
[1] 2 5 4 3

</pre>

<p>
Vector arithmetic
</p>
<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(1, 2, 3, 4)
y <span style="color: #558b2f;">&lt;-</span> 4

v <span style="color: #558b2f;">&lt;-</span> 2*x + y + 1

v
</pre>
</div>

<pre class="example">
[1]  7  9 11 13

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(1, 4, 6, 6)

max <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"max:"</span>, max(x))
min <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"min:"</span>, min(x))
length <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"length:"</span>, length(x))
mean <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"mean:"</span>, mean(x))
variance <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"variance:"</span>, var(x))
sum <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"sum:"</span>, sum(x))
product <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"product:"</span>, prod(x))

results <span style="color: #558b2f;">&lt;-</span> c(max, min, length, mean, variance, sum, product)
sorted_results <span style="color: #558b2f;">&lt;-</span> sort(results)

visual <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"Results:"</span>, results, <span style="color: #689f38;">"Sorted results:"</span>, sorted_results)
visual
</pre>
</div>

<pre class="example">
 [1] "Results:"         "max:"             "6"                "min:"            
 [5] "1"                "length:"          "4"                "mean:"           
 [9] "4.25"             "variance:"        "5.58333333333333" "sum:"            
[13] "17"               "product:"         "144"              "Sorted results:" 
[17] "1"                "144"              "17"               "4"               
[21] "4.25"             "5.58333333333333" "6"                "length:"         
[25] "max:"             "mean:"            "min:"             "product:"        
[29] "sum:"             "variance:"       

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(3, 6, -4, 5)
y <span style="color: #558b2f;">&lt;-</span> c(1, 4, 5, 0)

pmax <span style="color: #558b2f;">&lt;-</span> pmax(x, y)
pmin <span style="color: #558b2f;">&lt;-</span> pmin(x, y)

res <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"pmax"</span>, pmax, <span style="color: #689f38;">"pmin"</span>, pmin)
res
</pre>
</div>

<pre class="example">
[1] "pmax" "3"    "6"    "5"    "5"    "pmin" "1"    "4"    "-4"   "0"   

</pre>

<div class="org-src-container">
<pre class="src src-R">sqrt(-17+0i)
</pre>
</div>

<pre class="example">
[1] 0+4.123106i

</pre>

<p>
Generating regular sequences:
</p>
<div class="org-src-container">
<pre class="src src-R">seq(1, 5)
seq(from=1, to=5)
seq(to=5, from=1)
</pre>
</div>

<pre class="example">
[1] 1 2 3 4 5
[1] 1 2 3 4 5
[1] 1 2 3 4 5

</pre>

<div class="org-src-container">
<pre class="src src-R">seq(-5, 5, by=.9)
</pre>
</div>

<pre class="example">
[1] -5.0 -4.1 -3.2 -2.3 -1.4 -0.5  0.4  1.3  2.2  3.1  4.0  4.9

</pre>

<div class="org-src-container">
<pre class="src src-R">seq(length=10, from=-5, by=0.2)
</pre>
</div>

<pre class="example">
[1] -5.0 -4.8 -4.6 -4.4 -4.2 -4.0 -3.8 -3.6 -3.4 -3.2

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(0, 1)
rep(x, times=5)
</pre>
</div>

<pre class="example">
[1] 0 1 0 1 0 1 0 1 0 1

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(0, 1)
rep(x, each=3)
</pre>
</div>

<pre class="example">
[1] 0 0 0 1 1 1

</pre>

<p>
Logical vectors:
</p>
<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> 0:5
t <span style="color: #558b2f;">&lt;-</span> x &gt; 3
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(0, 1, <span style="color: #0097A7;">NA</span>)
ind <span style="color: #558b2f;">&lt;-</span> is.na(x)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">0/0

<span style="color: #0097A7;">Inf</span> - <span style="color: #0097A7;">Inf</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">NaN</span>
</pre>
</div>

<pre class="example">
[1] NaN
[1] NaN

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(0, <span style="color: #0097A7;">NA</span>, <span style="color: #0097A7;">NaN</span>)

is.nan(x)
</pre>
</div>

<pre class="example">
[1] FALSE FALSE  TRUE

</pre>

<p>
Character vectors:
</p>
<div class="org-src-container">
<pre class="src src-R">labs <span style="color: #558b2f;">&lt;-</span> paste(c(<span style="color: #689f38;">"X"</span>, <span style="color: #689f38;">"Y"</span>), 1:5, sep=<span style="color: #689f38;">""</span>)
</pre>
</div>

<p>
Index cectors; selecting and modifying subsets of a data  set
</p>
<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(0, 1, <span style="color: #0097A7;">NA</span>, 4)
y <span style="color: #558b2f;">&lt;-</span> x[!is.na(x)]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(0, 1, 2, 3, 4, 5)
x[1:3]
</pre>
</div>

<pre class="example">
[1] 0 1 2

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(0, 1, 2, 3, 4, 5)
x[-(1:3)]
</pre>
</div>

<pre class="example">
[1] 3 4 5

</pre>

<div class="org-src-container">
<pre class="src src-R">c(<span style="color: #689f38;">"x"</span>, <span style="color: #689f38;">"y"</span>)[rep(c(1, 2, 2, 1), times=2)]
</pre>
</div>

<pre class="example">
[1] "x" "y" "y" "x" "x" "y" "y" "x"

</pre>

<div class="org-src-container">
<pre class="src src-R">fruit <span style="color: #558b2f;">&lt;-</span> c(5, 10, 1, 20)
names(fruit) <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"orange"</span>, <span style="color: #689f38;">"banana"</span>, <span style="color: #689f38;">"apple"</span>, <span style="color: #689f38;">"peach"</span>)
lunch <span style="color: #558b2f;">&lt;-</span> fruit[c(<span style="color: #689f38;">"apple"</span>, <span style="color: #689f38;">"orange"</span>)]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #0097A7;">NA</span>, 1, <span style="color: #0097A7;">NA</span>, 2)
x[is.na(x)] <span style="color: #558b2f;">&lt;-</span> 0

x
</pre>
</div>

<pre class="example">
[1] 0 1 0 2

</pre>

<div class="org-src-container">
<pre class="src src-R">y <span style="color: #558b2f;">&lt;-</span> c(-1, -2, 0, 4, 6)
y[y &lt; 0] <span style="color: #558b2f;">&lt;-</span> -y[y &lt; 0]

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Same effect as</span>
y <span style="color: #558b2f;">&lt;-</span> abs(y)
</pre>
</div>

<p>
Intrinsic attributes: mode and length
</p>
<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(0, 1)

mode(x)
</pre>
</div>

<pre class="example">
[1] "numeric"

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> (3 + 5i)

attributes(x)
mode(x)
</pre>
</div>

<pre class="example">
NULL
[1] "complex"

</pre>

<div class="org-src-container">
<pre class="src src-R">z <span style="color: #558b2f;">&lt;-</span> 0:5

digits <span style="color: #558b2f;">&lt;-</span> as.character(z)

d <span style="color: #558b2f;">&lt;-</span> as.integer(digits)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">e <span style="color: #558b2f;">&lt;-</span> numeric()

e[3] <span style="color: #558b2f;">&lt;-</span> 4

e
</pre>
</div>

<pre class="example">
[1] NA NA  4

</pre>

<div class="org-src-container">
<pre class="src src-R">alpha <span style="color: #558b2f;">&lt;-</span> 0:9

alpha <span style="color: #558b2f;">&lt;-</span> alpha[2 * 1:5]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">alpha <span style="color: #558b2f;">&lt;-</span> 0:9

alpha <span style="color: #558b2f;">&lt;-</span> alpha[2 * 1:5]

length(alpha) <span style="color: #558b2f;">&lt;-</span> 3

alpha
</pre>
</div>

<pre class="example">
[1] 1 3 5

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">Allows R to treat z as if it were a 10-by-10 matrix</span>
attr(z, <span style="color: #689f38;">"dim"</span>) <span style="color: #558b2f;">&lt;-</span> c(3, 3)
</pre>
</div>

<p>
The class of an object:
</p>
<ul class="org-ul">
<li>numeric;</li>
<li>logical;</li>
<li>character;</li>
<li>list;</li>
<li>matrix;</li>
<li>factor;</li>
<li>date.frame</li>
</ul>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">Temporarily remove the effects of class</span>
unclass(winter)
</pre>
</div>

<p>
Ordered and unordered factors:
</p>
<div class="org-src-container">
<pre class="src src-R">state <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"tas"</span>, <span style="color: #689f38;">"sa"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"nt"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"qld"</span>,
           <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"sa"</span>, <span style="color: #689f38;">"tas"</span>, <span style="color: #689f38;">"sa"</span>,
           <span style="color: #689f38;">"nt"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"sa"</span>, <span style="color: #689f38;">"act"</span>,
           <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"act"</span>)

statef <span style="color: #558b2f;">&lt;-</span> factor(state)

levels(statef)
</pre>
</div>

<pre class="example">
[1] "act" "nsw" "nt"  "qld" "sa"  "tas" "vic" "wa" 

</pre>

<div class="org-src-container">
<pre class="src src-R">state <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"tas"</span>, <span style="color: #689f38;">"sa"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"nt"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"qld"</span>,
           <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"sa"</span>, <span style="color: #689f38;">"tas"</span>, <span style="color: #689f38;">"sa"</span>,
           <span style="color: #689f38;">"nt"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"sa"</span>, <span style="color: #689f38;">"act"</span>,
           <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"act"</span>)

incomes <span style="color: #558b2f;">&lt;-</span> c(60, 49, 40, 61, 64, 60, 59, 54, 62, 69, 70, 42, 56,
             61, 61, 61, 58, 51, 48, 65, 49, 49, 41, 48, 52, 46,
             59, 46, 58, 43)

statef <span style="color: #558b2f;">&lt;-</span> factor(state)

incmeans <span style="color: #558b2f;">&lt;-</span> tapply(incomes, statef, mean)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">state <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"tas"</span>, <span style="color: #689f38;">"sa"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"nt"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"qld"</span>,
           <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"sa"</span>, <span style="color: #689f38;">"tas"</span>, <span style="color: #689f38;">"sa"</span>,
           <span style="color: #689f38;">"nt"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"qld"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"wa"</span>, <span style="color: #689f38;">"sa"</span>, <span style="color: #689f38;">"act"</span>,
           <span style="color: #689f38;">"nsw"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"vic"</span>, <span style="color: #689f38;">"act"</span>)

incomes <span style="color: #558b2f;">&lt;-</span> c(60, 49, 40, 61, 64, 60, 59, 54, 62, 69, 70, 42, 56,
             61, 61, 61, 58, 51, 48, 65, 49, 49, 41, 48, 52, 46,
             59, 46, 58, 43)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">ordered() creates ordered factors</span>
statef <span style="color: #558b2f;">&lt;-</span> factor(state)

incmeans <span style="color: #558b2f;">&lt;-</span> tapply(incomes, statef, mean)

<span style="color: #0097A7;">stdError</span> <span style="color: #558b2f;">&lt;-</span> <span style="color: #00796b;">function</span>(x) sqrt(var(x)/length(x))

incster <span style="color: #558b2f;">&lt;-</span> tapply(incomes, statef, stdError)
</pre>
</div>

<p>
Arrays:
</p>
<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> array(1:20, dim=c(4, 5)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">Generate a 4 by 5 array</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> array(1:20, dim=c(4, 5)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">Generate a 4 by 5 array</span>

i <span style="color: #558b2f;">&lt;-</span> array(c(1:3, 3:1), dim=c(3, 2)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">i is a 3 by 2 index array</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> array(1:20, dim=c(4, 5)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">Generate a 4 by 5 array</span>

i <span style="color: #558b2f;">&lt;-</span> array(c(1:3, 3:1), dim=c(3, 2)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">i is a 3 by 2 index array</span>

x[i] <span style="color: #607d8b;"># </span><span style="color: #607d8b;">Extract those elements</span>
</pre>
</div>

<pre class="example">
[1] 9 6 3

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> array(1:20, dim=c(4, 5)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">Generate a 4 by 5 array</span>

i <span style="color: #558b2f;">&lt;-</span> array(c(1:3, 3:1), dim=c(3, 2)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">i is a 3 by 2 index array</span>

x[i] <span style="color: #607d8b;"># </span><span style="color: #607d8b;">Extract those elements</span>

x[i] <span style="color: #558b2f;">&lt;-</span> 0 <span style="color: #607d8b;">#</span><span style="color: #607d8b;">Replace those elements by zeros</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">Xb <span style="color: #558b2f;">&lt;-</span> matrix(0, n, b) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">blocks</span>
Xv <span style="color: #558b2f;">&lt;-</span> matrix(0, n, v) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">varieties</span>
ib <span style="color: #558b2f;">&lt;-</span> cbind(1:n, blocks)
iv <span style="color: #558b2f;">&lt;-</span> cbind(1:n, varieties)
Xb[ib] <span style="color: #558b2f;">&lt;-</span> 1
Xv[iv] <span style="color: #558b2f;">&lt;-</span> 1
X <span style="color: #558b2f;">&lt;-</span> cbind(Xb, Xv)

N <span style="color: #558b2f;">&lt;-</span> table(blocks, varieties)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> matrix(1:10, ncol=5)
dimnames(x) <span style="color: #558b2f;">&lt;-</span> list(c(<span style="color: #689f38;">"nome1"</span>, <span style="color: #689f38;">"nome2"</span>), <span style="color: #0097A7;">NULL</span>) <span style="color: #607d8b;">#</span><span style="color: #607d8b;">nomina solo le righe</span>
x
</pre>
</div>

<pre class="example">
      [,1] [,2] [,3] [,4] [,5]
nome1    1    3    5    7    9
nome2    2    4    6    8   10

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> matrix(1:10, ncol=5)
dimnames(x) <span style="color: #558b2f;">&lt;-</span> list(c(<span style="color: #689f38;">"nome2"</span>, <span style="color: #689f38;">"nome2"</span>), <span style="color: #0097A7;">NULL</span>) <span style="color: #607d8b;">#</span><span style="color: #607d8b;">nomina solo le righe</span>
dimnames(x)[[2]] <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"g"</span>, <span style="color: #689f38;">"h"</span>, <span style="color: #689f38;">"j"</span>, <span style="color: #689f38;">"j"</span>, <span style="color: #689f38;">"k"</span>) <span style="color: #607d8b;">#</span><span style="color: #607d8b;">nomina le colonne</span>
x
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">Utilizzabili anche le funzioni rownames() e colnames()</span>
</pre>
</div>

<pre class="example">
      g h j j  k
nome2 1 3 5 7  9
nome2 2 4 6 8 10

</pre>

<div class="org-src-container">
<pre class="src src-R">h <span style="color: #558b2f;">&lt;-</span> 0:23

Z <span style="color: #558b2f;">&lt;-</span> array(h, dim=c(3, 4, 2))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">Equivalent if h has 24 elements and not less</span>
Z <span style="color: #558b2f;">&lt;-</span> h ; dim(Z) <span style="color: #558b2f;">&lt;-</span> c(3, 4, 2)
Z
</pre>
</div>

<pre class="example">
, , 1

     [,1] [,2] [,3] [,4]
[1,]    0    3    6    9
[2,]    1    4    7   10
[3,]    2    5    8   11

, , 2

     [,1] [,2] [,3] [,4]
[1,]   12   15   18   21
[2,]   13   16   19   22
[3,]   14   17   20   23

</pre>

<div class="org-src-container">
<pre class="src src-R">h <span style="color: #558b2f;">&lt;-</span> 0:11

Z <span style="color: #558b2f;">&lt;-</span> array(h, dim=c(3, 4, 2))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">h <span style="color: #558b2f;">&lt;-</span> 0:5

Z <span style="color: #558b2f;">&lt;-</span> array(h, dim=c(3, 2, 2))

Z[1:6]
</pre>
</div>

<pre class="example">
[1] 0 1 2 3 4 5

</pre>

<div class="org-src-container">
<pre class="src src-R">h <span style="color: #558b2f;">&lt;-</span> 0:5

Z <span style="color: #558b2f;">&lt;-</span> array(h, dim=c(3, 2, 2))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Equivalent to Z</span>
Z[]
</pre>
</div>

<pre class="example">
, , 1

     [,1] [,2]
[1,]    0    3
[2,]    1    4
[3,]    2    5

, , 2

     [,1] [,2]
[1,]    0    3
[2,]    1    4
[3,]    2    5

</pre>

<p>
The outer product of two arrays:
</p>
<div class="org-src-container">
<pre class="src src-R">a <span style="color: #558b2f;">&lt;-</span> array(1:5)
b <span style="color: #558b2f;">&lt;-</span> array (6: 10)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Equivalent: ab &lt;- outer(a, b, "*")</span>
ab <span style="color: #558b2f;">&lt;-</span> a <span style="color: #558b2f;">%o%</span> b
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> 0:5
y <span style="color: #558b2f;">&lt;-</span> 2:4

<span style="color: #0097A7;">f</span> <span style="color: #558b2f;">&lt;-</span> <span style="color: #00796b;">function</span>(x, y) cos(y)/(1 + x^2)
z <span style="color: #558b2f;">&lt;-</span> outer(x, y, f)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Determinant of 2 by 2 matrices</span>

d <span style="color: #558b2f;">&lt;-</span> outer(0:9, 0:9)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Determinant of 2 by 2 matrices</span>

d <span style="color: #558b2f;">&lt;-</span> outer(0:9, 0:9)
fr <span style="color: #558b2f;">&lt;-</span> table(outer(d, d, <span style="color: #689f38;">"-"</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Determinant of 2 by 2 matrices</span>

d <span style="color: #558b2f;">&lt;-</span> outer(0:9, 0:9)
fr <span style="color: #558b2f;">&lt;-</span> table(outer(d, d, <span style="color: #689f38;">"-"</span>))
plot(fr, xlab=<span style="color: #689f38;">"Determinant"</span>, ylab=<span style="color: #689f38;">"Frequency"</span>)
</pre>
</div>


<div class="figure">
<p><img src="graph.png" alt="graph.png" />
</p>
</div>

<p>
Generalized transpose of an array:
</p>
<div class="org-src-container">
<pre class="src src-R">A <span style="color: #558b2f;">&lt;-</span> array(c(0:3, 5:6), dim=c(3, 2))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">Transpose (also t(A)):</span>
B <span style="color: #558b2f;">&lt;-</span> aperm(A, c(2, 1))
</pre>
</div>

<p>
Matrix facilities:
</p>
<div class="org-src-container">
<pre class="src src-R">A <span style="color: #558b2f;">&lt;-</span> array(0:9, c(5, 2))

row <span style="color: #558b2f;">&lt;-</span> nrow(A)
col <span style="color: #558b2f;">&lt;-</span> ncol(A)

c(row, col)
</pre>
</div>

<pre class="example">
[1] 5 2

</pre>

<p>
Matrix multiplication:
</p>
<div class="org-src-container">
<pre class="src src-R">A <span style="color: #558b2f;">&lt;-</span> array(0:5, c(2, 3))
B <span style="color: #558b2f;">&lt;-</span> array(1:6, c(2, 3))

A * B
</pre>
</div>

<pre class="example">
     [,1] [,2] [,3]
[1,]    0    6   20
[2,]    2   12   30

</pre>

<div class="org-src-container">
<pre class="src src-R">A <span style="color: #558b2f;">&lt;-</span> array(0:5, c(2, 3))
B <span style="color: #558b2f;">&lt;-</span> array(1:6, c(3, 2))

A <span style="color: #558b2f;">%*%</span> B
</pre>
</div>

<pre class="example">
     [,1] [,2]
[1,]   16   34
[2,]   22   49

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">The same, but more efficient, of: t(X) %*% y</span>
crossprod(X, y)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> 0:4
y <span style="color: #558b2f;">&lt;-</span> 5:9
A <span style="color: #558b2f;">&lt;-</span> array(0:24, c(5, 5))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">Quadratic form</span>
x <span style="color: #558b2f;">%*%</span> A <span style="color: #558b2f;">%*%</span> x
</pre>
</div>

<pre class="example">
     [,1]
[1,] 1800

</pre>

<div class="org-src-container">
<pre class="src src-R">v <span style="color: #558b2f;">&lt;-</span> 0:5

diag(v)
</pre>
</div>

<pre class="example">
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    1    0    0    0    0
[3,]    0    0    2    0    0    0
[4,]    0    0    0    3    0    0
[5,]    0    0    0    0    4    0
[6,]    0    0    0    0    0    5

</pre>

<div class="org-src-container">
<pre class="src src-R">k <span style="color: #558b2f;">&lt;-</span> 4

diag(k)
</pre>
</div>

<pre class="example">
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1

</pre>

<div class="org-src-container">
<pre class="src src-R">M <span style="color: #558b2f;">&lt;-</span> array(0:8, c(3, 3))

diag(M)
</pre>
</div>

<pre class="example">
[1] 0 4 8

</pre>

<p>
Linear equations and inversion:
</p>
<div class="org-src-container">
<pre class="src src-R">A <span style="color: #558b2f;">&lt;-</span> array(0:3, c(2, 2))
b <span style="color: #558b2f;">&lt;-</span> 0:1

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">b = A x</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">x = A^{-1} b</span>
x <span style="color: #558b2f;">&lt;-</span> solve(A, b)
</pre>
</div>

<p>
Eigenvalues and eigenvectors
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Assign to ev the list of this 2 components: values and vectors</span>
Sm <span style="color: #558b2f;">&lt;-</span> array(c(1, 2, 2, 1), c(2, 2))

ev <span style="color: #558b2f;">&lt;-</span> eigen(Sm)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">For only the eigenvalues</span>
evals <span style="color: #558b2f;">&lt;-</span> eigen(Sm)$values

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">If the eigenvectors are not needed</span>
evals <span style="color: #558b2f;">&lt;-</span> eigen(Sm, only.values = <span style="color: #0097A7;">TRUE</span>)$values
</pre>
</div>

<p>
Least squares fitting and the QR decomposition
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">A list squares fit where y is the vector of observations and X is the desing matrix</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">A grand mean term is automatically included and need not be included explicitly as a column of X</span>
ans <span style="color: #558b2f;">&lt;-</span> lsfit(X, y)
</pre>
</div>

<p>
Forming partitioned matrices, <code>cbind()</code> and <code>rbind()</code>
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">The arguments to cbind() must be either vectors of any length,</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">or matrices with the same colums size, that is the same number of rows</span>
X <span style="color: #558b2f;">&lt;-</span> cbind(arg_1, arg_2, ...)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">rbind &#8594; row bind</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">X1 <span style="color: #558b2f;">&lt;-</span> 0:4
X2 <span style="color: #558b2f;">&lt;-</span> 5:9

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">The 1 is shorter than the vectors, so it is cyclically extended to match the matrix column size</span>
X <span style="color: #558b2f;">&lt;-</span> cbind(1, X1, X2)
</pre>
</div>

<p>
The concatenation function, <code>c()</code>, with arrays
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">To coerce the array vec batk to a simple vector object</span>
vec <span style="color: #558b2f;">&lt;-</span> as.vector(X)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Equivalent to</span>
vec <span style="color: #558b2f;">&lt;-</span> c(X)
</pre>
</div>

<p>
Lists and data frames:
</p>
<div class="org-src-container">
<pre class="src src-R">Lst <span style="color: #558b2f;">&lt;-</span> list(name=<span style="color: #689f38;">"Fred"</span>, wife=<span style="color: #689f38;">"Mary"</span>, no.children=3, child.ages=c(4, 7, 9))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Lst[[1]] is the first component, etc.</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Lst$name or Lst[["name"]] is also the first component</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Lst[1] is the sublist consisting of the first entry only. The correct operator is '[[...]]'</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">length(Lst) is the lenght of the list</span>
</pre>
</div>

<p>
Constructing and modifying lists
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">To extend a list by specifying additional components</span>
Lst[5] <span style="color: #558b2f;">&lt;-</span> list(matrix=Mat)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Concatenating lists</span>
list.ABC <span style="color: #558b2f;">&lt;-</span> c(list.A, list.B, list.C)
</pre>
</div>

<p>
Data frames
</p>
<div class="org-src-container">
<pre class="src src-R">accountants <span style="color: #558b2f;">&lt;-</span> data.frame(home=statef, loot=incomes, shot=incomef)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">List to data frame: use the function as.data.frame()</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">To eliminate a component</span>
accountants$home <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">crea un dataframe con una variabile 'quantitativa' ed una</span>
<span style="color: #607d8b; font-weight: bold;">#</span><span style="color: #607d8b; font-weight: bold;">'</span><span style="color: #607d8b;">qualitativa'</span>
X <span style="color: #558b2f;">&lt;-</span> data.frame(a=1:4, sesso=c(<span style="color: #689f38;">"M"</span>, <span style="color: #689f38;">"F"</span>, <span style="color: #689f38;">"F"</span>, <span style="color: #689f38;">"M"</span>))
X$eta <span style="color: #558b2f;">&lt;-</span> c(2.5, 3, 5, 6.2) <span style="color: #607d8b;">#</span><span style="color: #607d8b;">aggiungi una variabile di nome eta</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">X <span style="color: #558b2f;">&lt;-</span> data.frame(a=1:4, sesso=c(<span style="color: #689f38;">"M"</span>, <span style="color: #689f38;">"F"</span>, <span style="color: #689f38;">"F"</span>, <span style="color: #689f38;">"M"</span>))
X$eta <span style="color: #558b2f;">&lt;-</span> c(2.5, 3, 5, 6.2) <span style="color: #607d8b;">#</span><span style="color: #607d8b;">aggiungi una variabile di nome eta</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">seleziona i valori di "a" se eta &lt;=5 E eta &gt;3</span>
X$a[X$eta &lt;=5 &amp; X$eta&gt;3]
</pre>
</div>

<pre class="example">
[1] 3

</pre>

<div class="org-src-container">
<pre class="src src-R">X <span style="color: #558b2f;">&lt;-</span> data.frame(a=1:4, sesso=c(<span style="color: #689f38;">"M"</span>, <span style="color: #689f38;">"F"</span>, <span style="color: #689f38;">"F"</span>, <span style="color: #689f38;">"M"</span>))
X$eta <span style="color: #558b2f;">&lt;-</span> c(2.5, 3, 5, 6.2) <span style="color: #607d8b;">#</span><span style="color: #607d8b;">aggiungi una variabile di nome eta</span>

subset(X, subset=(eta&lt;3 | eta&gt;5), select=c(a, sesso))
</pre>
</div>

<pre class="example">
  a sesso
1 1     M
4 4     M

</pre>

<div class="org-src-container">
<pre class="src src-R">X <span style="color: #558b2f;">&lt;-</span> data.frame(a=1:4, sesso=c(<span style="color: #689f38;">"M"</span>, <span style="color: #689f38;">"F"</span>, <span style="color: #689f38;">"F"</span>, <span style="color: #689f38;">"M"</span>))
X$eta <span style="color: #558b2f;">&lt;-</span> c(2.5, 3, 5, 6.2) <span style="color: #607d8b;">#</span><span style="color: #607d8b;">aggiungi una variabile di nome eta</span>

subset(X, subset=(eta&lt;3|eta&gt;5), select=-eta)
</pre>
</div>

<pre class="example">
  a sesso
1 1     M
4 4     M

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">lentils is a data frame: lentils$u, lentils$v and lentils$w</span>
<span style="color: #558b2f;">attach</span>(lentils)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Do not modify lentils$u</span>
u <span style="color: #558b2f;">&lt;-</span> v + w

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">Modify lentils$u</span>
lentils$u <span style="color: #558b2f;">&lt;-</span> v + w

<span style="color: #558b2f;">detach</span>(lentils)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">or detach("lentils")</span>
</pre>
</div>

<p>
Reading data from files
</p>
<div class="org-src-container">
<pre class="src src-R">HousePrice <span style="color: #558b2f;">&lt;-</span> read.table(<span style="color: #689f38;">"houses.data"</span>, header=<span style="color: #0097A7;">TRUE</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">prova <span style="color: #558b2f;">&lt;-</span> read.table(<span style="color: #689f38;">"mio.txt"</span>, row.names=1)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">X <span style="color: #558b2f;">&lt;-</span> read.table(file=<span style="color: #689f38;">"c:/documenti/dati.txt"</span>,
                header=<span style="color: #0097A7;">TRUE</span>,
                sep=<span style="color: #689f38;">"\t"</span>
                na.strings=<span style="color: #689f38;">"NA"</span>,
                dec=<span style="color: #689f38;">"."</span>)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">nrows &#8594; numero massimo di righe da leggere</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">skip &#8594; numero di righe iniziali da saltare prima dell'importazione</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">X$eta[1] <span style="color: #558b2f;">&lt;-</span> X$sesso[4] <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NA</span>
X2 <span style="color: #558b2f;">&lt;-</span> X[!is.na(X$sesso)&amp;!is.na(X$eta),]
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Si pu&#242; semplicemente usare na.omit(X)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Crea una variabile categoriale e nomina le etichette:</span>
x <span style="color: #558b2f;">&lt;-</span> factor(c(1, 1, 2, 3, 1), labels=c(<span style="color: #689f38;">"gruppo1"</span>, <span style="color: #689f38;">"gruppo2"</span>, <span style="color: #689f38;">"gruppo3"</span>))
x
</pre>
</div>

<pre class="example">
[1] gruppo1 gruppo1 gruppo2 gruppo3 gruppo1
Levels: gruppo1 gruppo2 gruppo3

</pre>

<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> factor(c(1, 1, 2, 3, 1), labels=c(<span style="color: #689f38;">"gruppo1"</span>, <span style="color: #689f38;">"gruppo2"</span>, <span style="color: #689f38;">"gruppo3"</span>))

factor(x, levels=c(<span style="color: #689f38;">"gruppo1"</span>, <span style="color: #689f38;">"gruppo3"</span>)) <span style="color: #607d8b;">#</span><span style="color: #607d8b;">escludi la categoria 3</span>
</pre>
</div>

<pre class="example">
[1] gruppo1 gruppo1 &lt;NA&gt;    gruppo3 gruppo1
Levels: gruppo1 gruppo3

</pre>

<div class="org-src-container">
<pre class="src src-R">eta <span style="color: #558b2f;">&lt;-</span> c(2, 4, .3, 5, .2, 6, 8, 9, .8, 4, 10, 9.5)
eta.cat <span style="color: #558b2f;">&lt;-</span> cut(eta, breaks=c(0, 3, 5, 10),
               labels=c(<span style="color: #689f38;">"basso"</span>, <span style="color: #689f38;">"medio"</span>, <span style="color: #689f38;">"alto"</span>))
eta.cat
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org">basso
medio
basso
medio
basso
alto
alto
alto
basso
medio
alto
alto
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">inp <span style="color: #558b2f;">&lt;-</span> scan(<span style="color: #689f38;">"input.dat"</span>, list(<span style="color: #689f38;">""</span>, 0, 0))

label <span style="color: #558b2f;">&lt;-</span> inp[[1]]; x <span style="color: #558b2f;">&lt;-</span> inp[[2]]; y <span style="color: #558b2f;">&lt;-</span> inp[[3]]
</pre>
</div>

<p>
Similarly:
</p>
<div class="org-src-container">
<pre class="src src-R">inp <span style="color: #558b2f;">&lt;-</span> scan(<span style="color: #689f38;">"input.dat"</span>, list(id=<span style="color: #689f38;">""</span>, x=0, y=0))

lable &#171;- inp$id; x <span style="color: #558b2f;">&lt;-</span> inp$x; y <span style="color: #558b2f;">&lt;-</span> inpt$y
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">The second arguemnt is a single value and not a list</span>
X <span style="color: #558b2f;">&lt;-</span> matrix(scan(<span style="color: #689f38;">"light.dat"</span>, 0), ncol=5, byrow=<span style="color: #0097A7;">TRUE</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">List of datasets</span>
data()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">To access data from a particular package</span>
data(package=<span style="color: #689f38;">"rpart"</span>)
data(Puromycin, package=<span style="color: #689f38;">"datasets"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">xnew <span style="color: #558b2f;">&lt;-</span> edit(xold)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">fix(xold) is equivalent to</span>
xold <span style="color: #558b2f;">&lt;-</span> edit(xold)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">To enter new data via the spreadsheet interface</span>
xnew <span style="color: #558b2f;">&lt;-</span> edit(data.frame())
</pre>
</div>
</div>
</div>

<div id="outline-container-org2732938" class="outline-3">
<h3 id="org2732938"><span class="section-number-3">3.2</span> Slides</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org71c6857" class="outline-4">
<h4 id="org71c6857"><span class="section-number-4">3.2.1</span> Statistica Descrittiva</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
Esempio 1.1
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Caricare il file "esempio1.1.csv"</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">f &lt;- file.choose()</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">ese11 &lt;- scan(f, sep=";")</span>
ese11 <span style="color: #558b2f;">&lt;-</span> scan(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/esempio1.1.csv"</span>,
sep=<span style="color: #689f38;">";"</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze assolute</span>
table(ese11)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze relative</span>
prop.table(table(ese11))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze cumulate assolute</span>
cumsum(table(ese11))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze cumulate relative</span>
cumsum(prop.table(table(ese11)))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Dati quantitativi - barplot</span>
barplot(table(ese11), xlab=<span style="color: #689f38;">"numero stanze"</span>, ylab=<span style="color: #689f38;">"frequenza"</span>,
        main=<span style="color: #689f38;">""</span>)
</pre>
</div>


<div class="figure">
<p><img src="barplot.png" alt="barplot.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Caricare il file "esempio1.1.csv"</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">f &lt;- file.choose()</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">ese11 &lt;- scan(f, sep=";")</span>
ese11 <span style="color: #558b2f;">&lt;-</span> scan(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/esempio1.1.csv"</span>,
sep=<span style="color: #689f38;">";"</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze assolute</span>
table(ese11)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze relative</span>
prop.table(table(ese11))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze cumulate assolute</span>
cumsum(table(ese11))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze cumulate relative</span>
cumsum(prop.table(table(ese11)))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Dati quantitativi - stripchart o dot plot</span>
stripchart(ese11, method=<span style="color: #689f38;">"stack"</span>, xlab=<span style="color: #689f38;">"stanze"</span>) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">stack</span>
</pre>
</div>


<div class="figure">
<p><img src="stripchart.png" alt="stripchart.png" />
</p>
</div>

<p>
Esempio 1.2
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Caricare il file "esempio1.2.csv"</span>
ese12 <span style="color: #558b2f;">&lt;-</span> scan(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/esempio1.2.csv"</span>,
sep=<span style="color: #689f38;">";"</span>, dec=<span style="color: #689f38;">","</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">minimo e massimo</span>
min(ese12)
max(ese12)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Dati quantitativi - hist</span>
interval <span style="color: #558b2f;">&lt;-</span> c(0.4, 1.5, 2.3, 3, 4, 5.5)
hist(ese12, breaks=interval)
</pre>
</div>


<div class="figure">
<p><img src="hist1.png" alt="hist1.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Caricare il file "esempio1.2.csv"</span>
ese12 <span style="color: #558b2f;">&lt;-</span> scan(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/esempio1.2.csv"</span>,
sep=<span style="color: #689f38;">";"</span>, dec=<span style="color: #689f38;">","</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">minimo e massimo</span>
min(ese12)
max(ese12)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Dati quantitativi - hist</span>
interval <span style="color: #558b2f;">&lt;-</span> c(0.4, 1.5, 2.3, 3, 4, 5.5)
hist(ese12)
</pre>
</div>


<div class="figure">
<p><img src="hist2.png" alt="hist2.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Caricare il file "esempio1.2.csv"</span>
ese12 <span style="color: #558b2f;">&lt;-</span> scan(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/esempio1.2.csv"</span>,
sep=<span style="color: #689f38;">";"</span>, dec=<span style="color: #689f38;">","</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">minimo e massimo</span>
min(ese12)
max(ese12)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Dati quantitativi - plot</span>
plot(ese12, xlab=<span style="color: #689f38;">"appartamenti"</span>, ylab=<span style="color: #689f38;">"costo"</span>)
</pre>
</div>


<div class="figure">
<p><img src="plot.png" alt="plot.png" />
</p>
</div>

<p>
Esercizio 1:
</p>
<ul class="org-ul">
<li>Si è interessati a studiare la variabile <code>years</code> relativa all'età di un certo numero di giocatori di calcio.</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">giocatori <span style="color: #558b2f;">&lt;-</span> read.table(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/giocatori.txt"</span>,
            sep=<span style="color: #689f38;">";"</span>, header=<span style="color: #0097A7;">TRUE</span>)

<span style="color: #558b2f;">attach</span>(giocatori)

table(years)
</pre>
</div>

<pre class="example">
years
 18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37 
 17  36 107 170 192 209 203 173 198 209 197 209 149 159 139 115 128  96  85  56 
 38  39  40  41  42  43  44  46 
 40  30  15   9   5   2   3   1

</pre>

<div class="org-src-container">
<pre class="src src-R">prop.table(table(years))
</pre>
</div>

<pre class="example">
years
          18           19           20           21           22           23 
0.0057588076 0.0121951220 0.0362466125 0.0575880759 0.0650406504 0.0707994580 
          24           25           26           27           28           29 
0.0687669377 0.0586043360 0.0670731707 0.0707994580 0.0667344173 0.0707994580 
          30           31           32           33           34           35 
0.0504742547 0.0538617886 0.0470867209 0.0389566396 0.0433604336 0.0325203252 
          36           37           38           39           40           41 
0.0287940379 0.0189701897 0.0135501355 0.0101626016 0.0050813008 0.0030487805 
          42           43           44           46 
0.0016937669 0.0006775068 0.0010162602 0.0003387534
</pre>

<div class="org-src-container">
<pre class="src src-R">cumsum(table(years))
</pre>
</div>

<pre class="example">
  18   19   20   21   22   23   24   25   26   27   28   29   30   31   32   33 
  17   53  160  330  522  731  934 1107 1305 1514 1711 1920 2069 2228 2367 2482 
  34   35   36   37   38   39   40   41   42   43   44   46 
2610 2706 2791 2847 2887 2917 2932 2941 2946 2948 2951 2952

</pre>

<div class="org-src-container">
<pre class="src src-R">cumsum(prop.table(table(year)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org">org<span style="color: #8b4513;">_babel</span>_R<span style="color: #8b4513;">_eoe</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">min <span style="color: #558b2f;">&lt;-</span> min(years)
max <span style="color: #558b2f;">&lt;-</span> max(years)

c(min, max)
</pre>
</div>

<pre class="example">
[1] 18 46

</pre>

<div class="org-src-container">
<pre class="src src-R">hist(years, main=<span style="color: #689f38;">"Istogramma et&#224;"</span>)
</pre>
</div>


<div class="figure">
<p><img src="istogramma.png" alt="istogramma.png" />
</p>
</div>

<p>
Esempio 1.8:
</p>
<div class="org-src-container">
<pre class="src src-R">ese11 <span style="color: #558b2f;">&lt;-</span> scan(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/esempio1.1.csv"</span>,
sep=<span style="color: #689f38;">";"</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Ordinamento crescente</span>
cresc <span style="color: #558b2f;">&lt;-</span> sort(ese11)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Ordinamento descrescente</span>
decr <span style="color: #558b2f;">&lt;-</span> sort(ese11, dec=T)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Media</span>
media <span style="color: #558b2f;">&lt;-</span> mean(ese11)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Mediana</span>
mediana <span style="color: #558b2f;">&lt;-</span> median(ese11)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Moda</span>
m <span style="color: #558b2f;">&lt;-</span> table(ese11)
moda <span style="color: #558b2f;">&lt;-</span> m[m==max(m)]

list(cresc, decr, media, mediana, moda)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org">2       8       4.3125  4       24
2       8       4.3125  4       24
2       8       4.3125  4       24
2       7       4.3125  4       24
2       7       4.3125  4       24
2       7       4.3125  4       24
2       7       4.3125  4       24
2       7       4.3125  4       24
2       6       4.3125  4       24
2       6       4.3125  4       24
2       6       4.3125  4       24
3       6       4.3125  4       24
3       6       4.3125  4       24
3       6       4.3125  4       24
3       6       4.3125  4       24
3       6       4.3125  4       24
3       6       4.3125  4       24
3       5       4.3125  4       24
3       5       4.3125  4       24
3       5       4.3125  4       24
3       5       4.3125  4       24
3       5       4.3125  4       24
3       5       4.3125  4       24
3       5       4.3125  4       24
4       5       4.3125  4       24
4       5       4.3125  4       24
4       5       4.3125  4       24
4       5       4.3125  4       24
4       5       4.3125  4       24
4       5       4.3125  4       24
4       5       4.3125  4       24
4       5       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
4       4       4.3125  4       24
5       4       4.3125  4       24
5       4       4.3125  4       24
5       4       4.3125  4       24
5       4       4.3125  4       24
5       4       4.3125  4       24
5       4       4.3125  4       24
5       4       4.3125  4       24
5       4       4.3125  4       24
5       3       4.3125  4       24
5       3       4.3125  4       24
5       3       4.3125  4       24
5       3       4.3125  4       24
5       3       4.3125  4       24
5       3       4.3125  4       24
5       3       4.3125  4       24
6       3       4.3125  4       24
6       3       4.3125  4       24
6       3       4.3125  4       24
6       3       4.3125  4       24
6       3       4.3125  4       24
6       3       4.3125  4       24
6       2       4.3125  4       24
6       2       4.3125  4       24
6       2       4.3125  4       24
7       2       4.3125  4       24
7       2       4.3125  4       24
7       2       4.3125  4       24
7       2       4.3125  4       24
7       2       4.3125  4       24
8       2       4.3125  4       24
8       2       4.3125  4       24
8       2       4.3125  4       24
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Caricare il file "esempio1.2.csv"</span>
ese12 <span style="color: #558b2f;">&lt;-</span> scan(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/esempio1.2.csv"</span>,
sep=<span style="color: #689f38;">";"</span>, dec=<span style="color: #689f38;">","</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Varianza campionaria</span>
var <span style="color: #558b2f;">&lt;-</span> var(ese12)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Deviazione standard</span>
sd <span style="color: #558b2f;">&lt;-</span> sd(ese12)
sqrt(var(ese12))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Quantili</span>
quant <span style="color: #558b2f;">&lt;-</span> quantile(ese12, c(0.25, 0.5, 0.75))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Range interquantile</span>
iqr <span style="color: #558b2f;">&lt;-</span> IQR(ese12)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Range</span>
range(ese12)

list(var, sd, quant, iqr, range)
</pre>
</div>

<pre class="example">
Read 80 items
[1] 1.2132
[1] 0.44 5.42
[[1]]
[1] 1.471853

[[2]]
[1] 1.2132

[[3]]
  25%   50%   75% 
1.895 2.355 3.675 

[[4]]
[1] 1.78

[[5]]
function (..., na.rm = FALSE)  .Primitive("range")
</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">install.packages("e1071")</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">library("e1071")</span>
<span style="color: #558b2f;">require</span>(<span style="color: #689f38;">"e1071"</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Asimmetria</span>
skewness <span style="color: #558b2f;">&lt;-</span> skewness(ese12)
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2 * sqrt(6/length(ese12))</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Curtosi</span>
kurtosis <span style="color: #558b2f;">&lt;-</span> kurtosis(ese12)
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4 * sqrt(6/length(ese12))</span>

list(skewness, kurtosis)
</pre>
</div>

<pre class="example">
Carico il pacchetto richiesto: e1071
Warning message:
In library(package, lib.loc = lib.loc, character.only = TRUE, logical.return = TRUE,  :
  there is no package called ‘e1071’
Error in skewness(ese12) : non trovo la funzione "skewness"
Error in kurtosis(ese12) : non trovo la funzione "kurtosis"
Errore: oggetto "skewness" non trovato

</pre>


<div class="figure">
<p><img src="Laboratorio/screenshot_2018-03-20_19-50-29.png" alt="screenshot_2018-03-20_19-50-29.png" />
</p>
</div>


<div class="figure">
<p><img src="Laboratorio/screenshot_2018-03-20_19-51-03.png" alt="screenshot_2018-03-20_19-51-03.png" />
</p>
</div>

<p>
Esercizio 2:
</p>
<ul class="org-ul">
<li>Si è interessati a studiare la variabile years relativa all'età di un certo numero di giocatori di calcio</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #558b2f;">require</span>(<span style="color: #689f38;">"e1071"</span>)

giocatori <span style="color: #558b2f;">&lt;-</span> read.table(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/giocatori.txt"</span>,
            sep=<span style="color: #689f38;">";"</span>, header=<span style="color: #0097A7;">TRUE</span>)

<span style="color: #558b2f;">attach</span>(giocatori)

media <span style="color: #558b2f;">&lt;-</span> mean(years)

mediana <span style="color: #558b2f;">&lt;-</span> median(years)

max <span style="color: #558b2f;">&lt;-</span> max(years)

m <span style="color: #558b2f;">&lt;-</span> table(years)
moda <span style="color: #558b2f;">&lt;-</span> m[m==max(m)]

iqr <span style="color: #558b2f;">&lt;-</span> IQR(years)

varianza <span style="color: #558b2f;">&lt;-</span> var(years)

devst <span style="color: #558b2f;">&lt;-</span> sd(years)

skewness <span style="color: #558b2f;">&lt;-</span> skewness(years)

kurtosis <span style="color: #558b2f;">&lt;-</span> kurtosis(years)

list(media, mediana, max, moda, iqr, varianza, devst, skewness, kurtosis)
</pre>
</div>

<p>
Esempio 1.12
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Caricare il file "esempio 1.12.csv"</span>
ese112 <span style="color: #558b2f;">&lt;-</span> read.csv(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/esempio1.12.csv"</span>,
                   sep=<span style="color: #689f38;">";"</span>, header=<span style="color: #0097A7;">TRUE</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze assolute</span>
tc <span style="color: #558b2f;">&lt;-</span> table(ese112)
tc
</pre>
</div>

<pre class="example">
      Occupanti
Stanze 2 3 4 5 7
     2 3 1 0 0 0
     3 5 2 2 0 0
     4 1 5 4 2 0
     5 1 3 2 0 1
     6 0 0 2 0 1

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Tabella di contingenza con distribuzioni assolute marginali</span>
tcc <span style="color: #558b2f;">&lt;-</span> cbind(tc, margin.table(tc, 1)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">marginale stanze</span>
tcc
</pre>
</div>

<pre class="example">
  2 3 4 5 7   
2 3 1 0 0 0  4
3 5 2 2 0 0  9
4 1 5 4 2 0 12
5 1 3 2 0 1  7
6 0 0 2 0 1  3

</pre>

<div class="org-src-container">
<pre class="src src-R">rbind(tcc, margin.table(tcc, 2)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">marginale occupanti</span>
</pre>
</div>

<pre class="example">
   2  3  4 5 7   
2  3  1  0 0 0  4
3  5  2  2 0 0  9
4  1  5  4 2 0 12
5  1  3  2 0 1  7
6  0  0  2 0 1  3
  10 11 10 2 2 35

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Frequenze relative</span>
tcr <span style="color: #558b2f;">&lt;-</span> prop.table(table(ese112))
tcr
</pre>
</div>

<pre class="example">
      Occupanti
Stanze          2          3          4          5          7
     2 0.08571429 0.02857143 0.00000000 0.00000000 0.00000000
     3 0.14285714 0.05714286 0.05714286 0.00000000 0.00000000
     4 0.02857143 0.14285714 0.11428571 0.05714286 0.00000000
     5 0.02857143 0.08571429 0.05714286 0.00000000 0.02857143
     6 0.00000000 0.00000000 0.05714286 0.00000000 0.02857143

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Tabella di contingenza con distribuzioni relative marginali</span>
tccr <span style="color: #558b2f;">&lt;-</span> cbind(tcr, margin.table(tcr, 1)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">marginale stanze</span>
rbind(tccr, margin.table(tccr, 2)) <span style="color: #607d8b;"># </span><span style="color: #607d8b;">marginale occupanti</span>
</pre>
</div>

<pre class="example">
           2          3          4          5          7           
2 0.08571429 0.02857143 0.00000000 0.00000000 0.00000000 0.11428571
3 0.14285714 0.05714286 0.05714286 0.00000000 0.00000000 0.25714286
4 0.02857143 0.14285714 0.11428571 0.05714286 0.00000000 0.34285714
5 0.02857143 0.08571429 0.05714286 0.00000000 0.02857143 0.20000000
6 0.00000000 0.00000000 0.05714286 0.00000000 0.02857143 0.08571429
  0.28571429 0.31428571 0.28571429 0.05714286 0.05714286 1.00000000

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">install.packages("labstatR")</span>
<span style="color: #558b2f;">require</span>(<span style="color: #689f38;">"labstatR"</span>)
bubbleplot(tc)
</pre>
</div>


<div class="figure">
<p><img src="bubbleplot.png" alt="bubbleplot.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">plot(ese112$Occupanti, ese112$Stanze, xlab=<span style="color: #689f38;">"Occupanti"</span>, ylab=<span style="color: #689f38;">"Stanze"</span>, main=<span style="color: #689f38;">"Scatterplot"</span>)
</pre>
</div>


<div class="figure">
<p><img src="scatterplot.png" alt="scatterplot.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">barplot(table(ese112), legend=T, col=c(<span style="color: #689f38;">"lightblue"</span>, <span style="color: #689f38;">"mistyrose"</span>, <span style="color: #689f38;">"lightcyan"</span>,
                                       <span style="color: #689f38;">"lavender"</span>, <span style="color: #689f38;">"cornsilk"</span>), xlab=<span style="color: #689f38;">"Occupanti"</span>,
        ylab=<span style="color: #689f38;">"Frequenze"</span>, args.legend=list(x=<span style="color: #689f38;">"topright"</span>, title=<span style="color: #689f38;">"Stanze"</span>))
</pre>
</div>


<div class="figure">
<p><img src="barplot.png" alt="barplot.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Covarianza</span>
cov(ese112$Stanze, ese112$Occupanti)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Correlazione</span>
cor(ese112$Stanze, ese112$Occupanti)
</pre>
</div>

<pre class="example">
[1] 0.805042
[1] 0.5548666

</pre>

<p>
Esercizio 3:
</p>
<div class="org-src-container">
<pre class="src src-R">giocatori <span style="color: #558b2f;">&lt;-</span> read.table(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/giocatori.txt"</span>,
            sep=<span style="color: #689f38;">";"</span>, header=<span style="color: #0097A7;">TRUE</span>)

<span style="color: #558b2f;">attach</span>(giocatori)

tc <span style="color: #558b2f;">&lt;-</span> table(role, years)
tc

tcc <span style="color: #558b2f;">&lt;-</span> cbind(tc, margin.table(tc, 1))
tcc

rbind(tcc, margin.table(tcc, 2))
</pre>
</div>

<pre class="example">
The following objects are masked from giocatori (pos = 3):

    birth_date, name, player_id, role, year_date, years
            years
role          18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33
  defence      3   6  34  47  47  58  51  50  75  69  59  65  60  52  47  40
  goalkeeper   2   6  15  22  29  23  20  18  18  21  13  15  11  15  16  16
  midfield    10  19  44  77  98  95 112  93  93 103 110 109  71  80  63  53
  striker      1   4   8  19  18  30  18  12  12  16  15  20   7  12  13   6
  unknown      1   1   6   5   0   3   2   0   0   0   0   0   0   0   0   0
            years
role          34  35  36  37  38  39  40  41  42  43  44  46
  defence     46  41  33  24  16   9   2   1   0   0   0   0
  goalkeeper  14   8  13  10   5   7   5   7   2   2   3   1
  midfield    55  40  33  19  17  12   7   0   3   0   0   0
  striker     13   7   6   2   2   2   1   1   0   0   0   0
  unknown      0   0   0   1   0   0   0   0   0   0   0   0
           18 19 20 21 22 23  24 25 26  27  28  29 30 31 32 33 34 35 36 37 38
defence     3  6 34 47 47 58  51 50 75  69  59  65 60 52 47 40 46 41 33 24 16
goalkeeper  2  6 15 22 29 23  20 18 18  21  13  15 11 15 16 16 14  8 13 10  5
midfield   10 19 44 77 98 95 112 93 93 103 110 109 71 80 63 53 55 40 33 19 17
striker     1  4  8 19 18 30  18 12 12  16  15  20  7 12 13  6 13  7  6  2  2
unknown     1  1  6  5  0  3   2  0  0   0   0   0  0  0  0  0  0  0  0  1  0
           39 40 41 42 43 44 46     
defence     9  2  1  0  0  0  0  935
goalkeeper  7  5  7  2  2  3  1  337
midfield   12  7  0  3  0  0  0 1416
striker     2  1  1  0  0  0  0  245
unknown     0  0  0  0  0  0  0   19
           18 19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34 35
defence     3  6  34  47  47  58  51  50  75  69  59  65  60  52  47  40  46 41
goalkeeper  2  6  15  22  29  23  20  18  18  21  13  15  11  15  16  16  14  8
midfield   10 19  44  77  98  95 112  93  93 103 110 109  71  80  63  53  55 40
striker     1  4   8  19  18  30  18  12  12  16  15  20   7  12  13   6  13  7
unknown     1  1   6   5   0   3   2   0   0   0   0   0   0   0   0   0   0  0
           17 36 107 170 192 209 203 173 198 209 197 209 149 159 139 115 128 96
           36 37 38 39 40 41 42 43 44 46     
defence    33 24 16  9  2  1  0  0  0  0  935
goalkeeper 13 10  5  7  5  7  2  2  3  1  337
midfield   33 19 17 12  7  0  3  0  0  0 1416
striker     6  2  2  2  1  1  0  0  0  0  245
unknown     0  1  0  0  0  0  0  0  0  0   19
           85 56 40 30 15  9  5  2  3  1 2952
</pre>

<div class="org-src-container">
<pre class="src src-R">barplot(tc, legend=T, col=c(<span style="color: #689f38;">"lightblue"</span>, <span style="color: #689f38;">"mistyrose"</span>, <span style="color: #689f38;">"lightcyan"</span>,
                                       <span style="color: #689f38;">"lavender"</span>, <span style="color: #689f38;">"cornsilk"</span>), xlab=<span style="color: #689f38;">"Et&#224;"</span>,
        ylab=<span style="color: #689f38;">"Frequenze"</span>, args.legend=list(x=<span style="color: #689f38;">"topright"</span>, title=<span style="color: #689f38;">"Ruoli"</span>))
</pre>
</div>


<div class="figure">
<p><img src="barplotgiocatori.png" alt="barplotgiocatori.png" />
</p>
</div>

<p>
Esempio 1.16
</p>
<div class="org-src-container">
<pre class="src src-R">ese116 <span style="color: #558b2f;">&lt;-</span> read.csv(<span style="color: #689f38;">"~/Nextcloud/Universit&#224;/2&#176; anno/Probabilit&#224; e Statistica per l'Informatica/Laboratorio/Lab 1/esempio1.16.csv"</span>,
                   sep=<span style="color: #689f38;">";"</span>, header=<span style="color: #0097A7;">TRUE</span>)
ese116
</pre>
</div>

<pre class="example">
   CaricoPrimaLesione.x. CaricoRottura.y.
1                   2550             4650
2                   2900             4650
3                   3000             4700
4                   3000             4750
5                   3000             4775
6                   3000             4775
7                   3250             4800
8                   3250             4950
9                   3250             5050
10                  3600             5100
11                  4225             5100
12                  4650             5150
13                  4750             5175
14                  5175             5250
15                  5300             5300
</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Scarto quadratico medio x</span>
sqrt(mean((ese116$CaricoPrimaLesione.x. - mean(ese116$CaricoPrimaLesione.x.))^2))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Scarto quadratico medio y</span>
sqrt(mean((ese116$CaricoRottura.y. - mean(ese116$CaricoRottura.y.))^2))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Covarianza</span>
mean((ese116$CaricoPrimaLesione.x. - mean(ese116$CaricoPrimaLesione.x.)) *
     (ese116$CaricoRottura.y - mean(ese116$CaricoRottura.y)))

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Correlazione</span>
cov(ese116$CaricoPrimaLesione.x., ese116$CaricoRottura.y.)/
    (sd(ese116$CaricoPrimaLesione.x.) * sd(ese116$CaricoRottura.y.))
</pre>
</div>

<pre class="example">
[1] 876.8219
[1] 219.6968
[1] 177133.3
[1] 0.9195286

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Retta di regressione</span>
rr <span style="color: #558b2f;">&lt;-</span> lm(ese116$CaricoRottura.y.~ ese116$CaricoPrimaLesione.x.)
rr
</pre>
</div>

<pre class="example">

Call:
lm(formula = ese116$CaricoRottura.y. ~ ese116$CaricoPrimaLesione.x.)

Coefficients:
                 (Intercept)  ese116$CaricoPrimaLesione.x.  
                   4101.7456                        0.2304

</pre>

<div class="org-src-container">
<pre class="src src-R">plot(ese116$CaricoPrimaLesione.x., ese116$CaricoRottura.y., xlab=<span style="color: #689f38;">"Carico prima lesione"</span>, ylab=<span style="color: #689f38;">"Carico rottura"</span>)
abline(rr, col=<span style="color: #689f38;">"red"</span>, lwd=2)
</pre>
</div>


<div class="figure">
<p><img src="regressionelineare.png" alt="regressionelineare.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Retta di regressione (non lineare)</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">rrnl &lt;- lm(ese116$CaricoRottura.y.~1 + ese116$CaricoPrimaLesione.x. +</span>
<span style="color: #607d8b;">#           </span><span style="color: #607d8b;">l(ese116$CaricoPrimaLesione.x.^2))</span>
rrnl <span style="color: #558b2f;">&lt;-</span> lm(ese116$CaricoRottura.y~ poly(ese116$CaricoPrimaLesione.x., 2, raw=T))
rrnl
</pre>
</div>

<pre class="example">

Call:
lm(formula = ese116$CaricoRottura.y ~ poly(ese116$CaricoPrimaLesione.x., 
    2, raw = T))

Coefficients:
                                    (Intercept)  
                                      2.893e+03  
poly(ese116$CaricoPrimaLesione.x., 2, raw = T)1  
                                      8.743e-01  
poly(ese116$CaricoPrimaLesione.x., 2, raw = T)2  
                                     -8.108e-05
</pre>

<div class="org-src-container">
<pre class="src src-R">plot(ese116$CaricoPrimaLesione.x., ese116$CaricoRottura.y., xlab=<span style="color: #689f38;">"Carico prima lesione"</span>, ylab=<span style="color: #689f38;">"Carico rottura"</span>)
lines(ese116$CaricoPrimaLesione.x., predict(rrnl), col=<span style="color: #689f38;">"green"</span>, lwd=2)
</pre>
</div>


<div class="figure">
<p><img src="regressionenonlineare.png" alt="regressionenonlineare.png" />
</p>
</div>

<p>
Esercizio 4:
</p>
<div class="org-src-container">
<pre class="src src-R">x <span style="color: #558b2f;">&lt;-</span> c(4, 8, 9, 12, 7)
y <span style="color: #558b2f;">&lt;-</span> c(17, 24, 25, 28, 26)

rr <span style="color: #558b2f;">&lt;-</span> lm(y~ x)
rr
</pre>
</div>

<pre class="example">

Call:
lm(formula = y ~ x)

Coefficients:
(Intercept)            x  
     13.882        1.265

</pre>

<div class="org-src-container">
<pre class="src src-R">plot(x, y, xlab=<span style="color: #689f38;">"x"</span>, ylab=<span style="color: #689f38;">"y"</span>)
abline(rr, col=<span style="color: #689f38;">"red"</span>, lwd=2)
</pre>
</div>


<div class="figure">
<p><img src="esregressionelineare.png" alt="esregressionelineare.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org1599a2e" class="outline-4">
<h4 id="org1599a2e"><span class="section-number-4">3.2.2</span> Calcolo delle Probabilità</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
Lo spazio campione in R è di solito rappresentato da un data frame:
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Per scaricare un pacchetto archiviato</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">require(devtools)</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">devtools::install_url('https://cran.r-project.org/src/contrib/Archive/prob/prob_1.0-0.tar.gz')</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Caricare il package prob</span>
<span style="color: #558b2f;">library</span>(prob)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Creare spazio campione</span>
tosscoin
cards
rolldie
urnsamples

t <span style="color: #558b2f;">&lt;-</span> tosscoin(2)
t
</pre>
</div>

<pre class="example">
Carico il pacchetto richiesto: combinat

Attaching package: ‘combinat’

The following object is masked from ‘package:utils’:

    combn

Carico il pacchetto richiesto: fAsianOptions
Carico il pacchetto richiesto: timeDate
Carico il pacchetto richiesto: timeSeries
Carico il pacchetto richiesto: fBasics
Carico il pacchetto richiesto: fOptions

Attaching package: ‘prob’

The following objects are masked from ‘package:base’:

    intersect, setdiff, union
function (times, makespace = FALSE) 
{
    temp &lt;- list()
    for (i in 1:times) {
        temp[[i]] &lt;- c("H", "T")
    }
    res &lt;- expand.grid(temp, KEEP.OUT.ATTRS = FALSE)
    names(res) &lt;- c(paste(rep("toss", times), 1:times, sep = ""))
    if (makespace) 
        res$probs &lt;- rep(1, 2^times)/2^times
    return(res)
}
&lt;bytecode: 0x556c8c5e7e90&gt;
&lt;environment: namespace:prob&gt;
function (jokers = FALSE, makespace = FALSE) 
{
    x &lt;- c(2:10, "J", "Q", "K", "A")
    y &lt;- c("Club", "Diamond", "Heart", "Spade")
    res &lt;- expand.grid(rank = x, suit = y)
    if (jokers) {
        levels(res$rank) &lt;- c(levels(res$rank), "Joker")
        res &lt;- rbind(res, data.frame(rank = c("Joker", "Joker"), 
            suit = c(NA, NA)))
    }
    if (makespace) {
        res$probs &lt;- rep(1, dim(res)[1])/dim(res)[1]
    }
    return(res)
}
&lt;bytecode: 0x556c8c5f4868&gt;
&lt;environment: namespace:prob&gt;
function (times, nsides = 6, makespace = FALSE) 
{
    temp = list()
    for (i in 1:times) {
        temp[[i]] &lt;- 1:nsides
    }
    res &lt;- expand.grid(temp, KEEP.OUT.ATTRS = FALSE)
    names(res) &lt;- c(paste(rep("X", times), 1:times, sep = ""))
    if (makespace) 
        res$probs &lt;- rep(1, nsides^times)/nsides^times
    return(res)
}
&lt;bytecode: 0x556c8c60b170&gt;
&lt;environment: namespace:prob&gt;
function (x, ...) 
UseMethod("urnsamples")
&lt;bytecode: 0x556c8c55cce0&gt;
&lt;environment: namespace:prob&gt;
  toss1 toss2
1     H     H
2     T     H
3     H     T
4     T     T
</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Spazio campione del lancio di un dado bilanciato a 6 facce</span>
r <span style="color: #558b2f;">&lt;-</span> rolldie(1)
r
</pre>
</div>

<pre class="example">
  X1
1  1
2  2
3  3
4  4
5  5
6  6

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Spazio campione (primi 6 elementi) di un mazzo composto da 52 carte</span>
c <span style="color: #558b2f;">&lt;-</span> cards()
head(c)
</pre>
</div>

<pre class="example">
  rank suit
1    2 Club
2    3 Club
3    4 Club
4    5 Club
5    6 Club
6    7 Club

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Spazio campione di un'urna di 3 palline numerate da 1 a 3 con estrazione 2 palline</span>
u <span style="color: #558b2f;">&lt;-</span> urnsamples(1:3, size=2, replace=<span style="color: #0097A7;">TRUE</span>, ordered=<span style="color: #0097A7;">TRUE</span>)
u
</pre>
</div>

<pre class="example">
  X1 X2
1  1  1
2  2  1
3  3  1
4  1  2
5  2  2
6  3  2
7  1  3
8  2  3
9  3  3
</pre>

<div class="org-src-container">
<pre class="src src-R">urnsamples(1:3, size=2, replace=<span style="color: #0097A7;">FALSE</span>, ordered=<span style="color: #0097A7;">TRUE</span>)
</pre>
</div>

<pre class="example">
  X1 X2
1  1  2
2  2  1
3  1  3
4  3  1
5  2  3
6  3  2

</pre>

<div class="org-src-container">
<pre class="src src-R">urnsamples(1:3, size=2, replace=<span style="color: #0097A7;">FALSE</span>, ordered=<span style="color: #0097A7;">FALSE</span>)
</pre>
</div>

<pre class="example">
  X1 X2
1  1  2
2  1  3
3  2  3

</pre>

<div class="org-src-container">
<pre class="src src-R">urnsamples(1:3, size=2, replace=<span style="color: #0097A7;">TRUE</span>, ordered=<span style="color: #0097A7;">FALSE</span>)
</pre>
</div>

<pre class="example">
  X1 X2
1  1  1
2  1  2
3  1  3
4  2  2
5  2  3
6  3  3

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Accedere ad alcuni elementi</span>
u[c(2, 4),]
</pre>
</div>

<pre class="example">
  X1 X2
2  2  1
4  1  2

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Accedere a sottoinsiemi con funzione subset</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Estrarre solo le carte di seme Spade</span>
x <span style="color: #558b2f;">&lt;-</span> subset(c, suit==<span style="color: #689f38;">"Spade"</span>)
x
</pre>
</div>

<pre class="example">
   rank  suit
40    2 Spade
41    3 Spade
42    4 Spade
43    5 Spade
44    6 Spade
45    7 Spade
46    8 Spade
47    9 Spade
48   10 Spade
49    J Spade
50    Q Spade
51    K Spade
52    A Spade
</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">%in%</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Estrarre solo le carte 5 e 6</span>
subset(c, rank <span style="color: #558b2f;">%in%</span> 5:6)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">subset(c, rank==6 | rank==5)</span>
</pre>
</div>

<pre class="example">
   rank    suit
4     5    Club
5     6    Club
17    5 Diamond
18    6 Diamond
30    5   Heart
31    6   Heart
43    5   Spade
44    6   Spade

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">isin()</span>
x1 <span style="color: #558b2f;">&lt;-</span> 1:10
y1 <span style="color: #558b2f;">&lt;-</span> 8:12
r1 <span style="color: #558b2f;">&lt;-</span> isin(x1, y1)

x2 <span style="color: #558b2f;">&lt;-</span> 1:10
y2=c(3, 3, 7)
r2 <span style="color: #558b2f;">&lt;-</span> isin(x2, y2)

x3 <span style="color: #558b2f;">&lt;-</span> 1:10
y3=c(3, 3, 7)
r3 <span style="color: #558b2f;">&lt;-</span> all(y3 <span style="color: #558b2f;">%in%</span> x3)

c(r1, r2, r3)
</pre>
</div>

<pre class="example">
[1] FALSE FALSE  TRUE

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Espressioni matematiche</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Somma delle facce dei 3 dadi maggiore di 14</span>
subset(rolldie(3), X1+X2+X3&gt;14)
</pre>
</div>

<pre class="example">
    X1 X2 X3
108  6  6  3
138  6  5  4
143  5  6  4
144  6  6  4
168  6  4  5
173  5  5  5
174  6  5  5
178  4  6  5
179  5  6  5
180  6  6  5
198  6  3  6
203  5  4  6
204  6  4  6
208  4  5  6
209  5  5  6
210  6  5  6
213  3  6  6
214  4  6  6
215  5  6  6
216  6  6  6
</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Somma delle due facce sia numero pari (%% modulo)</span>
subset(rolldie(2), ((X1+X2)<span style="color: #558b2f;">%%</span>2)==0)
</pre>
</div>

<pre class="example">
   X1 X2
1   1  1
3   3  1
5   5  1
8   2  2
10  4  2
12  6  2
13  1  3
15  3  3
17  5  3
20  2  4
22  4  4
24  6  4
25  1  5
27  3  5
29  5  5
32  2  6
34  4  6
36  6  6
</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Faccia del primo dado maggiore di quella del secondo</span>
subset(rolldie(2), (X1&gt;X2))
</pre>
</div>

<pre class="example">
   X1 X2
2   2  1
3   3  1
4   4  1
5   5  1
6   6  1
9   3  2
10  4  2
11  5  2
12  6  2
16  4  3
17  5  3
18  6  3
23  5  4
24  6  4
30  6  5
</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Insiemistica</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Unione di due subset A, B</span>
A <span style="color: #558b2f;">&lt;-</span> 0:3
B <span style="color: #558b2f;">&lt;-</span> 3:5
union(A, B)
</pre>
</div>

<pre class="example">
[1] 0 1 2 3 4 5

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Intersezione tra A, B</span>
intersect(A, B)
</pre>
</div>

<pre class="example">
[1] 3

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Differenza tra A, B</span>
setdiff(A, B)
</pre>
</div>

<pre class="example">
[1] 0 1 2

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">isrep(oggetto, valore, ripetizione)</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">verifica se in N compare 3 volte il valore red</span>
isrep(N, vals=<span style="color: #689f38;">"red"</span>, nrep=3)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Spazio di probabilit&#224;</span>
tosscoin(2, makespace=<span style="color: #0097A7;">TRUE</span>)
</pre>
</div>

<pre class="example">
  toss1 toss2 probs
1     H     H  0.25
2     T     H  0.25
3     H     T  0.25
4     T     T  0.25

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Hanno l'argomento makespace</span>
cards()
rolldie()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Spazio di probabilit&#224;</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">probspace(spazio campione, probabilit&#224;)</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">analogo a rolldie(1, makespace=TRUE)</span>
outcome=rolldie(1)
p=rep(1/6, times=6)
probspace(outcome, probs=p)
</pre>
</div>

<pre class="example">
  X1     probs
1  1 0.1666667
2  2 0.1666667
3  3 0.1666667
4  4 0.1666667
5  5 0.1666667
6  6 0.1666667

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Moneta sbilanciata</span>
probspace(tosscoin(1), probs=c(0.3, 0.7))
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">iidspace(c("H", "T"), ntrials=1, probs=c(0.3, 0.7))</span>
</pre>
</div>

<pre class="example">
  toss1 probs
1     H   0.3
2     T   0.7

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Calcolare la probabilit&#224; di un evento</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Prob(spazio di probabilit&#224;, evento)</span>
S <span style="color: #558b2f;">&lt;-</span> cards(makespace=<span style="color: #0097A7;">TRUE</span>)
A <span style="color: #558b2f;">&lt;-</span> subset(S, suit==<span style="color: #689f38;">"Heart"</span>)
Prob(A)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Prob(S, suit=="Heart")</span>
</pre>
</div>

<pre class="example">
[1] 0.25

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Permutazioni</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">factorial(n)</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Combinazioni semplici</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">choose(n, k)</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Numero di combinazioni di 8 elementi presi a gruppi di 2</span>
choose(8, 2)
</pre>
</div>

<pre class="example">
[1] 28

</pre>

<p>
Esercizio 1:
</p>
<ul class="org-ul">
<li>Supponiamo che 10 carte numerate da 1 a 10 vengano introdotte in un cappello e che una carta venga estratta a caso.
Vogliamo determinare:
<ul class="org-ul">
<li>Qual'è la probabilità che la carta estratta sia 10?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">carte <span style="color: #558b2f;">&lt;-</span> urnsamples(1:10, size=1)
prob <span style="color: #558b2f;">&lt;-</span> rep(1/10, times=10)
S <span style="color: #558b2f;">&lt;-</span> probspace(carte, probs=prob)
Prob(S, out==10)
</pre>
</div>

<pre class="example">
[1] 0.1

</pre>

<p>
Esercizio 3:
</p>
<ul class="org-ul">
<li>Si supponga che un'urna contenga 7 palline bianche e 5 nere. Supponiamo di estrarre 2 palline senza reimmissione.
Assumendo che ogni pallina possa essere estratta con egual probabilità,
<ul class="org-ul">
<li>Qual'è la probabilità che entrambe le palline estratte siano bianche?</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-R">L=rep(c(<span style="color: #689f38;">"white"</span>, <span style="color: #689f38;">"black"</span>), times=c(7, 5))
urn <span style="color: #558b2f;">&lt;-</span> urnsamples(L, size=2, replace=<span style="color: #0097A7;">FALSE</span>, ordered=<span style="color: #0097A7;">FALSE</span>)
space_urn <span style="color: #558b2f;">&lt;-</span> probspace(urn)
Prob(space_urn, isrep(space_urn, <span style="color: #689f38;">"white"</span>, 2))
</pre>
</div>

<pre class="example">
[1] 0.3181818

</pre>

<p>
Esercizio 10:
</p>
<ul class="org-ul">
<li>Un'urna contiene 3 biglie bianche e 2 biglie nere:
<ol class="org-ol">
<li>Calcolare la probabilità che estraendo in successione (senza reimbussolamento) 3 biglie almeno una sia nera;</li>
<li>Ripetere il punto precedente supponendo il reimbussolamento.</li>
</ol></li>
</ul>

<p>
1:
</p>
<div class="org-src-container">
<pre class="src src-R">urn <span style="color: #558b2f;">&lt;-</span> urnsamples(c(<span style="color: #689f38;">"B"</span>, <span style="color: #689f38;">"B"</span>, <span style="color: #689f38;">"B"</span>, <span style="color: #689f38;">"N"</span>, <span style="color: #689f38;">"N"</span>), size=3, ordered=<span style="color: #0097A7;">TRUE</span>)
space_urn <span style="color: #558b2f;">&lt;-</span> probspace(urn)
Prob(space_urn, X1==<span style="color: #689f38;">"N"</span> | X2==<span style="color: #689f38;">"N"</span> | X3==<span style="color: #689f38;">"N"</span>)
</pre>
</div>

<pre class="example">
[1] 0.9

</pre>

<p>
2:
</p>
<div class="org-src-container">
<pre class="src src-R">urn <span style="color: #558b2f;">&lt;-</span> urnsamples(c(<span style="color: #689f38;">"B"</span>, <span style="color: #689f38;">"B"</span>, <span style="color: #689f38;">"B"</span>, <span style="color: #689f38;">"N"</span>, <span style="color: #689f38;">"N"</span>), size=3, ordered=<span style="color: #0097A7;">TRUE</span>, replace=<span style="color: #0097A7;">TRUE</span>)
space_urn <span style="color: #558b2f;">&lt;-</span> probspace(urn)
Prob(space_urn, X1==<span style="color: #689f38;">"N"</span> | X2==<span style="color: #689f38;">"N"</span> | X3==<span style="color: #689f38;">"N"</span>)
</pre>
</div>

<pre class="example">
[1] 0.784

</pre>

<p>
Esercizio 19:
</p>
<ul class="org-ul">
<li>Da un mazzo regolare di 52 carte vengono estratte contemporaneamente 3 carte.
<ul class="org-ul">
<li>Qual'è la probabilità che le 3 carte estratte siano tutte di picche?</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-R">carte <span style="color: #558b2f;">&lt;-</span> urnsamples(cards(), 3, replace=<span style="color: #0097A7;">FALSE</span>, ordered=<span style="color: #0097A7;">FALSE</span>)
carte_space <span style="color: #558b2f;">&lt;-</span> probspace(carte)
Prob(carte_space, all(suit==<span style="color: #689f38;">"Club"</span>))
</pre>
</div>

<pre class="example">
[1] 0.01294118

</pre>

<p>
Esercizio 4:
</p>
<ul class="org-ul">
<li>Supponiamo che tre amici ad una festa gettino il proprio cappello sulla stessa sedia. Questi cappelli vengono
mescolati tra loro e, successivamente, i tre amici scelgono un cappello a caso.
<ul class="org-ul">
<li>Qual'è la probabilità che nessuno di loro venga in possesso del proprio cappello?</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-R">cappelli <span style="color: #558b2f;">&lt;-</span> urnsamples(c(<span style="color: #689f38;">"Cappello 1"</span>, <span style="color: #689f38;">"Cappello 2"</span>, <span style="color: #689f38;">"Cappello 3"</span>), 3, replace=<span style="color: #0097A7;">FALSE</span>, ordered=<span style="color: #0097A7;">TRUE</span>)
cappelli_space <span style="color: #558b2f;">&lt;-</span> probspace(cappelli)
Prob(cappelli_space, X1!=<span style="color: #689f38;">"Cappello 1"</span> &amp; X2!=<span style="color: #689f38;">"Cappello 2"</span> &amp; X3!=<span style="color: #689f38;">"Cappello 3"</span>)
</pre>
</div>

<pre class="example">
[1] 0.3333333

</pre>

<p>
Esercizio 5:
</p>
<ul class="org-ul">
<li>Viene estratta una pallina da un'urna che contiene 4 palline numerate da 1 a 4. Siano \(E = \{1, 2\}, F = \{1, 3\}, G = \{1, 4\}\).
Calcolare:
<ol class="org-ol">
<li>\(P(E)\);</li>
<li>\(P(E \cap G)\);</li>
<li>\(P(F \cap G)\);</li>
<li>\(P(E \cap F \cap G)\).</li>
</ol></li>
</ul>

<p>
1:
</p>
<div class="org-src-container">
<pre class="src src-R">urna <span style="color: #558b2f;">&lt;-</span> urnsamples(1:4, 1)
urna_space <span style="color: #558b2f;">&lt;-</span> probspace(urna)
E <span style="color: #558b2f;">&lt;-</span> c(1, 2)
F <span style="color: #558b2f;">&lt;-</span> c(1, 3)
G <span style="color: #558b2f;">&lt;-</span> c(1, 4)
Prob(urna_space, out <span style="color: #558b2f;">%in%</span> E)
</pre>
</div>

<pre class="example">
[1] 0.5

</pre>

<p>
2:
</p>
<div class="org-src-container">
<pre class="src src-R">Prob(urna_space, out <span style="color: #558b2f;">%in%</span> intersect(E, G))
</pre>
</div>

<pre class="example">
[1] 0.25

</pre>

<p>
3:
</p>
<div class="org-src-container">
<pre class="src src-R">Prob(urna_space, out <span style="color: #558b2f;">%in%</span> intersect(F, G))
</pre>
</div>

<pre class="example">
[1] 0.25

</pre>

<p>
4:
</p>
<div class="org-src-container">
<pre class="src src-R">Prob(urna_space, out <span style="color: #558b2f;">%in%</span> intersect(E, F, G))
</pre>
</div>

<pre class="example">
[1] 0.25

</pre>

<p>
Esercizio 10:
</p>
<ul class="org-ul">
<li>Un'urna contiene 3 biglie bianche e 2 biglie nere.
<ol class="org-ol">
<li>Calcolare la probabilità che estraendo in successione (senza reimbussolamento) 3 biglie almeno una sia nera;</li>
<li>Ripetere il punto precedente supponendo il reimbussolamento.</li>
</ol></li>
</ul>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Un'urna contiene 'b' (ex: b=3) biglie bianche e n (ex:n=2) biglie nere. </span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">a) Calcolare la probabilit&#224; che estraendo in successione </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">(senza reimbussolamento) 3 biglie almeno una sia 'k' (ex: nera).</span>




<span style="color: #607d8b;"># </span><span style="color: #607d8b;">b) Ripetere il punto precedente supponendo il reimbussolamento.</span>



<span style="color: #607d8b;">#</span><span style="color: #607d8b;">---------------------------------------------------------</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">importo la libreria prob</span>
<span style="color: #558b2f;">library</span>(prob)



<span style="color: #607d8b;"># </span><span style="color: #607d8b;">PARAMETRI </span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">b = num palline bianche nell'urna</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">n = num palline nere nell'urna</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">x = num di palline che estraiamo (ve volessimo aumentare il numero </span>
<span style="color: #607d8b;">#    </span><span style="color: #607d8b;">di palline estratte dovremmo modificare questo valore)</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">k = colore di cui vogliamo calcolare la probabilit&#224; di estrarre almeno una pallina</span>

b <span style="color: #558b2f;">&lt;-</span> 3
n <span style="color: #558b2f;">&lt;-</span> 2

x <span style="color: #558b2f;">&lt;-</span> 3
k <span style="color: #558b2f;">&lt;-</span> <span style="color: #689f38;">'n'</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">DATI</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">inizializzazione dell'array relativo all'urna</span>
y <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Cicli che inseriscono elementi nell'urna</span>

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1 : b){
  y <span style="color: #558b2f;">&lt;-</span> append(y, <span style="color: #689f38;">"b"</span>);
}

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1 : n){
  y <span style="color: #558b2f;">&lt;-</span> append(y, <span style="color: #689f38;">"n"</span>);
}




<span style="color: #607d8b;">#</span><span style="color: #607d8b;">------------------------------------------</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">PROCEDIMENTO:</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">a) Calcolatre la probabilit&#224; che estarendo in succesione (senza reimbussolamento)</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">x biglie almeno una sia k</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">CREAZIONE DELLO SPAZIO DELLE PROBABILIT&#224;</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">a-1) Creazione dello "Spazio degli eventi relativo all'urna"</span>

urn1 = urnsamples(y, x, replace = <span style="color: #0097A7;">FALSE</span>, ordered=<span style="color: #0097A7;">TRUE</span>)

numel = nrow(urn1)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">a-2) Generiamo un array indicante, in ogni posizione "i", la probabilit&#224; di </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">verificarsi dell'i-esimo evento dello "Spazio degli eventi" sopra definito.</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numel = numero degli elementi nell'urna</span>

p <span style="color: #558b2f;">&lt;-</span> rep(1/numel, times=numel)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">creazione dello spazio di probabilit&#224;</span>

space_urn1 = probspace(urn1, p)



<span style="color: #607d8b;">#</span><span style="color: #607d8b;">SOLUZIONE: Probabilit&#224; che entrambe le palline estratte siano del tipo "k" </span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">---&gt; se volessimo estrarre un numero di palline maggiore di 3 dovremmo aggiungere</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">nuove condizioni Xi == k come secondo argomento della funzione Prob.</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">ad esempio se volessimo estrarre 4 palline la funzione prob diventerebbe:</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">out &lt;- Prob(space_urn1, X1==k | X2 == k | X3 == k | X4==k)</span>

out <span style="color: #558b2f;">&lt;-</span> Prob(space_urn1, X1==k | X2 == k | X3 == k)








<span style="color: #607d8b;"># </span><span style="color: #607d8b;">b) Ripetere il punto precedente supponendo il reimbussolamento</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">CREAZIONE DELLO SPAZIO DELLE PROBABILIT&#224;</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">b-1) Creazione dello "Spazio degli eventi relativo all'urna"</span>

urn2 = urnsamples(y, x, replace = <span style="color: #0097A7;">TRUE</span>, ordered=<span style="color: #0097A7;">TRUE</span>)

numel2 = nrow(urn2)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">a-2) Generiamo un array indicante, in ogni posizione "i", la probabilit&#224; di </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">verificarsi dell'i-esimo evento dello "Spazio degli eventi" sopra definito.</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numel = numero degli elementi nell'urna</span>

p2 <span style="color: #558b2f;">&lt;-</span> rep(1/numel2, times=numel2)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">creazione dello spazio di probabilit&#224;</span>

space_urn2 = probspace(urn2, p2)



<span style="color: #607d8b;">#</span><span style="color: #607d8b;">SOLUZIONE: Probabilit&#224; che entrambe le palline estratte siano del tipo "k" </span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">---&gt; se volessimo estrarre un numero di palline maggiore di 3 dovremmo aggiungere</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">nuove condizioni Xi == k come secondo argomento della funzione Prob.</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">ad esempio se volessimo estrarre 4 palline la funzione prob diventerebbe:</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">out2 &lt;- Prob(space_urn2, X1==k | X2 == k | X3 == k | X4== k)</span>

out2 <span style="color: #558b2f;">&lt;-</span> Prob(space_urn2, X1==k | X2 == k | X3 == k)
</pre>
</div>
<p>
Esercizio 11:
</p>
<ul class="org-ul">
<li>Una squadra di calcio chiera ad ogni partita 1 portiere, 5 difensori e 5 attaccanti. La sociatà "Aleas" sceglie
in modo casuale ciascun gruppo di giocatori tra 2 portieri, 8 difensori e 12 attaccanti disponibili.
<ol class="org-ol">
<li>Quante sono le formazioni possibili?</li>
<li>Se Roberto e Ronaldo sono due attaccanti, quante sono le formazioni in cui giocano entrambi?</li>
<li>Se Franco è un difensore, quante sono le formazioni in cui gioca con l'attaccante Roberto?</li>
</ol></li>
</ul>

<p>
1:
</p>
<div class="org-src-container">
<pre class="src src-R">p <span style="color: #558b2f;">&lt;-</span> 2
d <span style="color: #558b2f;">&lt;-</span> 8
a <span style="color: #558b2f;">&lt;-</span> 12

cp <span style="color: #558b2f;">&lt;-</span> choose(p, 1)
cd <span style="color: #558b2f;">&lt;-</span> choose(d, 5)
da <span style="color: #558b2f;">&lt;-</span> choose(a, 5)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Numero di formazioni possibili</span>
cp*cd*da
</pre>
</div>

<pre class="example">
[1] 88704

</pre>

<p>
2:
</p>
<div class="org-src-container">
<pre class="src src-R">ca <span style="color: #558b2f;">&lt;-</span> choose(a-2, 3)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Numero di formazioni in cui giocano 2 attaccanti scelti</span>
cp*cd*ca 
</pre>
</div>

<pre class="example">
[1] 13440

</pre>

<p>
3:
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Ridondante: sono uguali</span>
ca <span style="color: #558b2f;">&lt;-</span> choose(a-1, 4)
cd <span style="color: #558b2f;">&lt;-</span> choose(d-1, 4)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Numero di formazioni in cui giocano 1 attaccante e un difensore scelto</span>
cp*cd*ca
</pre>
</div>

<pre class="example">
[1] 23100

</pre>

<p>
Esercizio 17:
</p>
<ul class="org-ul">
<li>Si supponga di estrarre contemporaneamente 13 carte da un mazzo di 52. Si calcoli la probabilità che le carte
estratte contengano:
<ol class="org-ol">
<li>Il 3 di cuori;</li>
<li>Una sola carta di quadri;</li>
<li>3 carte di picche e 5 carte di quadri;</li>
<li>Solo 3 figure.</li>
</ol></li>
</ul>

<p>
1:
</p>
<div class="org-src-container">
<pre class="src src-R">combTot <span style="color: #558b2f;">&lt;-</span> choose(52, 13)
comb3Cuori <span style="color: #558b2f;">&lt;-</span> choose(51, 12)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Probabilit&#224; di estrarre il 3 di cuori</span>
comb3Cuori/combTot
</pre>
</div>

<pre class="example">
[1] 0.25

</pre>

<p>
2:
</p>
<div class="org-src-container">
<pre class="src src-R">comb1CartaQuadri <span style="color: #558b2f;">&lt;-</span> 13*choose(39, 12)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Probabilit&#224; di estrarre solo una carta di quadri</span>
comb1CartaQuadri/combTot
</pre>
</div>

<pre class="example">
[1] 0.08006186

</pre>

<p>
3:
</p>
<div class="org-src-container">
<pre class="src src-R">comb3Picche5Quadri <span style="color: #558b2f;">&lt;-</span> choose(13, 3)*choose(13, 5)*choose(26, 5)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Probabilit&#224; di estrarre 3 carte di picche e 5 di quadri</span>
comb3Picche5Quadri/combTot
</pre>
</div>

<pre class="example">
[1] 0.038129

</pre>

<p>
4:
</p>
<div class="org-src-container">
<pre class="src src-R">comb3Figure <span style="color: #558b2f;">&lt;-</span> choose(12, 3)*choose(40, 10)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Probabilit&#224; di estrarre solo 3 figure</span>
comb3Figure/combTot
</pre>
</div>

<pre class="example">
[1] 0.2936714

</pre>
<p>
Esercizio 29:
</p>
<ul class="org-ul">
<li>Un mazzo di carte napoletane costituito da 40 carte suddivise in 4 classi (detti "semi") ciascuna contenente 10 carte
numerate. Supponiamo di estrarre "a caso" 8 carte da un tale mazzo.
<ol class="org-ol">
<li>Calcolare la probabilità di estrarre i 4 "sette";</li>
<li>Calcolare la probabilità di estrarre al più 2 "sei";</li>
<li>Calcolare la probabilità di estrarre "4 sette" e al più 2 "sei".</li>
</ol></li>
</ul>

<p>
1:
</p>
<div class="org-src-container">
<pre class="src src-R">combTot <span style="color: #558b2f;">&lt;-</span> choose(40, 8)
comb4Sette <span style="color: #558b2f;">&lt;-</span> choose(36, 4)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Probabilit&#224; di estrarre i 4 "sette"</span>
prob4Sette <span style="color: #558b2f;">&lt;-</span> comb4Sette/combTot
prob4Sette
</pre>
</div>

<pre class="example">
[1] 0.0007659481

</pre>

<p>
2:
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">combMax2Sei &lt;- choose(36, 8) + 4*choose(36, 7) + choose(4, 2)*choose(36, 6)</span>
combMin3Sei <span style="color: #558b2f;">&lt;-</span> choose(4, 3)*choose(36, 5) + choose(36, 4)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Probabilit&#224; di estrarre al pi&#249; 2 "sei"</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">combMax2Sei/combTot</span>
probMax2Sei <span style="color: #558b2f;">&lt;-</span> 1 - combMin3Sei/combTot
probMax2Sei
</pre>
</div>

<pre class="example">
[1] 0.9796258

</pre>

<p>
3:
</p>
<div class="org-src-container">
<pre class="src src-R">probTot4Carte <span style="color: #558b2f;">&lt;-</span> choose(36, 4)
combMin3Sei4Carte <span style="color: #558b2f;">&lt;-</span> choose(4, 3)*choose(36, 1) + 1
probMax2Sei4Carte <span style="color: #558b2f;">&lt;-</span> 1 - combMin3Sei4Carte/probTot4Carte

prob4SetteMax2Sei <span style="color: #558b2f;">&lt;-</span> prob4Sette*probMax2Sei4Carte
prob4SetteMax2Sei
</pre>
</div>

<pre class="example">
[1] 0.0007640627

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Esercizio 29</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Un mazzo di carte napoletane costituito da 40 carte suddivise in 4 classi (detti "semi") </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">ciascuna contenente 10 carte numerate. Supponiamo di estrarre "a caso" n carte da un tale mazzo.</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">a) Calcolare la probabilit&#224; di estrarre n7 (ex: n7=4) "sette".</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">b) Calcolare la probabilit&#224; di estrarre al pi&#249; n6 (ex: n6=2) "sei".</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">c) Calcolare la probabilit&#224; di estrarre "n7 sette" e al pi&#249; n6 "sei".</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">---------------------------------------------------------</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">importo la libreria prob</span>
<span style="color: #558b2f;">library</span>(prob)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">PARAMETRI </span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">n =  numero di carte estratte dal mazzo</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">n7 = numero di sette nel punto a) e c)</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">n6 = numero di sei nel punto b) e c)</span>


n <span style="color: #558b2f;">&lt;-</span> 8

n7 <span style="color: #558b2f;">&lt;-</span> 4

n6 <span style="color: #558b2f;">&lt;-</span> 2

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">-----------------------------</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">SOLUZIONE</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">a) probabilit&#224; di estrarre n7 sette</span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">possibili combinazioni di n elementi estratti dal mazzo di 40 carte</span>

CasiPoss <span style="color: #558b2f;">&lt;-</span> choose(40,8)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numero di passibili combinazioni in cui n7 sono carte di "sette"</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">mentre (n - n7) carte non sono "sette"</span>

CasiFavA <span style="color: #558b2f;">&lt;-</span> choose(4, n7)*choose(40-4, n-n7) 

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">soluzione:</span>

out1 <span style="color: #558b2f;">&lt;-</span> CasiFavA/CasiPoss 


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">-------------------------------</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">b) Calcolare la probabilit&#224; di estrarre al pi&#249; n6 "sei"</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">p conterr&#224; la probabilit&#224; di estrarre "i" n6</span>

p <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">per ogni i -&gt; p[i] = probabilit&#224; di estrarre 'i' carte di "sei"</span>
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 0:n6){
  p[i+1] = (choose(4,i)*choose(40-4, n-i) ) / CasiPoss
}

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">sommo le probabilit&#224; sopra generate</span>
out2 <span style="color: #558b2f;">&lt;-</span> sum(p)


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">-------------------------------</span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">c) Calcolare la probabilit&#224; di estrarre n7 "sette" e n6 "sei"</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">dobbiamo calcolare le probabilit&#224; congiunte:</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">per ogni i -&gt; pA[i] = probabilit&#224; di estrarre 'i' carte di "sei" e n7 carte di "sette"</span>
pA <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">pA contiene, per ogni 'i', la probabilit&#224; di esatrarre n7 </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">carte di "sette" ed i carte di "sei"</span>

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 0:n6){
  pA[i+1] = (choose(4,n7)*choose(4,i)*choose(40-4-4, n-i-n7) ) / CasiPoss
}

out3 <span style="color: #558b2f;">&lt;-</span> sum(pA)
</pre>
</div>
<p>
Esercizio 30:
</p>
<ul class="org-ul">
<li>Consideriamo un mazzo di 40 carte suddivise in 4 classi (detti "semi") ciascuna contenente 10 carte numerate
da 1 a 10. Ogni mano servita è formata da 5 carte estratte dal mazzo.
<ol class="org-ol">
<li>Calcolare la probabilità di ricevere una mano che contiene i numeri 6, 7, 8, 9, 10;</li>
<li>Calcolare la probabilità di ricevere una mano che contiene 5 numeri distinti.</li>
</ol></li>
</ul>

<div class="org-src-container">
<pre class="src src-R">combTot <span style="color: #558b2f;">&lt;-</span> choose(40, 5)
comb5Numeri <span style="color: #558b2f;">&lt;-</span> 4^5

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
prob5Numeri <span style="color: #558b2f;">&lt;-</span> comb5Numeri/combTot
prob5Numeri

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
prob5NumeriDistinti <span style="color: #558b2f;">&lt;-</span> prob5Numeri*choose(10, 5)
prob5NumeriDistinti
</pre>
</div>

<pre class="example">
[1] 0.001556212
[1] 0.3921654

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Esercizio 29</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Consideriamo un mazzo di 40 carte suddivise in 4 classi (detti "semi") </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">ciascuna contenente 10 carte numerate da 1 a 10. Ogni mano servita &#232; </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">formata da n (ex: n=5) carte estratte dal mazzo.</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">a) Calcolare la probabilit&#224; di avere una mano formata dai numeri da </span>
<span style="color: #607d8b;">#    </span><span style="color: #607d8b;">1 a n (ex: con n=5 -&gt; mano="1","2", "3", "4", "5")</span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">b) Calcolare la probabilit&#224; di ricevere una mano che contiene n carte con numero</span>
<span style="color: #607d8b;">#    </span><span style="color: #607d8b;">diverso</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">---------------------------------------------------------</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">importo la libreria prob</span>
<span style="color: #558b2f;">library</span>(prob)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">PARAMETRI </span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">n = numero di carte con cui &#232; formata una mano</span>


n <span style="color: #558b2f;">&lt;-</span> 5

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">-----------------------------</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">SOLUZIONE</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">a) Calcolare la probabilit&#224; di avere una mano formata dai numeri da </span>
<span style="color: #607d8b;">#    </span><span style="color: #607d8b;">1 a n (ex: con n=5 -&gt; mano="1","2", "3", "4", "5")</span>

out1 <span style="color: #558b2f;">&lt;-</span> 1;


<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> n : 1){
  
  <span style="color: #607d8b;"># </span><span style="color: #607d8b;">probabilit&#224; di estrarre una carta di tipo diverso sapendo che </span>
  <span style="color: #607d8b;"># </span><span style="color: #607d8b;">sono gi&#224; state estratte 'i' carte tra loro di tipo diverso </span>
  
  temp <span style="color: #558b2f;">&lt;-</span> (4*i/(40-(5-i)))
  
  <span style="color: #607d8b;"># </span><span style="color: #607d8b;">calcolo del risultato finale del punto a) in forma ricorsiva</span>
  
  out1 <span style="color: #558b2f;">&lt;-</span> out1 * temp

}


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">-------------------------------</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">b) Calcolare la probabilit&#224; di ricevere una mano che contiene n carte con numero</span>
<span style="color: #607d8b;">#    </span><span style="color: #607d8b;">diverso</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numero di possibili combinazioni di 10 carte con numeri diversi per una mano di n elementi</span>
temp2 <span style="color: #558b2f;">&lt;-</span> choose(10,n)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">soluzione</span>
out2 <span style="color: #558b2f;">&lt;-</span> temp2*out1
</pre>
</div>

<p>
Esercizio 34:
</p>
<ul class="org-ul">
<li>Scegliamo 3 carte a caso fra un mazzo di 52 carte da gioco.
<ol class="org-ol">
<li>Qual'è la probabilità che 2 siano assi e una sia un 10?</li>
<li>Qual'è la probabilità che almeno 2 siano figure?</li>
<li>Qual'è la probabilità che almeno 2 siano figure e nessuna sia un asso?</li>
</ol></li>
</ul>

<div class="org-src-container">
<pre class="src src-R">combTot <span style="color: #558b2f;">&lt;-</span> choose(52, 3)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
comb2Assi1Dieci <span style="color: #558b2f;">&lt;-</span> choose(4, 2)*4
prob2Assi1Dieci <span style="color: #558b2f;">&lt;-</span> comb2Assi1Dieci/combTot
prob2Assi1Dieci

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
combMin2Figure <span style="color: #558b2f;">&lt;-</span> choose(12, 2)*40 + choose(12, 3)
probMin2Figure <span style="color: #558b2f;">&lt;-</span> combMin2Figure/combTot
probMin2Figure

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>

comb2Figure1Asso <span style="color: #558b2f;">&lt;-</span> choose(12, 2)*4
probMin2Figure1Asso <span style="color: #558b2f;">&lt;-</span>probMin2Figure - comb2Figure1Asso/combTot
probMin2Figure1Asso
</pre>
</div>

<pre class="example">
[1] 0.001085973
[1] 0.1294118
[1] 0.1174661

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Esercizio 34</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Scegliamo tre carte a caso fra un mazzo di 52 carte da gioco </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">(divise in quattro semi con ciascuno tre figure: fante, donna, re).</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">1) Qual'&#232; la probabilit&#224; che nA siano assi e n10 siano dieci?</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">2) Qual'&#232; la probabilit&#224; che almeno nF1 siano figure?</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">3) Qual'&#232; la probabilit&#224; che almeno nF2 siano figure e nessuno sia asso</span>



<span style="color: #607d8b;">#</span><span style="color: #607d8b;">---------------------------------------------------------</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">importo la libreria prob</span>
<span style="color: #558b2f;">library</span>(prob)



<span style="color: #607d8b;"># </span><span style="color: #607d8b;">PARAMETRI </span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">nA = numero di assi che si desidera estrarre nel primo punto</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">n10 = numero di 10 che si desidera estrarre nel primo punto</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">totEstr = numero totale di carte che si vuole estrarre</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">nF1 = numero minimo di figure che si vogliono estrarre nel punto 2</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">nF2 = numero minimo di figure che si vogliono estrarre nel punto 3</span>

nA <span style="color: #558b2f;">&lt;-</span> 2
n10 <span style="color: #558b2f;">&lt;-</span> 1
totEstr <span style="color: #558b2f;">&lt;-</span> 3


nF1 <span style="color: #558b2f;">&lt;-</span> 2

nF2 <span style="color: #558b2f;">&lt;-</span> 2

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">------------------------------------------</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">SOLUZIONE</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">1) Qual'&#232; la probabilit&#224; che nA siano assi e n10 siano dieci?</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">combinazioni possibili di estrazione di nA assi</span>
temp1 <span style="color: #558b2f;">&lt;-</span> choose(4,nA)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">combinazioni possibili di estrazione di n10 dieci</span>
temp2 <span style="color: #558b2f;">&lt;-</span> choose(4,n10)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">casi possibili</span>

den <span style="color: #558b2f;">&lt;-</span> choose(52,totEstr)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">soluzione:</span>

out <span style="color: #558b2f;">&lt;-</span> (temp1*temp2)/den


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">------------------------------</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">2) Qual'&#232; la probabilit&#224; che almeno nF1 siano figure?</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numero di possibili combinazioni di estrazioni di almeno nF1 figure</span>
num2 <span style="color: #558b2f;">&lt;-</span> 0

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> totEstr : nF1){
  num2 <span style="color: #558b2f;">&lt;-</span> num2 + choose(12,i)*choose(40, totEstr-i)
}

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">casi possibili</span>
den <span style="color: #558b2f;">&lt;-</span> choose(52,totEstr)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">soluzione:</span>

out2 <span style="color: #558b2f;">&lt;-</span> num2/den

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">------------------------------</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">3) Qual'&#232; la probabilit&#224; che almeno nF2 siano figure e nessuno sia asso</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numero di possibili combinazioni di estrazioni di almeno nF2 figure</span>
num3 <span style="color: #558b2f;">&lt;-</span> 0

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> totEstr : nF2){
  num3 <span style="color: #558b2f;">&lt;-</span> num3 + choose(12,i)*choose(36, totEstr-i)
}

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">casi possibili</span>
den <span style="color: #558b2f;">&lt;-</span> choose(52,totEstr)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">soluzione:</span>

out3 <span style="color: #558b2f;">&lt;-</span> num3/den
</pre>
</div>

<p>
Probabilità condizionata:
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Prob(spazio di probabilit&#224;, evento, osservazione)</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Calcolare la probabilit&#224; che lanciando 2 dadi esca la stess faccia</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">dato che la loro somma &#232; maggiore o uguale a 8</span>
S=rolldie(2, makespace=<span style="color: #0097A7;">TRUE</span>)
Prob(S, X1==X2, given=(X1+X2&gt;=8))
</pre>
</div>

<pre class="example">
[1] 0.2

</pre>

<p>
Esercizio 1:
</p>
<ul class="org-ul">
<li>Supponiamo che 10 carte numerate da 1 a 10 vengano introdotte in un cappello e che una carta venga estratta a caso.
<ul class="org-ul">
<li>Sapendo che la carta estratta è maggiore di 4, qual'è la probabilità che sia 10?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">carte <span style="color: #558b2f;">&lt;-</span> urnsamples(1:10, size=1)
prob <span style="color: #558b2f;">&lt;-</span> rep(1/10, times=10)
S <span style="color: #558b2f;">&lt;-</span> probspace(carte, probs=prob)
Prob(S, out==10, given=out&gt;4)
</pre>
</div>

<pre class="example">
[1] 0.1666667

</pre>

<p>
Esercizio 2:
</p>
<ul class="org-ul">
<li>In una famiglia vi sono 2 figli. Qual'è la probabilità che entrambi siano maschi dato che almeno uno di loro è maschio?</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">figli <span style="color: #558b2f;">&lt;-</span> urnsamples(c(<span style="color: #689f38;">"M"</span>, <span style="color: #689f38;">"F"</span>), size=2, replace=T, ordered=T)
urn_figli <span style="color: #558b2f;">&lt;-</span> probspace(figli)
Prob(urn_figli, X1==<span style="color: #689f38;">"M"</span> &amp; X2==<span style="color: #689f38;">"M"</span>, given=(X1==<span style="color: #689f38;">"M"</span> | X2==<span style="color: #689f38;">"M"</span>))
</pre>
</div>

<pre class="example">
[1] 0.3333333

</pre>

<p>
Formula del prodotto:
</p>
<ul class="org-ul">
<li>Esempio 2.10:
<ul class="org-ul">
<li>Consideriamo un'urna contenente 2 palline Blu, 1 Rossa e 1 Verde e supponiamo di effettuare 3 estrazioni, lasciando fuori
dall'urna le palline già estratte. Si vuole calcolare la probabilità che:
<ol class="org-ol">
<li>La prima volta venga estratta una pallina blu;</li>
<li>La seconda volta venga estratta la pallina rossa;</li>
<li>La terza volta venga estratta la pallina verde.</li>
</ol></li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">urn <span style="color: #558b2f;">&lt;-</span> urnsamples(c(<span style="color: #689f38;">"R"</span>, <span style="color: #689f38;">"B"</span>, <span style="color: #689f38;">"B"</span>, <span style="color: #689f38;">"V"</span>), 3, ordered=T)
urn_sample <span style="color: #558b2f;">&lt;-</span> probspace(urn)
Prob(urn_sample, X1==<span style="color: #689f38;">"B"</span> &amp; X2==<span style="color: #689f38;">"R"</span> &amp; X3==<span style="color: #689f38;">"V"</span>)
</pre>
</div>

<pre class="example">
[1] 0.08333333

</pre>

<p>
Formula delle probabilità totali:
</p>
<ul class="org-ul">
<li>Esempio 2.10.1:
<ul class="org-ul">
<li>Una compagnia di assicurazioni ritiene che i guidatori appartengano a due categorie. Facili agli incidenti e non facili.
Le statistiche dicono che un guidatore f.a.i. ha probabilità 0.4 di fare un incidente nell'anno mentre uno non
f.a.i. ha probabilità 0.2. Supponiamo che il 30% dei guidatori sia f.a.i., qual'è la probabilità che un nuovo
guidatore abbia un incidente nell'anno?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">prior <span style="color: #558b2f;">&lt;-</span> c(0.3, 0.7)
inc <span style="color: #558b2f;">&lt;-</span> c(0.4, 0.2)
sum(prior*inc)
</pre>
</div>

<pre class="example">
[1] 0.26

</pre>

<p>
Formula di Bates:
</p>
<ul class="org-ul">
<li>Esempio 2.11:
<ul class="org-ul">
<li>Supponiamo di aver effettuato un'indagine sugli individui in età lavorativa abitanti in un quartiere di una data
città italiana, e di aver riscontrato che il 40% di tali individui ha la licenza elementare o media, il 50% ha un
titolo di scuola superiore mentre il restante 10% è laureato. Una seconda indagine ha permesso di rilevare i tassi
di disoccupazione tra i tre gruppi di individui che risultano essere rispettivamente: 15%, 5% e 10%.
<ul class="org-ul">
<li>Supponiamo che l'individuo estratto è disoccupato, qual'è la probabilità che esso sia laureato?</li>
</ul></li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">Occ <span style="color: #558b2f;">&lt;-</span> c(0.4, 0.5, 0.1)
Dis <span style="color: #558b2f;">&lt;-</span> c(0.15, 0.05, 0.1)
num <span style="color: #558b2f;">&lt;-</span> Occ*Dis
Ptot <span style="color: #558b2f;">&lt;-</span> sum(num)
num/Ptot
</pre>
</div>

<pre class="example">
[1] 0.6315789 0.2631579 0.1052632

</pre>

<p>
Esercizio 1:
</p>
<ul class="org-ul">
<li>Supponiamo che 10 carte numerate da 1 a 10 vengano introdotte in un cappello e che una carta venga estratta a caso.
Vogliamo determinare:
<ol class="org-ol">
<li>Qual'è la probabilità che la carta estratta sia 10?</li>
<li>Sapendo che la carta estratta è maggiore di 4, qual'è la probabilità che sia un 10?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">carte <span style="color: #558b2f;">&lt;-</span> urnsamples(1:10, 1)
carte_space <span style="color: #558b2f;">&lt;-</span> probspace(carte)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
Prob(carte_space, out==10)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
Prob(carte_space, out==10, given=out&gt;4)
</pre>
</div>

<pre class="example">
[1] 0.1
[1] 0.1666667

</pre>

<p>
Esercizio 2:
</p>
<ul class="org-ul">
<li>In una famiglia vi sono 2 figli. Qual'è la probabilità che entrambi siano maschi dato che almeno uno di loro è maschio?</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Esercizio 2: In una famiglia vi sono 2 figli. </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Qual &#232; la probabilit&#224; che entrambi siano 'k' (ad esempio 'maschi') </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">dato che almeno uno di loro &#232; 'k'? </span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">---------------------------------------------------------</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">importo la libreria prob</span>
<span style="color: #558b2f;">library</span>(prob)



<span style="color: #607d8b;"># </span><span style="color: #607d8b;">PARAMETRI INPUT</span>
n <span style="color: #558b2f;">&lt;-</span> 2

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numero di figli</span>
k <span style="color: #558b2f;">&lt;-</span> <span style="color: #689f38;">'m'</span> <span style="color: #607d8b;"># </span><span style="color: #607d8b;">pu&#242; essere 'm' o 'f'</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">DATI</span>


figli <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">'m'</span>, <span style="color: #689f38;">'f'</span>)




<span style="color: #607d8b;">#</span><span style="color: #607d8b;">------------------------------------------</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">PROCEDIMENTO:</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">CREAZIONE DELLO SPAZIO DELLE PROBABILIT&#224;</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">1) creazione dello spazio di probabilit&#224; relativo alle possibili </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">combinazioni di figli all'interno della famiglia</span>


space=iidspace(figli, n, probs = <span style="color: #0097A7;">NULL</span>)




<span style="color: #607d8b;">#</span><span style="color: #607d8b;">SOLUZIONE: Probabilit&#224; che entrambi i figli siano 'k' dato che almeno uno &#232; 'k'</span>

out <span style="color: #558b2f;">&lt;-</span> Prob(space, X1==X2, (X1==k| X2==k))


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">OSSERVAZIONE: se volessimo adattare il problema ad numero 'n' di figli</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">dovremmo modificare:</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">1) il parametro n della parte iniziale </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">2) l'istruzione per calcolare la soluzione. Esattamente dovremmo </span>
<span style="color: #607d8b;">#   </span><span style="color: #607d8b;">estendere le due condizioni a "n" Xi.</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Facciamo un esempio: se al posto di 2 volessi eseguire il problema con 3 figli</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">la soluzione dovrebbe essere calcolata facendo:</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">out &lt;- Prob(space, (X1==X2 &amp; X2==X3), (X1==k| X2==k | X3==k))</span>
</pre>
</div>

<p>
Esercizio 3:
</p>
<ul class="org-ul">
<li>Si supponga che un'urna contenga 7 palline bianche e 5 nere. Supponiamo di estrarre 2 palline senza reimmissione.
Assumendo che ogni pallina possa essere estratta con egual probabilità,
<ul class="org-ul">
<li>Qual'è la probabilità che entrambe le palline estratte siano bianche?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">palline <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:7) {
  palline <span style="color: #558b2f;">&lt;-</span> append(palline, <span style="color: #689f38;">"B"</span>)
}
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:5) {
  palline <span style="color: #558b2f;">&lt;-</span> append(palline, <span style="color: #689f38;">"N"</span>)
}
urna <span style="color: #558b2f;">&lt;-</span> urnsamples(palline, 2, replace=<span style="color: #0097A7;">FALSE</span>, ordered=<span style="color: #0097A7;">FALSE</span>)
urna_space <span style="color: #558b2f;">&lt;-</span> probspace(urna)

Prob(urna_space, X1==<span style="color: #689f38;">"B"</span> &amp; X2==<span style="color: #689f38;">"B"</span>)
</pre>
</div>

<pre class="example">
[1] 0.3181818

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Esercizio 3: Si supponga che un'urna contenga 7  palline  bianche  e  5  nere.  </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Supponiamo  di  estrarre  due  palline  senza reimmissione. </span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Assumendo che ogni pallina possa essere estratta con egual probabilit&#224;, </span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">       Qual &#232; la probabilit&#224; che entrambe le palline estratte siano del tipo "k" (ex: siano bianche)?</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">---------------------------------------------------------</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">importo la libreria prob</span>
<span style="color: #558b2f;">library</span>(prob)



<span style="color: #607d8b;"># </span><span style="color: #607d8b;">PARAMETRI </span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">b = num palline bianche nell'urna</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">n = num palline nere nell'urna</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">k = colore di cui vogliamo calcolare la probabilit&#224; di estrarre palline</span>

b <span style="color: #558b2f;">&lt;-</span> 7
n <span style="color: #558b2f;">&lt;-</span> 5

k <span style="color: #558b2f;">&lt;-</span> <span style="color: #689f38;">"b"</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">DATI</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">inizializzazione dell'array relativo all'urna</span>
y <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Cicli che inseriscono elementi nell'urna</span>

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1 : b){
  y <span style="color: #558b2f;">&lt;-</span> append(y, <span style="color: #689f38;">"b"</span>);
}

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1 : n){
  y <span style="color: #558b2f;">&lt;-</span> append(y, <span style="color: #689f38;">"n"</span>);
}


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">calcolo numero elementi nell'urna</span>
numel = nsamp(b+n, 2, replace=<span style="color: #0097A7;">FALSE</span>)


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">------------------------------------------</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">PROCEDIMENTO:</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">CREAZIONE DELLO SPAZIO DELLE PROBABILIT&#224;</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">1) Creazione dello "Spazio degli eventi relativo all'urna"</span>

urn = urnsamples(y, 2, replace = <span style="color: #0097A7;">FALSE</span>, ordered=<span style="color: #0097A7;">FALSE</span>)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">2) Generiamo un array indicante, in ogni posizione "i", la probabilit&#224; di </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">verificarsi dell'i-esimo evento dello "Spazio degli eventi" sopra definito.</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numel = numero degli elementi nell'urna</span>

p <span style="color: #558b2f;">&lt;-</span> rep(1/numel, times=numel)



<span style="color: #607d8b;"># </span><span style="color: #607d8b;">creazione dello spazio di probabilit&#224;</span>

space_urn = probspace(urn, p)



<span style="color: #607d8b;">#</span><span style="color: #607d8b;">SOLUZIONE: Probabilit&#224; che entrambe le palline estratte siano del tipo "k" </span>

out = Prob(space_urn, X1==X2 &amp; X1==k)
</pre>
</div>
<p>
Esercizio 6:
</p>
<ul class="org-ul">
<li>Si considerino 2 urne. La prima contiene 2 palline bianche e 7 nere, mentre la seconda contiene 5 palline bianche
e 6 nere. Lanciamo una moneta e se otteniamo testa estraiamo una palline dalla prima urna, altrimenti
estraiamo una pallina della seconda urna.
<ul class="org-ul">
<li>Qual'è la probabilità che il lancio della moneta sia stato testa dato che la pallina estratta è bianca?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">urna1 <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:2) {
  urna1 <span style="color: #558b2f;">&lt;-</span> append(urna1, <span style="color: #689f38;">"b"</span>)
}
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:7) {
  urna1 <span style="color: #558b2f;">&lt;-</span> append(urna1, <span style="color: #689f38;">"n"</span>)
}
urna2 <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:5) {
  urna2 <span style="color: #558b2f;">&lt;-</span> append(urna2, <span style="color: #689f38;">"b"</span>)
}
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:6) {
  urna2 <span style="color: #558b2f;">&lt;-</span> append(urna2, <span style="color: #689f38;">"n"</span>)
}

urna_space1 <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(urna1, 1))
urna_space2 <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(urna2, 1))
pBH <span style="color: #558b2f;">&lt;-</span> Prob(urna_space1, out==<span style="color: #689f38;">"b"</span>)
pBT <span style="color: #558b2f;">&lt;-</span> Prob(urna_space2, out==<span style="color: #689f38;">"b"</span>)

moneta <span style="color: #558b2f;">&lt;-</span> c(0.5, 0.5)
pBHT <span style="color: #558b2f;">&lt;-</span> c(pBH, pBT)
pB <span style="color: #558b2f;">&lt;-</span> moneta*pBHT
pTot <span style="color: #558b2f;">&lt;-</span> sum(moneta*pBHT)

pHeadGivenBianca <span style="color: #558b2f;">&lt;-</span> pB/pTot
pHeadGivenBianca[1]
</pre>
</div>

<pre class="example">
[1] 0.3283582

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Esercizio 6: </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Si considerino due urne. La prima contiene b1 (ex: b1=2) palline bianche e n1 (ex:n1=7) nere, </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">mentre la seconda contiene b2 (ex: b2=5) palline bianche e (ex: n2=6) nere. </span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Lanciamo una moneta e se otteniamo testa estraiamo una pallina dalla prima urna, </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">altrimenti estraiamo una pallina della seconda urna. </span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Qual &#232; la probabilit&#224; che il lancio della moneta sia stato l (ex: l=testa) dato che </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">la pallina estratta &#232; k (ex: k=bianca)?</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">---------------------------------------------------------</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">importo la libreria prob</span>
<span style="color: #558b2f;">library</span>(prob)



<span style="color: #607d8b;"># </span><span style="color: #607d8b;">PARAMETRI </span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">b1 = numero palline bianche nella prima urna</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">n1 = numero palline nere nella prima urna</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">b2 = numero palline bianche nella seconda urna</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">n2 = numero palline nere nella seconda urna</span>



b1 <span style="color: #558b2f;">&lt;-</span> 2
n1 <span style="color: #558b2f;">&lt;-</span> 7

b2 <span style="color: #558b2f;">&lt;-</span> 5
n2 <span style="color: #558b2f;">&lt;-</span> 6


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">"probabilit&#224; che il lancio sia stato l ..."</span>

l <span style="color: #558b2f;">&lt;-</span> <span style="color: #689f38;">'T'</span> <span style="color: #607d8b;">#</span><span style="color: #607d8b;">l pu&#242; assumere valore T (testa) o H (croce)</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">"...sapendo che la palllina estratta &#232; k"</span>

k <span style="color: #558b2f;">&lt;-</span> <span style="color: #689f38;">'b'</span> <span style="color: #607d8b;">#</span><span style="color: #607d8b;">pu&#242; assumere valore 'b' (bianco) o 'n' (nero)</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">calcolo del risultato inverso della moneta rispetto a quello scelto</span>
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">nell'esercizio. (verr&#224; usato per lo svolgimento)</span>

<span style="color: #00796b;">if</span> (l ==<span style="color: #689f38;">'T'</span>)
  notl <span style="color: #558b2f;">&lt;-</span> <span style="color: #689f38;">'H'</span>
<span style="color: #00796b;">else</span>
  notl <span style="color: #558b2f;">&lt;-</span> <span style="color: #689f38;">'T'</span>



<span style="color: #607d8b;">#</span><span style="color: #607d8b;">DATI</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">definizione della prima urna</span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">inizializzazione dell'array relativo alla prima urna</span>
urn1 <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Cicli che inseriscono elementi nell'urna</span>

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1 : b1){
  urn1 <span style="color: #558b2f;">&lt;-</span> append(urn1, <span style="color: #689f38;">"b"</span>);
}

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1 : n1){
  urn1 <span style="color: #558b2f;">&lt;-</span> append(urn1, <span style="color: #689f38;">"n"</span>);
}




<span style="color: #607d8b;"># </span><span style="color: #607d8b;">definizione della seconda urna</span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">inizializzazione dell'array relativo alla seconda urna</span>
urn2 <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Cicli che inseriscono elementi nell'urna</span>

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1 : b2){
  urn2 <span style="color: #558b2f;">&lt;-</span> append(urn2, <span style="color: #689f38;">"b"</span>);
}

<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1 : n2){
  urn2 <span style="color: #558b2f;">&lt;-</span> append(urn2, <span style="color: #689f38;">"n"</span>);
}

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">numel1 contiene il numero di elementi della prima urna</span>
numel1 = length(urn1)


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">numel2 contiene il numero di elementi della seconda urna</span>
numel2 = length(urn2)



<span style="color: #607d8b;">#</span><span style="color: #607d8b;">------------------------------------------</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">PROCEDIMENTO:</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">CREAZIONE DELLO SPAZIO DELLE PROBABILIT&#224;</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">1) Generiamo un array indicante, in ogni posizione "i", la probabilit&#224; di </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">verificarsi dell'i-esimo evento dello "Spazio degli eventi" (urn1) sopra definito.</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numel1 = numero degli elementi nella prima urna</span>

p1 <span style="color: #558b2f;">&lt;-</span> rep(1/numel1, times=numel1)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">2) creazione dello spazio di probabilit&#224; relativo alla prima urna</span>

space_urn1 = probspace(urn1, p1)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">3) Generiamo un array indicante, in ogni posizione "i", la probabilit&#224; di </span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">verificarsi dell'i-esimo evento dello "Spazio degli eventi" (urn2) sopra definito.</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">numel2 = numero degli elementi nella prima urna</span>

p2 <span style="color: #558b2f;">&lt;-</span> rep(1/numel2, times=numel2)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">4) creazione dello spazio di probabilit&#224; relativo alla prima urna</span>

space_urn2 = probspace(urn2, p2)


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">5) creazione dello spazio di probabilit&#224; relativo al lancio della moneta</span>

coin = tosscoin(1, makespace=<span style="color: #0097A7;">TRUE</span>)





<span style="color: #607d8b;">#</span><span style="color: #607d8b;">SOLUZIONE: </span>


<span style="color: #607d8b;"># </span><span style="color: #607d8b;">(faremo uso della formula di Bayes)</span>



<span style="color: #607d8b;"># </span><span style="color: #607d8b;">probabilit&#224; al numeratore </span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">probabilit&#224; che la pallina sia k (ex: bianca) se esce l (ex: testa)</span>

PBT <span style="color: #558b2f;">&lt;-</span> Prob(space_urn1, x == k)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">probabilit&#224; che esca t</span>

PT <span style="color: #558b2f;">&lt;-</span> Prob(coin,toss1 == l)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">probabilit&#224; numeratore</span>

num <span style="color: #558b2f;">&lt;-</span> PBT * PT





<span style="color: #607d8b;"># </span><span style="color: #607d8b;">probabilit&#224; al denominatore</span>


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">probabilit&#224; che la pallina sia k (ex: bianca) se esce notl (ex: se l = T -&gt; notl = H)</span>

PBC <span style="color: #558b2f;">&lt;-</span> Prob(space_urn2, x == k)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">probabilit&#224; che esca croce</span>

PC <span style="color: #558b2f;">&lt;-</span> Prob(coin,toss1==notl)


<span style="color: #607d8b;">#</span><span style="color: #607d8b;">probabilit&#224; denominatore</span>

den <span style="color: #558b2f;">&lt;-</span> PBT * PT + PBC * PC






<span style="color: #607d8b;"># </span><span style="color: #607d8b;">applicazione della formula di Bayes</span>

out = num / den
</pre>
</div>
<p>
Esercizio 7:
</p>
<ul class="org-ul">
<li>Uno studente risponde ad un quiz multivalore conoscendo la risposta o selezionando a caso. Si indichi con "p" la probabilità
che lo studente conosca la risposta (ha studiato). Supponiamo che uno studente che non conosca la risposta indovini con
probabilità \(1/m\), dove "m" è il numero di risposte possibili.
<ul class="org-ul">
<li>Qual'è la probabilità che lo studente conoscesse la risposta dato che ha risposto correttamente?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Numero di risposte possibili</span>
m <span style="color: #558b2f;">&lt;-</span> 4
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Probabilit&#224; che conosca la risposta</span>
p <span style="color: #558b2f;">&lt;-</span> 0.8

conoscenza <span style="color: #558b2f;">&lt;-</span> c(p, 1-p)
corretto <span style="color: #558b2f;">&lt;-</span> c(1, 1/m)

comb <span style="color: #558b2f;">&lt;-</span> conoscenza*corretto
pTot <span style="color: #558b2f;">&lt;-</span> sum(comb)

comb[1]/pTot
</pre>
</div>

<pre class="example">
[1] 0.9411765

</pre>

<p>
Esercizio 8:
</p>
<ul class="org-ul">
<li>Un test di laboratorio è efficace al 95% nel rilevare una certa malattia quando questa è presente. Il test fornisce
comunque "falsi positivi" (dice che una persona sana è malata) per l'1% delle persone sane esaminate. Nel caso in cui
lo 0.5% della popolazione sia affetto dalla suddetta malattia,
<ul class="org-ul">
<li>Qual'è il problema che una persona sia effettivamente malata dato che il test dà risultato positivo?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">posti <span style="color: #558b2f;">&lt;-</span> c(0.95, 0.01)
salute <span style="color: #558b2f;">&lt;-</span> c(0.005, 0.995)

casi <span style="color: #558b2f;">&lt;-</span> posti*salute
num <span style="color: #558b2f;">&lt;-</span> casi[1]
denom <span style="color: #558b2f;">&lt;-</span> sum(casi)

num/denom
</pre>
</div>

<pre class="example">
[1] 0.3231293

</pre>

<p>
Esercizio 9:
</p>
<ul class="org-ul">
<li>Si sa che una data lettera ha eguale probabilità di essere contenuta in uno di tre folders. Si indichi con \(\alpha_i\) la probabilità che la lettera
venga trovata tramite una ricerca sommaria nel folder \(i\). Pertanto con probabilità \((1 - \alpha_i)\) la lettera non viene trovata anche se si trova
nel folder \(i\). Supponiamo di cercare nel folder \(1\) senza trovare la lettera.
<ul class="org-ul">
<li>Qual'è la probabilità che la lettera sia nel folder <code>1</code>?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">n <span style="color: #558b2f;">&lt;-</span> 3
probFolders <span style="color: #558b2f;">&lt;-</span> rep(1/n, 3)
probRicercaSucc <span style="color: #558b2f;">&lt;-</span> c(0.8, 0.9, 0.85)
probRicercaFall <span style="color: #558b2f;">&lt;-</span> 1-probRicercaSucc
probRicercaPrimo <span style="color: #558b2f;">&lt;-</span> c(probRicercaFall[1], 1, 1)
prob <span style="color: #558b2f;">&lt;-</span> probFolders*probRicercaPrimo

num <span style="color: #558b2f;">&lt;-</span> prob[1]
denom <span style="color: #558b2f;">&lt;-</span> sum(prob)

num/denom
</pre>
</div>

<pre class="example">
[1] 0.09090909

</pre>

<p>
Esercizio 12:
</p>
<ul class="org-ul">
<li>Date 2 urne indistinguibili esternamente. La prima contiene 3 palline rosse, 1 bianca e 2 verdi, mentre la seconda contiene 1 pallina rossa,
3 bianche e 2 verdi. Presa un'urna a caso, si estraggono 2 palline senza reimbussolamento da tale urna. Calcolare la probabilità che:
<ol class="org-ol">
<li>Vengano estratte 2 palline rosse;</li>
<li>Venga estratta almeno una pallina rossa;</li>
<li>L'urna dalla quale stiamo estraendo sia la prima quando la prima pallina estratta è rossa;</li>
<li>La seconda pallina estratta dall'urna sia rossa quando la prima è rossa.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">urna1 <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"v"</span>, <span style="color: #689f38;">"v"</span>)
urna2 <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"v"</span>, <span style="color: #689f38;">"v"</span>)
numero_estrazioni <span style="color: #558b2f;">&lt;-</span> 2
prob <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>
<span style="color: #00796b;">for</span>(i <span style="color: #00796b;">in</span> 1:numero_estrazioni) {
  prob <span style="color: #558b2f;">&lt;-</span> append(prob, 1/numero_estrazioni)
}

urna1_space <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(urna1, numero_estrazioni, ordered=T))
urna2_space <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(urna2, numero_estrazioni, ordered=T))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
prob1 <span style="color: #558b2f;">&lt;-</span> Prob(urna1_space, X1==<span style="color: #689f38;">"r"</span> &amp; X2==<span style="color: #689f38;">"r"</span>)
prob2 <span style="color: #558b2f;">&lt;-</span> Prob(urna2_space, X1==<span style="color: #689f38;">"r"</span> &amp; X2==<span style="color: #689f38;">"r"</span>)
prob12 <span style="color: #558b2f;">&lt;-</span> c(prob1, prob2)
prob_2_palline_rosse <span style="color: #558b2f;">&lt;-</span> sum(prob12*prob)
prob_2_palline_rosse

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
prob1_0r <span style="color: #558b2f;">&lt;-</span> Prob(urna1_space, X1!=<span style="color: #689f38;">"r"</span> &amp; X2!=<span style="color: #689f38;">"r"</span>)
prob2_0r <span style="color: #558b2f;">&lt;-</span> Prob(urna2_space, X1!=<span style="color: #689f38;">"r"</span> &amp; X2!=<span style="color: #689f38;">"r"</span>)
prob12_0r <span style="color: #558b2f;">&lt;-</span> c(prob1_0r, prob2_0r)
1-sum(prob12_0r*prob)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
prob1_prima_r <span style="color: #558b2f;">&lt;-</span> Prob(urna1_space, X1==<span style="color: #689f38;">"r"</span>)
prob2_prima_r <span style="color: #558b2f;">&lt;-</span> Prob(urna2_space, X1==<span style="color: #689f38;">"r"</span>)
prob12_prima_r <span style="color: #558b2f;">&lt;-</span> c(prob1_prima_r, prob2_prima_r)
prob_tot_prima_r <span style="color: #558b2f;">&lt;-</span> prob12_prima_r*prob
num <span style="color: #558b2f;">&lt;-</span> prob_tot_prima_r[1]
denom <span style="color: #558b2f;">&lt;-</span> sum(prob_tot_prima_r)
num/denom

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4</span>
num <span style="color: #558b2f;">&lt;-</span> prob_2_palline_rosse
denom <span style="color: #558b2f;">&lt;-</span> sum(prob_tot_prima_r)
num/denom
</pre>
</div>

<pre class="example">
[1] 0.1
[1] 0.5666667
[1] 0.75
[1] 0.3

</pre>

<p>
Esercizio 13:
</p>
<ul class="org-ul">
<li>2 urne indistinguibili esternamente. La prima contiene 2 palline rosse, 2 bianche e 4 verdi, mentre la seconda contiene 2 palline rosse,
4 bianche e 2 verdi. Selezioniamo un'urna a caso ed estraiamo da essa 2 palline senza reimbussolamento. Calcolare pa probabilità che:
<ol class="org-ol">
<li>Vengano estratte 2 palline verdi;</li>
<li>L'urna dalla quale stiamo estraendo sia la prima sapendo che la prima pallina estratta è verde;</li>
<li>Vengano estratte 2 palline di colore diverso.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">urna1 <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"v"</span>, <span style="color: #689f38;">"v"</span>, <span style="color: #689f38;">"v"</span>, <span style="color: #689f38;">"v"</span>)
urna2 <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"v"</span>, <span style="color: #689f38;">"v"</span>)
prob <span style="color: #558b2f;">&lt;-</span> c(0.5, 0.5)
urna1_space <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(urna1, 2, ordered=T))
urna2_space <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(urna2, 2, ordered=T))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
urna1_2_verdi <span style="color: #558b2f;">&lt;-</span> Prob(urna1_space, X1==X2 &amp; X2==<span style="color: #689f38;">"v"</span>)
urna2_2_verdi <span style="color: #558b2f;">&lt;-</span> Prob(urna2_space, X1==X2 &amp; X2==<span style="color: #689f38;">"v"</span>)
urne_2_verdi <span style="color: #558b2f;">&lt;-</span> c(urna1_2_verdi, urna2_2_verdi)
urne_2_verdi_tot <span style="color: #558b2f;">&lt;-</span> sum(urne_2_verdi*prob)
urne_2_verdi_tot

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
urna1_prima_verde <span style="color: #558b2f;">&lt;-</span> Prob(urna1_space, X1==<span style="color: #689f38;">"v"</span>)
urna2_prima_verde <span style="color: #558b2f;">&lt;-</span> Prob(urna2_space, X1==<span style="color: #689f38;">"v"</span>)
urne_prima_verde <span style="color: #558b2f;">&lt;-</span> c(urna1_prima_verde, urna2_prima_verde)
prob_urne_prima_verde <span style="color: #558b2f;">&lt;-</span> urne_prima_verde*prob
num <span style="color: #558b2f;">&lt;-</span> prob_urne_prima_verde[1]
denom <span style="color: #558b2f;">&lt;-</span> sum(prob_urne_prima_verde)
num/denom

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
urna1_colore_diverso <span style="color: #558b2f;">&lt;-</span> Prob(urna1_space, X1!=X2)
urna2_colore_diverso <span style="color: #558b2f;">&lt;-</span> Prob(urna2_space, X1!=X2)
urne_colore_diverso <span style="color: #558b2f;">&lt;-</span> c(urna1_colore_diverso, urna2_colore_diverso)
sum(urne_colore_diverso*prob)
</pre>
</div>

<pre class="example">
[1] 0.125
[1] 0.6666667
[1] 0.7142857

</pre>

<p>
Esercizio 14:
</p>
<ul class="org-ul">
<li>Si effettuano 3 tiri verso un medesimo bersaglio. La probabilità di colpirlo al primo, al secondo e al terzo colpo sono rispettivamente
uguali a \(p1 = 0.4, p2=0.5, p3=0.7\). Calcolare la probabilità:
<ol class="org-ol">
<li>Di colpire il bersaglio una sola volta in 3 tiri;</li>
<li>Di colpire il bersaglio al più una volta in 3 tiri;</li>
<li>Di colpire il bersaglio almeno una volta in 3 tiri;</li>
<li>Che il centro sia avvenuto al terzo colpo sapendo che il bersaglio viene colpito una sola volta.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">prob_bersaglio <span style="color: #558b2f;">&lt;-</span> c(0.4, 0.5, 0.7)
prob_mancato <span style="color: #558b2f;">&lt;-</span> 1 - prob_bersaglio

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
prob_matrix <span style="color: #558b2f;">&lt;-</span> array(rep(prob_mancato, 3), c(3, 3))
diag(prob_matrix) <span style="color: #558b2f;">&lt;-</span> prob_bersaglio
prob_1_bersaglio <span style="color: #558b2f;">&lt;-</span> 0
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:3) {
  prod <span style="color: #558b2f;">&lt;-</span> 1
  <span style="color: #00796b;">for</span> (j <span style="color: #00796b;">in</span> 1:3) {
  prod <span style="color: #558b2f;">&lt;-</span> prod*prod(prob_matrix[j, i])
  }
  prob_1_bersaglio <span style="color: #558b2f;">&lt;-</span> prob_1_bersaglio + prod
}
prob_1_bersaglio

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
prob_0_volte <span style="color: #558b2f;">&lt;-</span> prob_mancato[1]*prob_mancato[2]*prob_mancato[3]
prob_al_massimo_1_volta <span style="color: #558b2f;">&lt;-</span> prob_0_volte + prob_1_bersaglio
prob_al_massimo_1_volta

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
prob_almeno_1_volta <span style="color: #558b2f;">&lt;-</span> 1 - prob_0_volte
prob_almeno_1_volta

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4</span>
prob_matrix_neg <span style="color: #558b2f;">&lt;-</span> 1 - prob_matrix
num <span style="color: #558b2f;">&lt;-</span> 1
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:3) {
  num <span style="color: #558b2f;">&lt;-</span> num*prob_matrix_neg[i,1]
}
num/prob_1_bersaglio
</pre>
</div>

<pre class="example">
[1] 0.36
[1] 0.45
[1] 0.91
[1] 0.5833333

</pre>

<p>
Esercizio 15:
</p>
<ul class="org-ul">
<li>Un dado equilibrato viene lanciato 3 volte. Calcolare la probabilità che:
<ol class="org-ol">
<li>Il punteggio del primo lancio non sia divisibile per 3;</li>
<li>Il punteggio somma dei primi 2 lanci non sia divisibile per 3;</li>
<li>Né il punteggio del primo lancio, né il punteggio somma dei primi due lanci siano visibili per 3.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">die <span style="color: #558b2f;">&lt;-</span> probspace(rolldie(3))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
primo <span style="color: #558b2f;">&lt;-</span> Prob(die, X1<span style="color: #558b2f;">%%</span>3!=0)
primo

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
secondo <span style="color: #558b2f;">&lt;-</span> Prob(die, (X1+X2)<span style="color: #558b2f;">%%</span>3!= 0)
secondo

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
primo*secondo
</pre>
</div>

<pre class="example">
[1] 0.6666667
[1] 0.6666667
[1] 0.4444444

</pre>

<p>
Esercizio 16:
</p>
<ul class="org-ul">
<li>Abbiamo dei componenti elettronici che provengono da 3 diversi centri di produzione, \(C1\), \(C2\) e \(C3\), la cui probabilità
di funzionamento è, rispettivamente \(\frac{1}{10}, \frac{2}{10}\) e \(\frac{3}{10}\). Sappiamo inoltre che il 30% dei
componenti provengono da \(C1\), altri 20% da \(C2\) ed i restanti 50% provengono da \(C3\). Calcolare:
<ol class="org-ol">
<li>La probabilità che preso un componente a caso questo sia funzionante;</li>
<li>La probabilità che un componente preso a caso provenga da \(C1\) avendo osservato che esso è funzionante;</li>
<li>La probabilità che almeno uno tra 3 componenti a caso sia funzionante;</li>
<li>Il numero minimo di componenti da estrarre affinché la probabilità che almeno uno sia funzionante sia maggiore o
uguale a 0.999.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">funz_c1 <span style="color: #558b2f;">&lt;-</span> 1/10
funz_c2 <span style="color: #558b2f;">&lt;-</span> 2/10
funz_c3 <span style="color: #558b2f;">&lt;-</span> 3/10
prob_funz <span style="color: #558b2f;">&lt;-</span> c(funz_c1, funz_c2, funz_c3)

da_c1 <span style="color: #558b2f;">&lt;-</span> 0.3
da_c2 <span style="color: #558b2f;">&lt;-</span> 0.2
da_c3 <span style="color: #558b2f;">&lt;-</span> 0.5
prob_orig <span style="color: #558b2f;">&lt;-</span> c(da_c1, da_c2, da_c3)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
prob <span style="color: #558b2f;">&lt;-</span> prob_funz*prob_orig
prob_componente_funz <span style="color: #558b2f;">&lt;-</span> sum(prob)
prob_componente_funz

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
num <span style="color: #558b2f;">&lt;-</span> prob[1]
num/prob_componente_funz

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
prob_0_funz <span style="color: #558b2f;">&lt;-</span> (1-prob_componente_funz)^3
prob_almeno_1_funz <span style="color: #558b2f;">&lt;-</span> 1 - prob_0_funz
prob_almeno_1_funz
 
<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4</span>
p <span style="color: #558b2f;">&lt;-</span> 0.999
ceiling(log(1-p, base=(1-prob_componente_funz)))
</pre>
</div>

<pre class="example">
[1] 0.22
[1] 0.1363636
[1] 0.525448
[1] 28

</pre>

<p>
Esercizio 18:
</p>
<ul class="org-ul">
<li><p>
Abbiamo un sistema elettronico costruito da 4 componenti posti in serie e parallelo come in figura:
</p>


<div class="figure">
<p><img src="Laboratorio/screenshot_2018-04-01_23-16-56.png" alt="screenshot_2018-04-01_23-16-56.png" />
</p>
</div>

<p>
Supponiamo che il funzionamento di ogni singolo componente sia indipendente dal funzionamento degli altri e
supponiamo che i 2 in parallelo funzionino ognuno con probabilità \(p_P\) mentre quelli in serie ognuno con
probabilità \(P_S\) (\(P_P\) e \(P_S \in (0, 1) \subseteq \mathbb{R}\))
</p></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ps <span style="color: #558b2f;">&lt;-</span> 0.8
pp <span style="color: #558b2f;">&lt;-</span> 0.9

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
nessuno_funz <span style="color: #558b2f;">&lt;-</span> (1-ps)^2 * (1-pp)^2
1- nessuno_funz

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
nessun_paral_funz <span style="color: #558b2f;">&lt;-</span> (1-pp)^2
almeno_uno_paral_funz <span style="color: #558b2f;">&lt;-</span> 1 - nessun_paral_funz
due_serie_funz <span style="color: #558b2f;">&lt;-</span> ps^2
sistema_funz <span style="color: #558b2f;">&lt;-</span> almeno_uno_paral_funz*due_serie_funz
sistema_funz

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
pp <span style="color: #558b2f;">&lt;-</span> 0.8
ps <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>
p <span style="color: #558b2f;">&lt;-</span> 0.9
nessun_paral_funz <span style="color: #558b2f;">&lt;-</span> (1-pp)^2
sqrt(p/(1-nessun_paral_funz))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4</span>
ps <span style="color: #558b2f;">&lt;-</span> 0.8
pp <span style="color: #558b2f;">&lt;-</span> 0.9
sistema_funz <span style="color: #558b2f;">&lt;-</span> almeno_uno_paral_funz*due_serie_funz
(ps^2*(1-pp)^2)/(1-sistema_funz)
</pre>
</div>

<pre class="example">
[1] 0.9996
[1] 0.6336
[1] 0.9682458
[1] 0.01746725

</pre>

<p>
Esercizio 19:
</p>
<ul class="org-ul">
<li>Da un mazzo regolare di 52 carte (13 cuori, 13 quadri, 13 fiori e 13 picche) vengono estratte contemporaneamente 3 carte.
<ul class="org-ul">
<li>Qual'è la probabilità che le 3 carte estratte siano tutte di picche?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">carte <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(cards(), 3))
Prob(carte, all(suit==<span style="color: #689f38;">"Spade"</span>))
</pre>
</div>

<pre class="example">
[1] 0.01294118

</pre>

<p>
Esercizio 20:
</p>
<ul class="org-ul">
<li>Supponiamo che un'urna contenga 1 pallina rossa e 1 pallina bianca. Una pallina è estratta e se ne osserva il colore.
Essa viene poi rimessa nell'urna insieme a 1 pallina dello stesso colore. Sia \(R_i\) l'evento "All'\(i\)-esima estrazione
viene estratta una pallina rossa", analogamente \(B_i\) sia l'evento "All'\(i\)-esima estrazione viene estratta una pallina
bianca". Si calcoli:
<ol class="org-ol">
<li>\(P(R_2)\) e \(P(R_3)\);</li>
<li>Sapendo che la seconda estratta è una pallina rossa, è più probabile che la prima estratta fosse rossa o bianca?</li>
<li>Qual'è la probabilità che la prima estratta sia rossa e la seconda bianca?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">r <span style="color: #558b2f;">&lt;-</span> 1
b <span style="color: #558b2f;">&lt;-</span> 1
tot <span style="color: #558b2f;">&lt;-</span> r+b
p <span style="color: #558b2f;">&lt;-</span> 0.5

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
prob_r1 <span style="color: #558b2f;">&lt;-</span> r/tot
prob_b1 <span style="color: #558b2f;">&lt;-</span> b/tot
tot <span style="color: #558b2f;">&lt;-</span> tot+1
prob_r1_r2 <span style="color: #558b2f;">&lt;-</span> (r+1)/tot
prob_b1_r2 <span style="color: #558b2f;">&lt;-</span> r/tot
prob_r2 <span style="color: #558b2f;">&lt;-</span> prob_r1_r2*p + prob_b1_r2*p
prob_r2
prob_r1_b2 <span style="color: #558b2f;">&lt;-</span> b/tot
prob_b1_b2 <span style="color: #558b2f;">&lt;-</span> (b+1)/tot
prob_b2 <span style="color: #558b2f;">&lt;-</span> prob_r1_b2*p + prob_b1_b2*p
tot <span style="color: #558b2f;">&lt;-</span> tot+1
p <span style="color: #558b2f;">&lt;-</span> p/2
prob_r1_r2_r3 <span style="color: #558b2f;">&lt;-</span> (r+2)/tot
prob_r1_b2_r3 <span style="color: #558b2f;">&lt;-</span> (r+1)/tot
prob_b1_r2_r3 <span style="color: #558b2f;">&lt;-</span> prob_r1_b2_r3
prob_b1_b2_r3 <span style="color: #558b2f;">&lt;-</span> r/tot
prob_r3 <span style="color: #558b2f;">&lt;-</span> prob_r1_r2_r3*p + prob_r1_b2_r3*p + prob_b1_r2_r3*p + prob_b1_b2_r3*p
prob_r3

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
num_r <span style="color: #558b2f;">&lt;-</span> prob_r1*prob_r1_r2
denom_r <span style="color: #558b2f;">&lt;-</span> prob_r2
prob_r1_dato_r2 <span style="color: #558b2f;">&lt;-</span> num_r/denom_r
num_b <span style="color: #558b2f;">&lt;-</span> prob_b1*prob_b1_r2
denom_b <span style="color: #558b2f;">&lt;-</span> prob_r2
prob_b1_dato_r2 <span style="color: #558b2f;">&lt;-</span> num_b/denom_b
<span style="color: #00796b;">if</span> (prob_r1_dato_r2 &gt; prob_b1_dato_r2 | prob_r1_dato_r2 == prob_b1_dato_r2) {
  print(<span style="color: #689f38;">"Pi&#249; probabile la pallina rossa"</span>)
} <span style="color: #00796b;">else</span> <span style="color: #00796b;">if</span> (prob_b1_dato_r2 == prob_r1_dato_r2) {
  print(<span style="color: #689f38;">"Stessa probabilit&#224;"</span>)
} <span style="color: #00796b;">else</span> {
  print(<span style="color: #689f38;">"Pi&#249; probabile la pallina bianca"</span>)
}

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
prob_r1_b2*0.5
</pre>
</div>

<pre class="example">
[1] 0.5
[1] 0.5
[1] "Più probabile la pallina rossa"
[1] 0.1666667

</pre>

<p>
Esercizio 21:
</p>
<ul class="org-ul">
<li>Un'urna contiene 6 palline di cui 3 bianche, 2 rosse ed 1 nera. Si estraggono senza reimmissione tre palline
e si vince se una delle 3 è nera.
<ol class="org-ol">
<li>Si calcoli la probabilità di vincere;</li>
<li>Si calcoli la probabilità di vincere sapendo che la pallina nera non è uscita nelle prime 2 estrazioni;</li>
<li>Sapendo di aver vinto, qual'è la probabilità che la pallina nera non sia uscita nelle prime 2 estrazioni?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">urna <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"b"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"n"</span>)
urna_space <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(urna, 3, ordered=T))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
prob_vincita <span style="color: #558b2f;">&lt;-</span> Prob(urna_space, X1==<span style="color: #689f38;">"n"</span> | X2==<span style="color: #689f38;">"n"</span> | X3==<span style="color: #689f38;">"n"</span>)
prob_vincita

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
prob_nera_al_terzo <span style="color: #558b2f;">&lt;-</span> Prob(urna_space, X1!=<span style="color: #689f38;">"n"</span> &amp; X2!=<span style="color: #689f38;">"n"</span> &amp; X3==<span style="color: #689f38;">"n"</span>)
prob_prime_2_non_nera <span style="color: #558b2f;">&lt;-</span> Prob(urna_space, X1!=<span style="color: #689f38;">"n"</span> &amp; X2!=<span style="color: #689f38;">"n"</span>)
prob_vincita_prime_2_non_nera <span style="color: #558b2f;">&lt;-</span> prob_nera_al_terzo/prob_prime_2_non_nera
prob_vincita_prime_2_non_nera

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
(prob_vincita_prime_2_non_nera*prob_prime_2_non_nera)/prob_vincita
</pre>
</div>

<pre class="example">
[1] 0.5
[1] 0.25
[1] 0.3333333

</pre>

<p>
Esercizio 22:
</p>
<ul class="org-ul">
<li>Il modello "plus" di una chiave USB può presentare 2 tipi di difetto, difetto di tipo \(A\) con probabilità pari a 0.03 e difetto di
tipo \(B\) con probabilità pari a 0.07. I due tipi di difetto sono indipendenti l'uno dall'altro. Qual'è la probabilità che
una generica chiave USB
<ol class="org-ol">
<li>Presenti entrambi i difetti?</li>
<li>Sia difettosa?</li>
<li>Presenti il difetto \(A\), sapendo che è difettosa?</li>
<li>Presenti uno solo dei difetti, sapendo che è difettosa?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">pa <span style="color: #558b2f;">&lt;-</span> 0.03
pb <span style="color: #558b2f;">&lt;-</span> 0.07

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
entrambi_difetti <span style="color: #558b2f;">&lt;-</span> pa*pb
entrambi_difetti

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
difettosa <span style="color: #558b2f;">&lt;-</span> pa + pb - pa*pb
difettosa

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
pa/difettosa

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4</span>
un_solo_difetto <span style="color: #558b2f;">&lt;-</span> difettosa - pa*pb
un_solo_difetto/difettosa
</pre>
</div>

<pre class="example">
[1] 0.0021
[1] 0.0979
[1] 0.3064351
[1] 0.9785495

</pre>

<p>
Esercizio 23:
</p>
<ul class="org-ul">
<li><p>
Una roulette semplificata è formata da 12 numeri che sono classificati rosso (\(R\)) e nero (\(N\)) in base allo schema seguente:
</p>


<div class="figure">
<p><img src="Laboratorio/screenshot_2018-04-02_11-03-33.png" alt="screenshot_2018-04-02_11-03-33.png" />
</p>
</div>

<p>
Siano \(A =\) "esce un numero pari", \(B =\) "esce un numero rosso", \(C =\) "esce un numero" \(\leq 6\) e \(D =\) "esce un numero" \(\leq 8\).
</p>
<ol class="org-ol">
<li>Stabilire se gli eventi \(A, B\) e \(C\) sono a 2 a 2 indipendenti;</li>
<li>Stabilire se \(A, B\) e \(C\) costituiscono una famiglia di eventi indipendenti;</li>
<li>Stabilire se \(A, B\) e \(D\) costituiscono una famiglia di eventi indipendenti;</li>
<li>Ponendo \(E =\) "esce un numero dispari" \(\leq 3\), \(E\) è indipendente da \(A\) e da \(D\)?</li>
<li>Supponiamo di sapere che esca un numero rosso, gli eventi \(A\) e \(C\) sono indipendenti?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">numbers <span style="color: #558b2f;">&lt;-</span> 1:12
colors <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"n"</span>, <span style="color: #689f38;">"n"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"n"</span>, <span style="color: #689f38;">"n"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"n"</span>, <span style="color: #689f38;">"n"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"r"</span>)
roulette <span style="color: #558b2f;">&lt;-</span> data.frame(numbers, colors)
    
roulette_space <span style="color: #558b2f;">&lt;-</span> probspace(roulette)
    
prob_a <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers<span style="color: #558b2f;">%%</span>2==0)
prob_b <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, colors==<span style="color: #689f38;">"r"</span>)
prob_c <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers&lt;=6)
prob_d <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers&lt;=8)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
prob_a_AND_b <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers<span style="color: #558b2f;">%%</span>2==0 &amp; colors==<span style="color: #689f38;">"r"</span>)
prob_a_AND_c <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers<span style="color: #558b2f;">%%</span>2==0 &amp; numbers &lt;=6)
prob_b_AND_c <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, colors==<span style="color: #689f38;">"r"</span> &amp; numbers &lt;=6)
<span style="color: #00796b;">if</span> (prob_a*prob_b==prob_a_AND_b &amp; prob_a*prob_c==prob_a_AND_c &amp; prob_b*prob_c==prob_b_AND_c) {
  print(<span style="color: #689f38;">"Gli eventi A, B e C sono a 2 a 2 indipendenti"</span>)
} <span style="color: #00796b;">else</span> {
  print(<span style="color: #689f38;">"Gli eventi A, B e C non sono a 2 a 2 indipendenti"</span>)
}

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
prob_a_AND_b_AND_c <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers<span style="color: #558b2f;">%%</span>2==0 &amp; colors==<span style="color: #689f38;">"r"</span> &amp; numbers &lt;=6)
<span style="color: #00796b;">if</span> (prob_a*prob_b*prob_c==prob_a_AND_b_AND_c) {
  print(<span style="color: #689f38;">"Gli eventi A, B e C costituiscono una famiglia di eventi indipendenti"</span>)
} <span style="color: #00796b;">else</span> {
  print(<span style="color: #689f38;">"Gli eventi A, B e C non costituiscono una famiglia di eventi indipendenti"</span>)
}

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
prob_a_AND_d <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers<span style="color: #558b2f;">%%</span>2==0 &amp; numbers &lt;=8)
prob_b_AND_d <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, colors==<span style="color: #689f38;">"r"</span> &amp; numbers &lt;=8)
<span style="color: #00796b;">if</span> (prob_a*prob_b==prob_a_AND_b &amp; prob_a*prob_d==prob_a_AND_d &amp; prob_b*prob_d==prob_b_AND_d) {
  print(<span style="color: #689f38;">"Gli eventi A, B e D sono a 2 a 2 indipendenti"</span>)
} <span style="color: #00796b;">else</span> {
  print(<span style="color: #689f38;">"Gli eventi A, B e D non sono a 2 a 2 indipendenti"</span>)
}

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4</span>
prob_e <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers<span style="color: #558b2f;">%%</span>2==1 &amp; numbers&lt;=3)
prob_a_AND_d <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers<span style="color: #558b2f;">%%</span>2==0 &amp; numbers&lt;=8)
prob_a_AND_e <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, numbers<span style="color: #558b2f;">%%</span>2==0 &amp; numbers<span style="color: #558b2f;">%%</span>2==1 &amp; numbers&lt;=3)
prob_b_AND_e <span style="color: #558b2f;">&lt;-</span> Prob(roulette_space, colors==<span style="color: #689f38;">"r"</span> &amp; numbers<span style="color: #558b2f;">%%</span>2==1 &amp; numbers&lt;=3)
<span style="color: #00796b;">if</span> (prob_a*prob_d==prob_a_AND_d &amp; prob_a*prob_e==prob_a_AND_e &amp; prob_b*prob_e==prob_b_AND_e) {
  print(<span style="color: #689f38;">"Gli eventi A, D e E sono a 2 a 2 indipendenti"</span>)
} <span style="color: #00796b;">else</span> {
  print(<span style="color: #689f38;">"Gli eventi A, D e E non sono a 2 a 2 indipendenti"</span>)
}

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">5</span>
prob_a_dato_b <span style="color: #558b2f;">&lt;-</span> prob_a_AND_b/prob_b
prob_c_dato_b <span style="color: #558b2f;">&lt;-</span> prob_b_AND_c/prob_b
prob_a_AND_c_dato_b <span style="color: #558b2f;">&lt;-</span> prob_a_AND_b_AND_c/prob_b
<span style="color: #00796b;">if</span> (prob_a*prob_d==prob_a_AND_d &amp; prob_a*prob_e==prob_a_AND_e &amp; prob_b*prob_e==prob_b_AND_e) {
  cat(<span style="color: #689f38;">"Se sappiamo che esce un numero rosso, gli eventi A e C sono indipendenti"</span>)
} <span style="color: #00796b;">else</span> {
  cat(<span style="color: #689f38;">"Se sappiamo che esce un numero rosso, gli eventi A e C non sono indipendenti"</span>)
}
</pre>
</div>

<pre class="example">
[1] "Gli eventi A, B e C sono a 2 a 2 indipendenti"
[1] "Gli eventi A, B e C non costituiscono una famiglia di eventi indipendenti"
[1] "Gli eventi A, B e D sono a 2 a 2 indipendenti"
[1] "Gli eventi A, D e E non sono a 2 a 2 indipendenti"

</pre>

<p>
Esercizio 24:
</p>
<ul class="org-ul">
<li>Da un'urna che contiene 3 palline bianche e 2 palline nere vengono trasferite 2 palline, scelte a caso, in un'altra
urna che contiene 4 palline bianche e 4 palline nere. Infine, si estrae una pallina dalla seconda urna.
<ol class="org-ol">
<li>Trovare la probabilità di estrarre una pallina bianca dalla seconda urna;</li>
<li>Calcolare la probabilità di aver trasferito almeno una pallina bianca se estraiamo una pallina nera dalla seconda urna.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">b1 <span style="color: #558b2f;">&lt;-</span> 3
n1 <span style="color: #558b2f;">&lt;-</span> 2
tot1<span style="color: #558b2f;">&lt;-</span> b1+n1
b2 <span style="color: #558b2f;">&lt;-</span> 4
n2 <span style="color: #558b2f;">&lt;-</span> 4
tot2<span style="color: #558b2f;">&lt;-</span> b2+n2+2

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
bn <span style="color: #558b2f;">&lt;-</span> b1*n1/choose(tot1, 2)
bb <span style="color: #558b2f;">&lt;-</span> choose(b1, 2)/choose(tot1, 2)
nn <span style="color: #558b2f;">&lt;-</span> choose(n1, 2)/choose(tot1, 2)
estr_b2 <span style="color: #558b2f;">&lt;-</span> bn*(b2+1)/tot2 + bb*(b2+2)/tot2 + nn*b2/tot2
estr_b2

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
almeno_1_b1 <span style="color: #558b2f;">&lt;-</span> bn+bb
estr_n2_dato_almeno_1_b1 <span style="color: #558b2f;">&lt;-</span> bn*(n2+1)/tot2 + bb*n2/tot2
estr_n2 <span style="color: #558b2f;">&lt;-</span> 1 - estr_b2
estr_almeno_1_b1_dato_n2 <span style="color: #558b2f;">&lt;-</span> estr_n2_dato_almeno_1_b1/estr_n2
estr_almeno_1_b1_dato_n2
</pre>
</div>

<pre class="example">
[1] 0.52
[1] 0.875

</pre>

<p>
Esercizio 25:
</p>
<ul class="org-ul">
<li>Ci sono 2 urne, la prima urna \(U_1\) contiene 2 dadi a 6 facce (dadi onesti), la seconda urna \(U_2\) contiene 2 dadi a 6 facce
(dadi truccati nel modo seguente; ognuno dei dadi ha 3 facce che indicano il numero 6 e le rimanenti 3 il numero 5).
Si lancia una moneta onesta e se l'esito del bilancio è testa si prendono i dadi dalla prima urna \(U_1\) mentre l'esito è croce si
prendono i dadi dalla seconda urna \(U_2\), poi, in ogni caso si lanciano i dati:
<ol class="org-ol">
<li>Calcolare la probabilità che la somma dei 2 dadi sia 11;</li>
<li>Sapendo di aver ottenuto un 11 lanciando i due dadi, calcolare la probabilità di aver ottenuto croce lanciando la moneta;</li>
<li>Sapendo di aver ottenuto un 11 lanciando i 2 dadi, calcolare la probabilità di aver ottenuto croce lanciando la moneta;</li>
<li>Gli eventi \(D_1 =\) "ottengo 6 sul primo lancio" e \(D_2 =\) "ottengo 6 sul secondo dato" sono indipendenti?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">dado1 <span style="color: #558b2f;">&lt;-</span> rolldie(2, makespace=T)
load_dado2 <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:3) {
  load_dado2 <span style="color: #558b2f;">&lt;-</span> append(load_dado2, 6)
}
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:3) {
  load_dado2 <span style="color: #558b2f;">&lt;-</span> append(load_dado2, 5)
}
dado2 <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(load_dado2, 2, ordered=T, replace=T))
moneta <span style="color: #558b2f;">&lt;-</span> tosscoin(1, makespace=T)
t <span style="color: #558b2f;">&lt;-</span> Prob(moneta, toss1==<span style="color: #689f38;">"H"</span>)
c <span style="color: #558b2f;">&lt;-</span> Prob(moneta, toss1==<span style="color: #689f38;">"T"</span>)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
somma_11_dado1 <span style="color: #558b2f;">&lt;-</span> Prob(dado1, (X1+X2)==11)
somma_11_dado2 <span style="color: #558b2f;">&lt;-</span> Prob(dado2, (X1+X2)==11)
somma_11 <span style="color: #558b2f;">&lt;-</span> somma_11_dado1*t + somma_11_dado2*c
somma_11

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
somma_11_dado2*c/somma_11

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
p_d1 <span style="color: #558b2f;">&lt;-</span> Prob(dado1, X1==6)*t + Prob(dado1, X1==6)*c
p_d2 <span style="color: #558b2f;">&lt;-</span> Prob(dado1, X2==6)*t + Prob(dado2, X2==6)*c
p_d1_AND_d2 <span style="color: #558b2f;">&lt;-</span> Prob(dado1, X1==6 &amp; X2==6)*t + Prob(dado2, X1==6 &amp; X2==6)*c
<span style="color: #00796b;">if</span> (p_d1*p_d2==p_d1_AND_d2) {
  print(<span style="color: #689f38;">"D_1 e D_2 sono indipendenti"</span>)
} <span style="color: #00796b;">else</span> {
  print(<span style="color: #689f38;">"D_1 e D_2 non sono indipendenti"</span>)
}
</pre>
</div>

<pre class="example">
[1] 0.2777778
[1] 0.9
[1] "D_1 e D_2 non sono indipendenti"

</pre>

<p>
Esercizio 26:
</p>
<ul class="org-ul">
<li>Nel gioco del lotto ad ogni estrazione che avviene settimanalmente vengono pescate contemporaneamente 5 palline da un'urna
contenente 90 palline numerate da 1 a 90 e per il resto indistinguibili. Giovanni ogni settimana gioca l'ambo \(\{89, 90\}\),
cioè Giovanni vince se fra le 5 palline estratte vi sono quelle numerate con 89 e 90.
<ol class="org-ol">
<li>Calcolare la probabilità di vincere in una singola estrazione;</li>
<li>Se nelle prime 2 estrazioni Giovanni non ha vinto con quale probabilità vincerà almeno una volta nelle prime 10 estrazioni?</li>
<li>Se nelle prime 10 giocate Giovanni ha vinto 3 volte, con quale probabilità ha vinto nelle prime 3 giocate?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">p1 <span style="color: #558b2f;">&lt;-</span> 89
p2 <span style="color: #558b2f;">&lt;-</span> 90

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
vinc_1_estr <span style="color: #558b2f;">&lt;-</span> choose(87, 3)/choose(90, 5)
vinc_1_estr

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
1 - (1 - vinc_1_estr)^8

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
1/choose(10, 3)
</pre>
</div>

<pre class="example">
[1] 0.002411758
[1] 0.01913198
[1] 0.008333333

</pre>

<p>
Esercizio 27:
</p>
<ul class="org-ul">
<li>Un'urna contiene 2 palline rosse e 4 palline nere. Due giocatori \(A\) e \(B\) giocano nel modo seguente: le palline vengono
estratte ad una ad una e messe da parte. \(A\) vince se l'ultima palline estratta è rossa, altrimenti vince \(B\).
<ol class="org-ol">
<li>Qual'è la probabilità che \(A\) vinca?</li>
<li>Qual'è la probabilità che \(A\) vinca sapendo che la prima pallina estratta è rossa?</li>
<li>Qual'è la probabilità che \(A\) vinca e che la prima pallina estratta sia rossa?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">urna <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"r"</span>, <span style="color: #689f38;">"n"</span>, <span style="color: #689f38;">"n"</span>, <span style="color: #689f38;">"n"</span>, <span style="color: #689f38;">"n"</span>)

urna_space <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(urna, 6, ordered=T))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
rossa_1 <span style="color: #558b2f;">&lt;-</span> Prob(urna_space, X6==<span style="color: #689f38;">"r"</span>)
rossa_1

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
rossa_1_6 <span style="color: #558b2f;">&lt;-</span> Prob(urna_space, X1==X6 &amp; X6==<span style="color: #689f38;">"r"</span>)
rossa_1_6/rossa_1

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
rossa_1_6
</pre>
</div>

<pre class="example">
[1] 0.3333333
[1] 0.2
[1] 0.06666667

</pre>

<p>
Esercizio 28:
</p>
<ul class="org-ul">
<li>Gli abitanti della località <code>abc</code> raggiungono ogni giorno la città <code>xyz</code> in treno o in macchina. Il 90% degli abitanti di
<code>abc</code> arrivano nella città <code>xyz</code> in ritardo (sull'orario previsto). Il 40% di questi (cioè di quelli in ritardo) usano il
treno, mentre, il 30% di quelli che NON arrivano in ritardo (sull'orario previsto) usano la macchina.
<ol class="org-ol">
<li>Qual'è la probabilità che un abitante di <code>abc</code> usi il treno per raggiungere la città <code>xyz</code> (un dato giorno)?</li>
<li>Se un abitante di <code>abc</code> usa il treno per raggiungere <code>xyz</code>, è più probabile che arrivi in ritardo o non in ritardo?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ritardo <span style="color: #558b2f;">&lt;-</span> 0.9
rit_treno <span style="color: #558b2f;">&lt;-</span> 0.4
or_macchina <span style="color: #558b2f;">&lt;-</span> 0.2
orario <span style="color: #558b2f;">&lt;-</span> 1-ritardo
rit_macchina <span style="color: #558b2f;">&lt;-</span> 1-rit_treno
or_treno <span style="color: #558b2f;">&lt;-</span> 1-or_macchina

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
treno <span style="color: #558b2f;">&lt;-</span> rit_treno*ritardo + or_treno*orario
treno

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
ritardo_dato_treno <span style="color: #558b2f;">&lt;-</span> rit_treno*ritardo/treno
orario_dato_treno <span style="color: #558b2f;">&lt;-</span> or_treno*orario/treno
<span style="color: #00796b;">if</span> (ritardo_dato_treno==orario_dato_treno) {
    print(<span style="color: #689f38;">"La probabilit&#224; che arrivi in orario e che arrivi in ritardo &#232; la medesima"</span>)
} <span style="color: #00796b;">else</span> <span style="color: #00796b;">if</span> (ritardo_dato_treno&gt;orario_dato_treno) {
    print(<span style="color: #689f38;">"&#200; pi&#249; probabile che arrivi in ritardo"</span>)
} <span style="color: #00796b;">else</span> <span style="color: #00796b;">if</span> (ritardo_dato_treno&gt;orario_dato_treno) {
    print(<span style="color: #689f38;">"&#200; pi&#249; probabile che arrivi in orario"</span>)
}
</pre>
</div>

<pre class="example">
[1] 0.44
[1] "È più probabile che arrivi in ritardo"

</pre>

<p>
Esercizio 31:
</p>
<ul class="org-ul">
<li>Ho 2 urne \(A\) e \(B\): \(A\) contiene 6 palline di cui 1 numerata 1, 2 numerate 2 e 3 numerate 3 e \(B\) contiene 9 palline di
cui 2 numerate 2, 3 numerate 3 e 4 numerate 4. Lancio un dado regolare: se esce la faccio 6, estraggo una pallina dall'urna \(A\).
Invece, se non esce la faccia 6, estraggo una pallina dall'urna \(B\).
<ol class="org-ol">
<li>Qual'è la probabilità di estrarre una pallina numerata 2?</li>
<li>Se la pallina estratta è numerata 2, qual'è la probabilità che il dado lanciato abbia esibito la faccia 6?</li>
<li>Sia \(X\) la variabile aleatoria discreta che rappresenta il numero della pallina estratta. Determinare la densità di \(X\).</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">urna1 <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(c(1, 2, 2, 3, 3, 3), 1))
urna2 <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(c(2, 2, 3, 3, 3, 4, 4, 4, 4), 1))
dado <span style="color: #558b2f;">&lt;-</span> rolldie(1, makespace=T)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
dado_6 <span style="color: #558b2f;">&lt;-</span> Prob(dado, X1==6)
dado_non_6 <span style="color: #558b2f;">&lt;-</span> 1-dado_6
urna1_2 <span style="color: #558b2f;">&lt;-</span> Prob(urna1, out==2)
urna2_2 <span style="color: #558b2f;">&lt;-</span> Prob(urna2, out==2)
estr_2 <span style="color: #558b2f;">&lt;-</span> urna1_2*dado_6 + urna2_2*dado_non_6
estr_2

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
urna1_2*dado_6/estr_2

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
p <span style="color: #558b2f;">&lt;-</span> <span style="color: #0097A7;">NULL</span>
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> 1:4) {
    p <span style="color: #558b2f;">&lt;-</span> append(p, Prob(urna1, out==i)*dado_6 + Prob(urna2, out==i)*dado_non_6)
}
p
</pre>
</div>

<pre class="example">
[1] 0.2407407
[1] 0.2307692
[1] 0.02777778 0.24074074 0.36111111 0.37037037

</pre>

<p>
Esercizio 32:
</p>
<ul class="org-ul">
<li>Giulio, Carlo e Federico giocano al tiro con l'arco. Si sa che la probabilità che Giulio colpisca il bersaglio è pari a
3/4, quella che Carlo colpisca il bersaglio è pari ad 1/2 e quella di Federico è pari ad 1/4. Si sa inoltre che i risultati
dei lanci dei 3 arcieri sono indipendenti.
<ol class="org-ol">
<li>Calcolare la probabilità che nessuno di loro colpisca il bersaglio;</li>
<li>Calcolare la probabilità che esattamente 2 di loro colpiscano il bersaglio;</li>
<li>Calcolare la probabilità che Giulio colpisca il bersaglio sapendo che esattamente 2 di loro hanno colpito il bersaglio.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">g <span style="color: #558b2f;">&lt;-</span> 3/4
c <span style="color: #558b2f;">&lt;-</span> 1/2
f <span style="color: #558b2f;">&lt;-</span> 1/4

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
nessuno <span style="color: #558b2f;">&lt;-</span> (1-g)*(1-c)*(1-f)
nessuno

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
due <span style="color: #558b2f;">&lt;-</span> g*c*(1-f) + g*(1-c)*f + (1-g)*c*f
due

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
due_dato_giulio <span style="color: #558b2f;">&lt;-</span> due - (1-g)*c*f
due_dato_giulio*g/due
</pre>
</div>

<pre class="example">
[1] 0.09375
[1] 0.40625
[1] 0.6923077

</pre>

<p>
Esercizio 33:
</p>
<ul class="org-ul">
<li>Un supermercato accetta pagamenti con carte di credito di 2 soli tipi, \(A\) e \(B\). Il 25% dei clienti possiede la carta \(A\),
il 50% la carta \(B\) e il 15% possiede entrambe le carte.
<ol class="org-ol">
<li>Calcolare la probabilità che un cliente scelto a caso possieda almeno una carta di credito accettata dal supermercato;</li>
<li>Calcolare la probabilità che un cliente scelto a caso possieda esattamente una carta di credito accettata dal supermercato;</li>
<li>Se un cliente possiede almeno una carta di credito accettata dal supermercato, qual'è la probabilità che sia una carta
di credito di tipo \(A\)?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">a <span style="color: #558b2f;">&lt;-</span> 0.25
b <span style="color: #558b2f;">&lt;-</span> 0.50
ab <span style="color: #558b2f;">&lt;-</span> 0.15

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
almeno_una <span style="color: #558b2f;">&lt;-</span> a+b-ab
almeno_una

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
esattamente_una <span style="color: #558b2f;">&lt;-</span> almeno_una - ab
esattamente_una

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
a/almeno_una
</pre>
</div>

<pre class="example">
[1] 0.6
[1] 0.45
[1] 0.4166667

</pre>

<p>
Esercizio 35:
</p>
<ul class="org-ul">
<li>Uno scommettitore ha nel suo portafoglio una moneta equa ed una moneta con entrambi i lati testa. Egli seleziona in modo
casuale una delle due monete, la lancia e ne osserva l'esito testa.
<ol class="org-ol">
<li>Qual'è la probabilità che si tratti della moneta equa?</li>
<li>Supponiamo che lanci la stessa moneta una seconda volta e che l'esito sia ancora testa. Qual'è la probabilità che si
tratti della moneta equa?</li>
<li>Supponiamo che lanci una terza volta la stessa moneta ottenendo croce. Qual'è la probabilità che si tratti della
moneta equa?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">p <span style="color: #558b2f;">&lt;-</span> 0.5
equa <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"t"</span>, <span style="color: #689f38;">"c"</span>)
truc <span style="color: #558b2f;">&lt;-</span> c(<span style="color: #689f38;">"t"</span>, <span style="color: #689f38;">"t"</span>)
equa_s <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(equa, 1))
truc_s <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(truc, 1))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
equa_testa <span style="color: #558b2f;">&lt;-</span> Prob(equa_s, out==<span style="color: #689f38;">"t"</span>)
truc_testa <span style="color: #558b2f;">&lt;-</span> Prob(truc_s, out==<span style="color: #689f38;">"t"</span>)
testa <span style="color: #558b2f;">&lt;-</span> p*(equa_testa + truc_testa)
prob_equa <span style="color: #558b2f;">&lt;-</span> equa_testa*p/testa
prob_equa

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
equa_s <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(equa, 2, ordered=T, replace=T))
truc_s <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(truc, 2, ordered=T, replace=T))
equa_testa_2 <span style="color: #558b2f;">&lt;-</span> Prob(equa_s, X1==<span style="color: #689f38;">"t"</span> &amp; X2==<span style="color: #689f38;">"t"</span>)
truc_testa_2 <span style="color: #558b2f;">&lt;-</span> Prob(truc_s, X1==<span style="color: #689f38;">"t"</span> &amp; X2==<span style="color: #689f38;">"t"</span>)
testa_2 <span style="color: #558b2f;">&lt;-</span> p*(equa_testa_2 + truc_testa_2)
prob_equa_2 <span style="color: #558b2f;">&lt;-</span> equa_testa_2*p/testa_2
prob_equa_2 

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
equa_s <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(equa, 3, ordered=T, replace=T))
truc_s <span style="color: #558b2f;">&lt;-</span> probspace(urnsamples(truc, 3, ordered=T, replace=T))
equa_testa_2_croce <span style="color: #558b2f;">&lt;-</span> Prob(equa_s, X1==<span style="color: #689f38;">"t"</span> &amp; X2==<span style="color: #689f38;">"t"</span> &amp; X3==<span style="color: #689f38;">"c"</span>)
truc_testa_2_croce <span style="color: #558b2f;">&lt;-</span> Prob(truc_s, X1==<span style="color: #689f38;">"t"</span> &amp; X2==<span style="color: #689f38;">"t"</span> &amp; X3==<span style="color: #689f38;">"c"</span>)
testa_2_croce <span style="color: #558b2f;">&lt;-</span> p*(equa_testa_2_croce + truc_testa_2_croce)
prob_equa_3 <span style="color: #558b2f;">&lt;-</span> equa_testa_2_croce*p/testa_2_croce
prob_equa_3 
</pre>
</div>

<pre class="example">
[1] 0.3333333
[1] 0.2
[1] 1

</pre>

<p>
Esercizio 36:
</p>
<ul class="org-ul">
<li>In un certo collegio, il 25% degli studenti è stato bocciato in matematica, il 15% è stato bocciato in chimica, e il 10%
è stato bocciato sia in matematica che in chimica. Viene scelto a caso uno studente.
<ol class="org-ol">
<li>Se egli è stato bocciato in chimica, qual'è la probabilità che sia stato bocciato in matematica?</li>
<li>Se egli è stato bocciato in matematica, qual'è la probabilità che sia stato bocciato in chimica?</li>
<li>Qual'è la probabilità che sia stato bocciato in matematica o in chimica?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">mat <span style="color: #558b2f;">&lt;-</span> 0.25
chim <span style="color: #558b2f;">&lt;-</span> 0.15
matchim <span style="color: #558b2f;">&lt;-</span> 0.1

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
matchim/chim

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
matchim/mat

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
mat+chim-matchim
</pre>
</div>

<pre class="example">
[1] 0.6666667
[1] 0.4
[1] 0.3

</pre>
</div>
</div>

<div id="outline-container-org5aba467" class="outline-4">
<h4 id="org5aba467"><span class="section-number-4">3.2.3</span> Distribuzioni notevoli</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
Nel package <code>stats</code> sono inclusi i metodi per le più importanti distribuzioni notevoli discrete:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Distribuzione</th>
<th scope="col" class="org-left">Ripartizione</th>
<th scope="col" class="org-left">Quantile</th>
<th scope="col" class="org-left">Generazione</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Binomiale</td>
<td class="org-left"><code>dbinom</code></td>
<td class="org-left"><code>pbinom</code></td>
<td class="org-left"><code>qbinom</code></td>
<td class="org-left"><code>rbinom</code></td>
</tr>

<tr>
<td class="org-left">Ipergeometrica</td>
<td class="org-left"><code>dhyper</code></td>
<td class="org-left"><code>phyper</code></td>
<td class="org-left"><code>qhyper</code></td>
<td class="org-left"><code>rhyper</code></td>
</tr>

<tr>
<td class="org-left">Geometrica</td>
<td class="org-left"><code>dgeom</code></td>
<td class="org-left"><code>pgeom</code></td>
<td class="org-left"><code>qgeom</code></td>
<td class="org-left"><code>rgeom</code></td>
</tr>

<tr>
<td class="org-left">Poisson</td>
<td class="org-left"><code>dpois</code></td>
<td class="org-left"><code>ppois</code></td>
<td class="org-left"><code>qpois</code></td>
<td class="org-left"><code>rpois</code></td>
</tr>

<tr>
<td class="org-left">Uniforme</td>
<td class="org-left"><code>dunif</code></td>
<td class="org-left"><code>qunif</code></td>
<td class="org-left"><code>qunif</code></td>
<td class="org-left"><code>runif</code></td>
</tr>

<tr>
<td class="org-left">Esponenziale</td>
<td class="org-left"><code>dexp</code></td>
<td class="org-left"><code>pexp</code></td>
<td class="org-left"><code>qexp</code></td>
<td class="org-left"><code>rexp</code></td>
</tr>

<tr>
<td class="org-left">Normale</td>
<td class="org-left"><code>dnorm</code></td>
<td class="org-left"><code>pnorm</code></td>
<td class="org-left"><code>qnorm</code></td>
<td class="org-left"><code>rnorm</code></td>
</tr>

<tr>
<td class="org-left">Chi-Quadro</td>
<td class="org-left"><code>dchisq</code></td>
<td class="org-left"><code>pchisq</code></td>
<td class="org-left"><code>qchisq</code></td>
<td class="org-left"><code>rchisq</code></td>
</tr>
</tbody>
</table>

<p>
Esercizio 1:
</p>
<ul class="org-ul">
<li>4 monete bilanciate vengono lanciate. Assumendo l'indipendenza dei risultati, qual'è la probabilità di ottenere 2 testa
e 2 croce?</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">dbinom(2, 4, prob=1/2)
</pre>
</div>

<pre class="example">
[1] 0.375

</pre>

<p>
Distribuzioni notevoli discrete:
</p>
<ul class="org-ul">
<li>Disegnare la distribuzione di probabilità della variabile binomiale: \(X\) = "numero di volte in cui compare testa",
lanciando 4 volte una moneta bilanciata.</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">plot(c(0:4), dbinom(0:4, 4, prob=1/2), type=<span style="color: #689f38;">"h"</span>, xlab=<span style="color: #689f38;">"X"</span>)
lines(c(0:4), dbinom(0:4, 4, prob=0.5), lty=5, col=<span style="color: #689f38;">"red"</span>)
text(c(0:4), dbinom(0:4, 4, prob=0.5), dbinom(0:4, 4, prob=0.5))
</pre>
</div>


<div class="figure">
<p><img src="graf_binom.png" alt="graf_binom.png" />
</p>
</div>

<p>
Disegnare la funzione di ripartizione:
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Impostare il grafico</span>
plot(0, xlim=c(-0.2, 4.2), ylim=c(-0.04, 1.04), type=<span style="color: #689f38;">"n"</span>, xlab=<span style="color: #689f38;">"X"</span>, ylab=<span style="color: #689f38;">"Probabilit&#224; cumulata"</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Disegnare due linee orizzontali che limitano la y</span>
abline(h=c(0, 1), lty=2, col=<span style="color: #689f38;">"grey"</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Disegnare una funzione a gradini</span>
lines(stepfun(0:4, pbinom(-1:4, size=4, prob=0.5)), verticals=<span style="color: #0097A7;">FALSE</span>, do.p=<span style="color: #0097A7;">FALSE</span>)

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Disegnare i punti estremi</span>
points(0:4, pbinom(0:4, size=4, prob=0.5), pch=16, cex=1.2)
points(0:4, pbinom(-1:3, size=4, prob=0.5), pch=1, cex=1.2)
</pre>
</div>


<div class="figure">
<p><img src="graf_rip_binom.png" alt="graf_rip_binom.png" />
</p>
</div>

<p>
Esercizio 2:
</p>
<ul class="org-ul">
<li>È noto che gli item prodotti da una macchina utensile saranno difettosi con probabilità 0.1. Qual'è la probabilità
che in un campione di 3 items al più uno sia difettoso?</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">pbinom(1, 3, prob=0.1)
</pre>
</div>

<pre class="example">
[1] 0.972

</pre>

<p>
Esercizio 3:
</p>
<ul class="org-ul">
<li>Supponiamo che il colore degli occhi di una persona sia determinato in base ad una coppia di geni e che <code>r</code> rappresenti
il gene dominante mentre <code>r</code> il gene recessivo. Pertanto una persona con la coppia di geni <code>dd</code> ha dominanza pura,
una con <code>rr</code> ha recessione pura e una con <code>dr</code> o <code>rd</code> è ibrida. Un bambino riceve un gene da ognuno dei genitori.
Se rispetto al colore degli occhi i due genitori "ibridi" hanno 4 figli.
<ul class="org-ul">
<li>Qual'è la probabilità che esattamente 3 dei 4 figli abbiano 1 gene dominante?</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-R">dbinom(3, 4, prob=3/4)
</pre>
</div>

<pre class="example">
[1] 0.421875

</pre>

<p>
Esercizio 6:
</p>
<ul class="org-ul">
<li>Un'azienda produce dischetti, la probabilità che un dischetto sia difettoso è pari a 0.01. L'azienda vende i dischetti
in confezioni da 10 e rimborsa l'acquirente se più di 1 dischetto è difettoso.
<ol class="org-ol">
<li>Quale proporzione delle confezioni sarà restituita?</li>
<li>Se un acquirente acquista 3 scatole, qual'è la probabilità che ne restituisca esattamente 1?</li>
</ol></li>
</ul>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
1 - pbinom(1, 10, 0.01)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">pbinom(1, 10, 0.01, lower.t=FALSE)</span>

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
dbinom(1, 3, 0.0042662)
</pre>
</div>

<pre class="example">
[1] 0.0042662
[1] 0.01268963

</pre>

<p>
Esercizio 4:
</p>
<ul class="org-ul">
<li>Supponiamo che il numero di errori tipografici presenti in una singola pagina di un libro sia distribuito secondo
una Poisson con parametri \(\lambda=1\).
<ul class="org-ul">
<li>Si calcoli la probabilità che vi sia almeno un errore in una data pagina.</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ppois(0, lambda=1, lower.t=<span style="color: #0097A7;">FALSE</span>)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">1 - ppois(0, 1)</span>
</pre>
</div>

<pre class="example">
[1] 0.6321206

</pre>

<p>
Esercizio 7:
</p>
<ul class="org-ul">
<li>Si supponga che la probabilità che un prodotto costruito da una macchina sia difettoso è pari a 0.1.
<ol class="org-ol">
<li>Si trovi la probabilità che un campione di 10 prodotti contenga al più un prodotto difettoso;</li>
<li>Si trovi la probabilità che un campione di 10 prodotti contenga tra 3 e i 5 prodotti difettosi.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
ppois(1, lambda=10*0.1)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
diff(ppois(c(2, 5), lambda=10*0.1))
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Equivale a:</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">dpois(3, lambda=10*0.1) + dpois(4, lambda=10*0.1) + dpois(5, lambda=10*0.1)</span>
</pre>
</div>

<pre class="example">
[1] 0.7357589
[1] 0.07970721

</pre>

<p>
Es:
</p>
<ul class="org-ul">
<li>Tracciare il grafico della distribuzione della variabile casuale di Poisson per \(\lambda=1\)</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">plot(c(0:5), dpois(0:5, 1), type=<span style="color: #689f38;">"h"</span>, xlab=<span style="color: #689f38;">"X"</span>)
text(c(0:5), dpois(0:5, 1), round(dpois(0:5, 1), 4))
</pre>
</div>


<div class="figure">
<p><img src="graf_pois.png" alt="graf_pois.png" />
</p>
</div>

<p>
Es:
</p>
<ul class="org-ul">
<li>Un calciatore ha una probabilità di segnare un calcio di rigore di 0.812. Si supponga che tirare un calcio di rigore
sia un evento Bernoulliano.
<ol class="org-ol">
<li>Qual'è la probabilità che sbagli 5 calci di rigore prima di segnarne uno?</li>
<li>Qual'è la probabilità che sbagli al massimo 5 calci di rigore prima di segnarne uno?</li>
<li>Qual'è la probabilità che sbagli almeno 5 calci di rigore prima di segnarne uno?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
dgeom(5, prob=0.812)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
pgeom(5, prob=0.812)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
pgeom(4, prob=0.812, lower.tail=<span style="color: #0097A7;">FALSE</span>)
</pre>
</div>

<pre class="example">
[1] 0.0001906976
[1] 0.9999558
[1] 0.0002348493

</pre>

<p>
Esercizio 5:
</p>
<ul class="org-ul">
<li>In media su un'autostrada si verificano 3 incidenti al giorno.
<ul class="org-ul">
<li>Qual'è la probabilità che non si verifichino incidenti oggi?</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">lambda <span style="color: #558b2f;">&lt;-</span> 3
incidenti <span style="color: #558b2f;">&lt;-</span> 0

dpois(incidenti, lambda)
</pre>
</div>

<pre class="example">
[1] 0.04978707

</pre>

<p>
Esercizio 13:
</p>
<ul class="org-ul">
<li>Da un mazzo di 52 carte ne vengono estratte 5 con reinserimento. Si è interessati alla variabile casuale \(X\) che descrive
il numero di carte di cuori ottenute nelle estrazioni. Determinare:
<ol class="org-ol">
<li>Il valore atteso e la varianza della variabile \(X\);</li>
<li>La probabilità di estrarre 3 carte di cuori;</li>
<li>La probabilità di estrarre almeno 3 carte di cuori;</li>
<li>La probabilità di estrarre al più 3 carte di cuori.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">pcuori <span style="color: #558b2f;">&lt;-</span> 1/4
numero_estrazioni <span style="color: #558b2f;">&lt;-</span> 5
numero_cuori <span style="color: #558b2f;">&lt;-</span> 13

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
mu <span style="color: #558b2f;">&lt;-</span> pcuori*numero_estrazioni
mu

var <span style="color: #558b2f;">&lt;-</span> mu*(1-pcuori)
var

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
numero_cuori_estratti <span style="color: #558b2f;">&lt;-</span> 3
dbinom(numero_cuori_estratti, numero_estrazioni, pcuori)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
pbinom(numero_cuori_estratti-1, numero_estrazioni, pcuori, lower.tail=<span style="color: #0097A7;">FALSE</span>)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4</span>
pbinom(numero_cuori_estratti, numero_estrazioni, pcuori)
</pre>
</div>

<pre class="example">
[1] 1.25
[1] 0.9375
[1] 0.08789063
[1] 0.1035156
[1] 0.984375

</pre>

<p>
Esercizio 15:
</p>
<ul class="org-ul">
<li>Il numero \(X\) di telefonate ricevute nell'intervallo di tempo \([0, t_o]\) è una variabile aleatoria distribuita secondo una
distribuzione di Poisson con parametro \(\lambda = t_0\).
<ul class="org-ul">
<li>Calcolare la probabilità \(P(2 \leq X \leq 4)\) di ricevere da 2 a 4 telefonate (2 e 4 inclusi) entro l'istante \(t_0 = 1\).</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">lambda <span style="color: #558b2f;">&lt;-</span> 1
lower <span style="color: #558b2f;">&lt;-</span> 2
upper <span style="color: #558b2f;">&lt;-</span> 4

ppois(upper, lambda) - ppois(lower-1, lambda)
</pre>
</div>

<pre class="example">
[1] 0.2605813

</pre>

<p>
Esercizio 16:
</p>
<ul class="org-ul">
<li>In un dato canale di comunicazione sappiamo che la probabilità di ricevere in modo errato un singolo messaggio è pari a 0.01.
Sapendo che viene inviata una sequenza di 150 messaggi, e che i messaggi trasmessi sono stocasticamente indipendenti tra loro,
ci si chiede:
<ul class="org-ul">
<li>Quale sia la probabilità che 2 dei messaggi ricevuti siano errati.</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">p <span style="color: #558b2f;">&lt;-</span> 0.01
n <span style="color: #558b2f;">&lt;-</span> 150
lambda <span style="color: #558b2f;">&lt;-</span> p*n
n_messaggi_errati <span style="color: #558b2f;">&lt;-</span> 2

binom <span style="color: #558b2f;">&lt;-</span> dbinom(n_messaggi_errati, n, p)
binom
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Approssimativamente:</span>
pois <span style="color: #558b2f;">&lt;-</span> dpois(n_messaggi_errati, lambda)
pois
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Errore approssimazione:</span>
binom-pois
</pre>
</div>

<pre class="example">
[1] 0.2524971
[1] 0.2510214
[1] 0.001475634

</pre>

<p>
Esercizio 17:
</p>
<ul class="org-ul">
<li>In una certa provincia montuosa si può supporre che il numero \(X\) di frane al mese sia una variabile aleatoria con la legge
di Poisson di parametro \(\lambda = 2.3\).
<ol class="org-ol">
<li>Calcolare la probabilità che ci siano almeno 2 frane in un dato mese;</li>
<li>Quanto dovrebbe valere il parametro \(\lambda\) affinché la probabilità che in un mese non ci siano frane sia superiore a \(1/2\)?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">lambda <span style="color: #558b2f;">&lt;-</span> 2.3
frane_min <span style="color: #558b2f;">&lt;-</span> 2

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
ppois(frane_min-1, lambda, lower.tail=<span style="color: #0097A7;">FALSE</span>)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
lambdaB = log(1/p)
lambdaB
cat(<span style="color: #689f38;">'lambda &lt;'</span>, lambdaB)
</pre>
</div>

<pre class="example">
[1] 0.6691458
[1] 4.60517

</pre>

<p>
Esercizio 18:
</p>
<ul class="org-ul">
<li>Il "Crazy Boat" è un battello a due motori utilizzato per le crociere sul Tamigi. I due motori lavorano indipendentemente
e il numero di piccoli guasti in una singola crociera è modellabile tramite una v.a. \(X\) di Poisson di parametro 1 per il
primo motore, e da una v.a. \(Y\) di Poisson di parametro 2 per il secondo.
<ol class="org-ol">
<li>Qual'è la distribuzione della v.a. \(X+Y\)?</li>
<li>Calcolare la probabilità che non avvenga alcun guasto in una data crociera;</li>
<li>Partono 10 modelli identici "Crazy Boat"; calcolare la probabilità che almeno 2 battelli concludano la crociera
senza guasti.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
lambda <span style="color: #558b2f;">&lt;-</span> 3

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
guasti <span style="color: #558b2f;">&lt;-</span> 0
p_noguasti <span style="color: #558b2f;">&lt;-</span> dpois(guasti, lambda)
p_noguasti

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
battelli_min <span style="color: #558b2f;">&lt;-</span> 2
modelli <span style="color: #558b2f;">&lt;-</span> 10
pbinom(battelli_min-1, modelli, p_noguasti, lower.tail=<span style="color: #0097A7;">FALSE</span>)
</pre>
</div>

<pre class="example">
[1] 0.04978707
[1] 0.08550346

</pre>

<p>
Il package <code>distr</code> contiene classi per gestire una grande varietà di distribuzioni:
</p>


<div class="figure">
<p><img src="Laboratorio/screenshot_2018-04-05_21-54-10.png" alt="screenshot_2018-04-05_21-54-10.png" />
</p>
</div>

<p>
Uniforme:
</p>

<p>
Esempio 1:
</p>
<ul class="org-ul">
<li>Sia \(X\) una v.c. che rappresenta la probabilità di ricevere una telefonata tra le 10 e le 10.30. Si calcoli la probabilità
che la chiamata arrivi tra le 10:10 e le 10:20. \(X\) è distribuita secondo una variabile uniforma con parametri \(a=0\) e \(b=30\).</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">diff(punif(c(10, 20), 0, 30))
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">punif(20, 0, 30) - punif(10, 0, 30)</span>
</pre>
</div>

<pre class="example">
[1] 0.3333333

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #558b2f;">library</span>(distr)
X <span style="color: #558b2f;">&lt;-</span> Unif(Min=0, Max=30)
plot(X, to.draw.args=c(<span style="color: #689f38;">"d"</span>, <span style="color: #689f38;">"p"</span>))
</pre>
</div>


<div class="figure">
<p><img src="grafunif.png" alt="grafunif.png" />
</p>
</div>

<p>
Es:
</p>
<ul class="org-ul">
<li>Generare 10 numeri da una distribuzione uniforme compresa tra 0 e 50.</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">runif(n=10, min=0, max=50)
</pre>
</div>

<pre class="example">
[1]  4.884552 11.938489 41.917531 11.303099 28.456204  9.539732 45.183660
[8] 28.011794 26.514975  2.776167

</pre>

<p>
Esercizio 8:
</p>
<ul class="org-ul">
<li>Un bus arriva ad una data fermata ad intervalli di 15 minuti a partire dalle ore 7:00. Poiché il bus passa ogni quarto d'ora,
se un passeggero arriva alla fermata in un istante di tempo uniformemente distribuito nell'intervallo 7:00-7:30, si determino:
<ol class="org-ol">
<li>La probabilità che attenda meno di 5 minuti;</li>
<li>La probabilità che attenda almeno 12 minuti;</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
(punif(15, 0, 30) - punif(10, 0, 30)) + (punif(30, 0, 30) - punif(25, 0, 30))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
(punif(3, 0, 30) - punif(0, 0, 30)) + (punif(18, 0, 30) - punif(15, 0, 30))
</pre>
</div>

<pre class="example">
[1] 0.3333333
[1] 0.2

</pre>

<p>
Esponenziale:
</p>

<p>
Esempio 2:
</p>
<ul class="org-ul">
<li>Sia \(X\) una v.c. che rappresenta la durata di una batteria in mesi. \(X\) è distribuita secondo un'esponenziale
con parametro \(\lambda = 0.2\).
<ol class="org-ol">
<li>Si calcoli la probabilità che una batteria duri tra i 4 e i 6 mesi;</li>
<li>Si calcoli la probabilità che una batteria duri almeno 10 mesi;</li>
<li>Si calcoli la probabilità che una batteria duri almeno 10 mesi;</li>
<li>Si calcoli la probabilità che una batteria duri altri 10 mesi sapendo che la batteria sta durando da 4 mesi.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
diff(pexp(c(4, 6), rate=0.2))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
pexp(10, rate=0.2, lower.tail=<span style="color: #0097A7;">FALSE</span>)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
pexp(14, rate=0.2, lower.tail=<span style="color: #0097A7;">FALSE</span>)/pexp(4, rate=0.2, lower.tail=<span style="color: #0097A7;">FALSE</span>)
</pre>
</div>

<pre class="example">
[1] 0.1481348
[1] 0.1353353
[1] 0.1353353

</pre>

<p>
Es:
</p>
<ul class="org-ul">
<li>Generare 10 numeri da una distribuzione esponenziale con \(\lambda = 0.4\).</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">rexp(10, rate=0.4)
</pre>
</div>

<pre class="example">
[1] 0.9884494 0.2803963 1.4352345 3.8978295 1.9597282 0.6124090 1.8204889
[8] 0.8859712 0.3874522 0.7611300

</pre>

<p>
Esercizio 12:
</p>
<ul class="org-ul">
<li>Un certo tipo di componenti elettronici viene prodotto da una ditta che utilizza 2 linee di produzione. La prima di queste
produce il 40% dei pezzi ed i pezzi prodotti hanno un tempo di vita che segue una legge esponenziale di parametro \(\lambda_1 = 1.5\).
La seconda invece produce il 60% dei pezzi ed i pezzi prodotti hanno tempo di vita che segue una legge esponenziale di
parametro \(\lambda_2 = 2\). Un componente viene scelto a caso tra quelli prodotti dalle 2 linee e indichiamone con \(X\) il suo
tempo di vita.
<ol class="org-ol">
<li>Qual'è la probabilità che sia ancora funzionante al tempo \(t = 1\)?</li>
<li>Sapendo che è ancora funzionante al tempo \(t=1\), qual'è la probabilità che esso sia ancora funzionante la tempo \(t=2\)?</li>
<li>Qual'è la probabilità che su 7 componenti scelti a caso e in modo indipendente l'uno dall'altro, almeno 3 siano ancora
funzionanti al tempo \(t=1\)?</li>
<li>Supponiamo di scegliere a caso ed in modo indipendente dei componenti. Qual'è la probabilità che il primo pezzo non
funzionante al tempo \(t=1\) sia il secondo esaminato?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">l1 <span style="color: #558b2f;">&lt;-</span> 0.4
l2 <span style="color: #558b2f;">&lt;-</span> 0.6
lambda1 <span style="color: #558b2f;">&lt;-</span> 1.5
lambda2 <span style="color: #558b2f;">&lt;-</span> 2

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
t1 <span style="color: #558b2f;">&lt;-</span> 1
funz_1 <span style="color: #558b2f;">&lt;-</span> pexp(t1, lambda1, lower.tail=<span style="color: #0097A7;">FALSE</span>)*l1 + pexp(t1, lambda2, lower.tail=<span style="color: #0097A7;">FALSE</span>)*l2
funz_1

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
t2 <span style="color: #558b2f;">&lt;-</span> 2
funz_2 <span style="color: #558b2f;">&lt;-</span> pexp(t2, lambda1, lower.tail=<span style="color: #0097A7;">FALSE</span>)*l1 + pexp(t2, lambda2, lower.tail=<span style="color: #0097A7;">FALSE</span>)*l2
funz_2/funz_1

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
funz_min <span style="color: #558b2f;">&lt;-</span> 3
n_componenti <span style="color: #558b2f;">&lt;-</span> 7
pbinom(funz_min-1, n_componenti, funz_1, lower.t=<span style="color: #0097A7;">FALSE</span>)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4</span>
funz_1*(1-funz_1)
</pre>
</div>

<pre class="example">
[1] 0.1704532
[1] 0.1813061
[1] 0.1011738
[1] 0.1413989

</pre>

<p>
Esercizio 14:
</p>
<ul class="org-ul">
<li>L'istante d'arrivo dell'autobus è uniformemente distribuito tra le 10:00 e le 10:30. Tu arrivi alla fermata dell'autobus alle 10:00.
<ol class="org-ol">
<li>Qual'è la probabilità che tu debba aspettare più di 10 minuti?</li>
<li>Quanto tempo aspetti in media? Con quale deviazione standard?</li>
<li>Se l'autobus non è ancora passato alle 10:10, qual'è la probabilità che tu debba aspettare almeno altri 10 minuti?</li>
<li>Supponi di arrivare alla fermata dell'autobus alle 10 per 100 giorni. Calcola, in modo approssimato, la probabilità che il tempo
totale speso ad attendere l'autobus sia superiore a 1 giorno.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">min <span style="color: #558b2f;">&lt;-</span> 0
max <span style="color: #558b2f;">&lt;-</span> 30

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
minuti_min1 <span style="color: #558b2f;">&lt;-</span> 10
t_maggiore_10 <span style="color: #558b2f;">&lt;-</span> punif(minuti_min1, min, max, lower.t=<span style="color: #0097A7;">FALSE</span>)
t_maggiore_10

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
mean <span style="color: #558b2f;">&lt;-</span> (min + max)/2
mean
stdev <span style="color: #558b2f;">&lt;-</span> sqrt((max - min)^2/12)
stdev

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
minuti_min2 <span style="color: #558b2f;">&lt;-</span> 20
t_maggiore_20 <span style="color: #558b2f;">&lt;-</span> punif(minuti_min2, min, max, lower.t=<span style="color: #0097A7;">FALSE</span>)
t_maggiore_20/t_maggiore_10

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">4</span>
minuti_min <span style="color: #558b2f;">&lt;-</span> 1440
giorni <span style="color: #558b2f;">&lt;-</span> 100
pnorm(minuti_min, mean=mean*100, sd=sqrt(giorni)*stdev, lower.t=<span style="color: #0097A7;">FALSE</span>)

</pre>
</div>

<pre class="example">
[1] 0.6666667
[1] 15
[1] 8.660254
[1] 0.5
[1] 0.7557888

</pre>

<p>
Normale:
</p>

<p>
Esempio 3.1:
</p>
<ul class="org-ul">
<li>Sia \(X\) una variabile aleatoria con distribuzione normale di parametri \(\mu=10\) e \(\sigma=1\) e si voglia determinare la probabilità
dell'evento "\(X \in [9.2, 11.35]\)"</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">pnorm(11.35, mean=10) - pnorm(9.2, mean=10)
</pre>
</div>

<pre class="example">
[1] 0.6996366

</pre>

<p>
Esempio:
</p>
<ul class="org-ul">
<li>Sia \(X\) una variabile che rappresenta il risultato ad un test sul QI. \(X\) è distribuita secondo una variabile normale con media 100
e deviazione standard 15. Si calcoli la probabilità che una persona abbia un QI tra 85 e 115.di</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">diff(pnorm(c(85, 115), mean=100, sd=5))
</pre>
</div>

<pre class="example">
[1] 0.9973002

</pre>

<p>
Grafico distribuzione normale:
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #558b2f;">library</span>(distr)
X <span style="color: #558b2f;">&lt;-</span> Norm(mean=100, sd=15)
plot(X, to.draw.arg=c(<span style="color: #689f38;">"d"</span>, <span style="color: #689f38;">"p"</span>))
</pre>
</div>


<div class="figure">
<p><img src="grafnorm.png" alt="grafnorm.png" />
</p>
</div>

<p>
Es:
</p>
<ol class="org-ol">
<li>\(P(X \in [\mu - \sigma, \mu + \sigma]) = 0.683\);</li>
<li>\(P(X \in [\mu - 2\sigma, \mu + 2\sigma]) = 0.954\);</li>
<li>\(P(X \in [\mu - 3\sigma, \mu + 3\sigma]) = 0.997\)</li>
</ol>
<div class="org-src-container">
<pre class="src src-R">pnorm(1:3) - pnorm(-(1:3))
</pre>
</div>

<pre class="example">
[1] 0.6826895 0.9544997 0.9973002

</pre>

<p>
Es:
</p>
<ul class="org-ul">
<li>Generare 1000 numeri da una normale standardizzata</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">rand <span style="color: #558b2f;">&lt;-</span> rnorm(1000)
hist(rand)
</pre>
</div>


<div class="figure">
<p><img src="grafrandnorm.png" alt="grafrandnorm.png" />
</p>
</div>

<p>
Esempio precedente sul QI:
</p>
<ul class="org-ul">
<li>Qual'è il minimo QI che una persona deve avere per essere nell'1% delle persone con il QI più alto?</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">qnorm(0.99, mean=100, sd=15)
</pre>
</div>

<pre class="example">
[1] 134.8952

</pre>

<p>
Es:
</p>
<ul class="org-ul">
<li>Calcolare \(z_{0.025}, z_0.01\) e \(z_{0.05}\)</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">qnorm(c(0.025, 0.01, 0.005), lower.t=<span style="color: #0097A7;">FALSE</span>)
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">qnorm(c(0.975, 0.99, 0.995))</span>
</pre>
</div>

<pre class="example">
[1] 1.959964 2.326348 2.575829

</pre>

<p>
Esercizio 9:
</p>
<ul class="org-ul">
<li>Se \(X\) è una variabile distribuita secondo una normale con \(\mu=3\) e \(\sigma^2=16\), si determini:
<ol class="org-ol">
<li>\(P(X < 11)\);</li>
<li>\(P(X > -1)\);</li>
<li>\(P(2 < X < 7)\)</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
pnorm(11, mean=3, sd=sqrt(16))

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
pnorm(-1, mean=3, sd=4, lower.t=<span style="color: #0097A7;">FALSE</span>)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
pnorm(7, mean=3, sd=4) - pnorm(2, mean=3, sd=4)
</pre>
</div>

<pre class="example">
[1] 0.9772499
[1] 0.8413447
[1] 0.4400511

</pre>

<p>
Esercizio 10:
</p>
<ul class="org-ul">
<li>Un'industria produce su commissione delle sbarre d'acciaio cilindriche, il cui diametro dovrebbe essere di 4 cm, ma che tuttavia
sono accettabili se hanno diametro compreso tra 3.95 cm e 4.05 cm. Il cliente, nel controllare le sbarre fornitegli, constata che
il 5% sono di diametro inferiore al minimo tollerato ed il 12% di diametro superiore al massimo tollerato.
<ol class="org-ol">
<li>Supponendo che le misure dei diametri seguano una legge normale, determinare media e deviazione standard;</li>
<li>Mantenendo la media precedentemente calcolata, determinare quale dovrebbe essere il valore massimo della deviazione
standard affinché la probabilità che le sbarre abbiano un diametro superiore al massimo tollerato sia minore di 0.05.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">m1 <span style="color: #558b2f;">&lt;-</span> 5
m2 <span style="color: #558b2f;">&lt;-</span> 12
max <span style="color: #558b2f;">&lt;-</span> 4.05
min <span style="color: #558b2f;">&lt;-</span> 3.95

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
q1 <span style="color: #558b2f;">&lt;-</span> qnorm(m1/100)
q2 <span style="color: #558b2f;">&lt;-</span> qnorm(m2/100, lower.t=<span style="color: #0097A7;">FALSE</span>)
sd <span style="color: #558b2f;">&lt;-</span> (max-min)/(q2-q1)
sd
mean <span style="color: #558b2f;">&lt;-</span> min-q1*sd
mean

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
q3 <span style="color: #558b2f;">&lt;-</span> qnorm(1-m1/100, mean=mean, sd=1)
sd2 <span style="color: #558b2f;">&lt;-</span> (max)/q3
cat(<span style="color: #689f38;">"sd &lt; "</span>, sd2)
</pre>
</div>

<pre class="example">
[1] 0.035463
[1] 4.008331

</pre>

<p>
Esercizio 11:
</p>
<ul class="org-ul">
<li>Un'azienda stipula un contratto per vendere barattoli di conserva da 500g. La quantità di conserva \(X\) messa in ciascun barattolo
è predeterminata meccanicamente ed è normalmente distribuita con media \(\mu\) e deviazione standard 25g.
<ol class="org-ol">
<li>A quale valore minimo \(\mu\) deve essere tarata la macchina, perché non più del 2% dei barattoli contenga meno di 500g di conserva?</li>
<li>Supponiamo che i barattoli siano di metallo e che il loro peso \(Y\) da vuoti segua una distribuzione \(N(mean=90, V=64)\). Se un
ispettore pesa i barattoli pieni e scarta quelli il cui peso è inferiore a 590g, quale percentuale di barattoli non
passerà l'ispezione?</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">sd1 <span style="color: #558b2f;">&lt;-</span> 25

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
p <span style="color: #558b2f;">&lt;-</span> 2/100
g <span style="color: #558b2f;">&lt;-</span> 500
q <span style="color: #558b2f;">&lt;-</span> qnorm(p)
mean1 <span style="color: #558b2f;">&lt;-</span> g - q*sd1
mean1

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
mean2 <span style="color: #558b2f;">&lt;-</span> 90
v2 <span style="color: #558b2f;">&lt;-</span> 64
sd2 <span style="color: #558b2f;">&lt;-</span> sqrt(v2)
pnorm(590, mean1+mean2, sqrt(sd1^2+sd2^2))
</pre>
</div>

<pre class="example">
[1] 551.3437
[1] 0.02523022

</pre>

<p>
Chi-Quadro:
</p>
<div class="org-src-container">
<pre class="src src-R">curve(dchisq(x, df=3), from=0, to=20, ylab=<span style="color: #689f38;">"y"</span>)
ind <span style="color: #558b2f;">&lt;-</span> c(4, 5, 10, 15)
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> ind) curve(dchisq(x, df=i), 0, 20, add=<span style="color: #0097A7;">TRUE</span>, col=i)
legend(<span style="color: #689f38;">"topright"</span>, legend=c(<span style="color: #689f38;">"3 gl"</span>, <span style="color: #689f38;">"4 gl"</span>, <span style="color: #689f38;">"5 gl"</span>, <span style="color: #689f38;">"10 gl"</span>, <span style="color: #689f38;">"15 gl"</span>),
       col=c(<span style="color: #689f38;">"Black"</span>, <span style="color: #689f38;">"Blue"</span>, <span style="color: #689f38;">"light Blue"</span>, <span style="color: #689f38;">"Red"</span>, <span style="color: #689f38;">"Yellow"</span>), lty=c(1, 1, 1, 1, 1), lwd=c(3, 3, 3, 3, 3))
</pre>
</div>


<div class="figure">
<p><img src="grafdchiquadro.png" alt="grafdchiquadro.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">curve(pchisq(x, df=3), from=0, to=20, ylab=<span style="color: #689f38;">"y"</span>)
ind <span style="color: #558b2f;">&lt;-</span> c(4, 5, 10, 15)
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> ind) curve(pchisq(x, df=i), 0, 20, add=<span style="color: #0097A7;">TRUE</span>, col=i)
legend(<span style="color: #689f38;">"topright"</span>, legend=c(<span style="color: #689f38;">"3 gl"</span>, <span style="color: #689f38;">"4 gl"</span>, <span style="color: #689f38;">"5 gl"</span>, <span style="color: #689f38;">"10 gl"</span>, <span style="color: #689f38;">"15 gl"</span>),
       col=c(<span style="color: #689f38;">"Black"</span>, <span style="color: #689f38;">"Blue"</span>, <span style="color: #689f38;">"light Blue"</span>, <span style="color: #689f38;">"Red"</span>, <span style="color: #689f38;">"Yellow"</span>), lty=c(1, 1, 1, 1, 1), lwd=c(3, 3, 3, 3, 3))
</pre>
</div>


<div class="figure">
<p><img src="grafpchiquadro.png" alt="grafpchiquadro.png" />
</p>
</div>

<p>
T di Student:
</p>

<div class="org-src-container">
<pre class="src src-R">curve(dt(x, df=1), from=-4, to=4, ylim=c(0, 0.4), ylab=<span style="color: #689f38;">"y"</span>)
ind <span style="color: #558b2f;">&lt;-</span> c(3, 5, 10, 15)
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> ind) curve(dt(x, df=i), -4, 4, add=<span style="color: #0097A7;">TRUE</span>, col=i)
legend(<span style="color: #689f38;">"topright"</span>, legend=c(<span style="color: #689f38;">"1 gl"</span>, <span style="color: #689f38;">"3 gl"</span>, <span style="color: #689f38;">"5 gl"</span>, <span style="color: #689f38;">"10 gl"</span>),
       col=c(<span style="color: #689f38;">"Black"</span>, <span style="color: #689f38;">"Green"</span>, <span style="color: #689f38;">"light Blue"</span>, <span style="color: #689f38;">"Red"</span>), lty=c(1, 1, 1, 1), lwd=c(3, 3, 3, 3))
</pre>
</div>


<div class="figure">
<p><img src="grafdt.png" alt="grafdt.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">curve(pt(x, df=1), from=-4, to=4, ylim=c(0, 1), ylab=<span style="color: #689f38;">"y"</span>)
ind <span style="color: #558b2f;">&lt;-</span> c(3, 5, 10, 15)
<span style="color: #00796b;">for</span> (i <span style="color: #00796b;">in</span> ind) curve(pt(x, df=i), -4, 4, add=<span style="color: #0097A7;">TRUE</span>, col=i)
legend(<span style="color: #689f38;">"topleft"</span>, legend=c(<span style="color: #689f38;">"1 gl"</span>, <span style="color: #689f38;">"3 gl"</span>, <span style="color: #689f38;">"5 gl"</span>, <span style="color: #689f38;">"10 gl"</span>),
       col=c(<span style="color: #689f38;">"Black"</span>, <span style="color: #689f38;">"Green"</span>, <span style="color: #689f38;">"light Blue"</span>, <span style="color: #689f38;">"Red"</span>), lty=c(1, 1, 1, 1), lwd=c(3, 3, 3, 3))
</pre>
</div>


<div class="figure">
<p><img src="grafpt.png" alt="grafpt.png" />
</p>
</div>

<p>
Esempio:
</p>
<ul class="org-ul">
<li>Il grafico della distribuzione t di Student con 9 gradi di libertà è il seguente:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">curve(dt(x, df=9), from=-4, to=4, ylim=c(0, 0.4), ylab=<span style="color: #689f38;">"y"</span>)
</pre>
</div>


<div class="figure">
<p><img src="grafdt9.png" alt="grafdt9.png" />
</p>
</div>

<p>
Trovare:
</p>
<ul class="org-ul">
<li>Il valore di \(t_1\) tale per cui:
<ol class="org-ol">
<li>L'area a destra di \(t1\) è pari a 0.05;</li>
<li>Il totale dell'area a sinistra di \(-t_1\) e a destra di \(t_1\) è pari a 0.05;</li>
<li>Il totale dell'area compresa tra \(-t_1\) e \(t_1\) è pari a 0.99.</li>
</ol></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #607d8b;">#</span><span style="color: #607d8b;">1</span>
qt(0.95, df=9)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">2</span>
qt(0.975, df=9)

<span style="color: #607d8b;">#</span><span style="color: #607d8b;">3</span>
qt(0.995, df=9)
</pre>
</div>

<pre class="example">
[1] 1.833113
[1] 2.262157
[1] 3.249836

</pre>

<p>
F di Fisher:
</p>
<div class="org-src-container">
<pre class="src src-R">curve(df(x, df1=3, df2=3), 0, +3, ylim=c(0, 1.3), col=<span style="color: #689f38;">"Black"</span>, lwd=3)
curve(df(x, df1=5, df2=10), 0, +3, col=<span style="color: #689f38;">"Blue"</span>, lwd=3, add=<span style="color: #0097A7;">TRUE</span>)
curve(df(x, df1=30, df2=50), 0, +3, col=<span style="color: #689f38;">"Red"</span>, lwd=3, add=<span style="color: #0097A7;">TRUE</span>)
legend(<span style="color: #689f38;">"topright"</span>, legend=c(<span style="color: #689f38;">"3,3 gl"</span>, <span style="color: #689f38;">"5,10 gl"</span>, <span style="color: #689f38;">"30,50 gl"</span>),
       col=c(<span style="color: #689f38;">"Black"</span>, <span style="color: #689f38;">"Blue"</span>, <span style="color: #689f38;">"Red"</span>), lty=c(1, 1, 1), lwd=c(3, 3, 3))
</pre>
</div>


<div class="figure">
<p><img src="grafdf.png" alt="grafdf.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">curve(pf(x, df1=3, df2=3), 0, 10, ylim=c(0, 1), col=<span style="color: #689f38;">"Black"</span>, lwd=3)
curve(pf(x, df1=5, df2=10), 0, 10, col=<span style="color: #689f38;">"Blue"</span>, lwd=3, add=<span style="color: #0097A7;">TRUE</span>)
curve(pf(x, df1=30, df2=50), 0, 10, col=<span style="color: #689f38;">"Red"</span>, lwd=3, add=<span style="color: #0097A7;">TRUE</span>)
legend(<span style="color: #689f38;">"topright"</span>, legend=c(<span style="color: #689f38;">"3,3 gl"</span>, <span style="color: #689f38;">"5,10 gl"</span>, <span style="color: #689f38;">"30,50 gl"</span>),
       col=c(<span style="color: #689f38;">"Black"</span>, <span style="color: #689f38;">"Blue"</span>, <span style="color: #689f38;">"Red"</span>), lty=c(1, 1, 1), lwd=c(3, 3, 3))
</pre>
</div>


<div class="figure">
<p><img src="grafpf.png" alt="grafpf.png" />
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Gabriele Calissi</p>
<p class="date">Created: 2018-05-04 ven 09:14</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
